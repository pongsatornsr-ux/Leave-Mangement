var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},buffer$1={},base64Js={};base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr=typeof Uint8Array!="undefined"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i$2=0,len=code.length;i$2<len;++i$2)lookup[i$2]=code[i$2],revLookup[code.charCodeAt(i$2)]=i$2;revLookup[45]=62,revLookup[95]=63;function getLens(r){var g=r.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=r.indexOf("=");l===-1&&(l=g);var E=l===g?0:4-l%4;return[l,E]}function byteLength(r){var g=getLens(r),l=g[0],E=g[1];return(l+E)*3/4-E}function _byteLength(r,g,l){return(g+l)*3/4-l}function toByteArray(r){var g,l=getLens(r),E=l[0],A=l[1],I=new Arr(_byteLength(r,E,A)),N=0,y=A>0?E-4:E,M;for(M=0;M<y;M+=4)g=revLookup[r.charCodeAt(M)]<<18|revLookup[r.charCodeAt(M+1)]<<12|revLookup[r.charCodeAt(M+2)]<<6|revLookup[r.charCodeAt(M+3)],I[N++]=g>>16&255,I[N++]=g>>8&255,I[N++]=g&255;return A===2&&(g=revLookup[r.charCodeAt(M)]<<2|revLookup[r.charCodeAt(M+1)]>>4,I[N++]=g&255),A===1&&(g=revLookup[r.charCodeAt(M)]<<10|revLookup[r.charCodeAt(M+1)]<<4|revLookup[r.charCodeAt(M+2)]>>2,I[N++]=g>>8&255,I[N++]=g&255),I}function tripletToBase64(r){return lookup[r>>18&63]+lookup[r>>12&63]+lookup[r>>6&63]+lookup[r&63]}function encodeChunk(r,g,l){for(var E,A=[],I=g;I<l;I+=3)E=(r[I]<<16&16711680)+(r[I+1]<<8&65280)+(r[I+2]&255),A.push(tripletToBase64(E));return A.join("")}function fromByteArray(r){for(var g,l=r.length,E=l%3,A=[],I=16383,N=0,y=l-E;N<y;N+=I)A.push(encodeChunk(r,N,N+I>y?y:N+I));return E===1?(g=r[l-1],A.push(lookup[g>>2]+lookup[g<<4&63]+"==")):E===2&&(g=(r[l-2]<<8)+r[l-1],A.push(lookup[g>>10]+lookup[g>>4&63]+lookup[g<<2&63]+"=")),A.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(r,g,l,E,A){var I,N,y=A*8-E-1,M=(1<<y)-1,O=M>>1,Z=-7,xe=l?A-1:0,V=l?-1:1,ce=r[g+xe];for(xe+=V,I=ce&(1<<-Z)-1,ce>>=-Z,Z+=y;Z>0;I=I*256+r[g+xe],xe+=V,Z-=8);for(N=I&(1<<-Z)-1,I>>=-Z,Z+=E;Z>0;N=N*256+r[g+xe],xe+=V,Z-=8);if(I===0)I=1-O;else{if(I===M)return N?NaN:(ce?-1:1)*(1/0);N=N+Math.pow(2,E),I=I-O}return(ce?-1:1)*N*Math.pow(2,I-E)},ieee754.write=function(r,g,l,E,A,I){var N,y,M,O=I*8-A-1,Z=(1<<O)-1,xe=Z>>1,V=A===23?Math.pow(2,-24)-Math.pow(2,-77):0,ce=E?0:I-1,me=E?1:-1,we=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(y=isNaN(g)?1:0,N=Z):(N=Math.floor(Math.log(g)/Math.LN2),g*(M=Math.pow(2,-N))<1&&(N--,M*=2),N+xe>=1?g+=V/M:g+=V*Math.pow(2,1-xe),g*M>=2&&(N++,M/=2),N+xe>=Z?(y=0,N=Z):N+xe>=1?(y=(g*M-1)*Math.pow(2,A),N=N+xe):(y=g*Math.pow(2,xe-1)*Math.pow(2,A),N=0));A>=8;r[l+ce]=y&255,ce+=me,y/=256,A-=8);for(N=N<<A|y,O+=A;O>0;r[l+ce]=N&255,ce+=me,N/=256,O-=8);r[l+ce-me]|=we*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const g=base64Js,l=ieee754,E=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=y,r.SlowBuffer=Te,r.INSPECT_MAX_BYTES=50;const A=2147483647;r.kMaxLength=A,y.TYPED_ARRAY_SUPPORT=I(),!y.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function I(){try{const D=new Uint8Array(1),v={foo:function(){return 42}};return Object.setPrototypeOf(v,Uint8Array.prototype),Object.setPrototypeOf(D,v),D.foo()===42}catch(D){return!1}}Object.defineProperty(y.prototype,"parent",{enumerable:!0,get:function(){if(y.isBuffer(this))return this.buffer}}),Object.defineProperty(y.prototype,"offset",{enumerable:!0,get:function(){if(y.isBuffer(this))return this.byteOffset}});function N(D){if(D>A)throw new RangeError('The value "'+D+'" is invalid for option "size"');const v=new Uint8Array(D);return Object.setPrototypeOf(v,y.prototype),v}function y(D,v,T){if(typeof D=="number"){if(typeof v=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return xe(D)}return M(D,v,T)}y.poolSize=8192;function M(D,v,T){if(typeof D=="string")return V(D,v);if(ArrayBuffer.isView(D))return me(D);if(D==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof D);if(et(D,ArrayBuffer)||D&&et(D.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(et(D,SharedArrayBuffer)||D&&et(D.buffer,SharedArrayBuffer)))return we(D,v,T);if(typeof D=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Y=D.valueOf&&D.valueOf();if(Y!=null&&Y!==D)return y.from(Y,v,T);const _e=ye(D);if(_e)return _e;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof D[Symbol.toPrimitive]=="function")return y.from(D[Symbol.toPrimitive]("string"),v,T);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof D)}y.from=function(D,v,T){return M(D,v,T)},Object.setPrototypeOf(y.prototype,Uint8Array.prototype),Object.setPrototypeOf(y,Uint8Array);function O(D){if(typeof D!="number")throw new TypeError('"size" argument must be of type number');if(D<0)throw new RangeError('The value "'+D+'" is invalid for option "size"')}function Z(D,v,T){return O(D),D<=0?N(D):v!==void 0?typeof T=="string"?N(D).fill(v,T):N(D).fill(v):N(D)}y.alloc=function(D,v,T){return Z(D,v,T)};function xe(D){return O(D),N(D<0?0:be(D)|0)}y.allocUnsafe=function(D){return xe(D)},y.allocUnsafeSlow=function(D){return xe(D)};function V(D,v){if((typeof v!="string"||v==="")&&(v="utf8"),!y.isEncoding(v))throw new TypeError("Unknown encoding: "+v);const T=Ne(D,v)|0;let Y=N(T);const _e=Y.write(D,v);return _e!==T&&(Y=Y.slice(0,_e)),Y}function ce(D){const v=D.length<0?0:be(D.length)|0,T=N(v);for(let Y=0;Y<v;Y+=1)T[Y]=D[Y]&255;return T}function me(D){if(et(D,Uint8Array)){const v=new Uint8Array(D);return we(v.buffer,v.byteOffset,v.byteLength)}return ce(D)}function we(D,v,T){if(v<0||D.byteLength<v)throw new RangeError('"offset" is outside of buffer bounds');if(D.byteLength<v+(T||0))throw new RangeError('"length" is outside of buffer bounds');let Y;return v===void 0&&T===void 0?Y=new Uint8Array(D):T===void 0?Y=new Uint8Array(D,v):Y=new Uint8Array(D,v,T),Object.setPrototypeOf(Y,y.prototype),Y}function ye(D){if(y.isBuffer(D)){const v=be(D.length)|0,T=N(v);return T.length===0||D.copy(T,0,0,v),T}if(D.length!==void 0)return typeof D.length!="number"||_t(D.length)?N(0):ce(D);if(D.type==="Buffer"&&Array.isArray(D.data))return ce(D.data)}function be(D){if(D>=A)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+A.toString(16)+" bytes");return D|0}function Te(D){return+D!=D&&(D=0),y.alloc(+D)}y.isBuffer=function(v){return v!=null&&v._isBuffer===!0&&v!==y.prototype},y.compare=function(v,T){if(et(v,Uint8Array)&&(v=y.from(v,v.offset,v.byteLength)),et(T,Uint8Array)&&(T=y.from(T,T.offset,T.byteLength)),!y.isBuffer(v)||!y.isBuffer(T))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(v===T)return 0;let Y=v.length,_e=T.length;for(let ve=0,Se=Math.min(Y,_e);ve<Se;++ve)if(v[ve]!==T[ve]){Y=v[ve],_e=T[ve];break}return Y<_e?-1:_e<Y?1:0},y.isEncoding=function(v){switch(String(v).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},y.concat=function(v,T){if(!Array.isArray(v))throw new TypeError('"list" argument must be an Array of Buffers');if(v.length===0)return y.alloc(0);let Y;if(T===void 0)for(T=0,Y=0;Y<v.length;++Y)T+=v[Y].length;const _e=y.allocUnsafe(T);let ve=0;for(Y=0;Y<v.length;++Y){let Se=v[Y];if(et(Se,Uint8Array))ve+Se.length>_e.length?(y.isBuffer(Se)||(Se=y.from(Se)),Se.copy(_e,ve)):Uint8Array.prototype.set.call(_e,Se,ve);else if(y.isBuffer(Se))Se.copy(_e,ve);else throw new TypeError('"list" argument must be an Array of Buffers');ve+=Se.length}return _e};function Ne(D,v){if(y.isBuffer(D))return D.length;if(ArrayBuffer.isView(D)||et(D,ArrayBuffer))return D.byteLength;if(typeof D!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof D);const T=D.length,Y=arguments.length>2&&arguments[2]===!0;if(!Y&&T===0)return 0;let _e=!1;for(;;)switch(v){case"ascii":case"latin1":case"binary":return T;case"utf8":case"utf-8":return Ge(D).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T*2;case"hex":return T>>>1;case"base64":return ct(D).length;default:if(_e)return Y?-1:Ge(D).length;v=(""+v).toLowerCase(),_e=!0}}y.byteLength=Ne;function Ie(D,v,T){let Y=!1;if((v===void 0||v<0)&&(v=0),v>this.length||((T===void 0||T>this.length)&&(T=this.length),T<=0)||(T>>>=0,v>>>=0,T<=v))return"";for(D||(D="utf8");;)switch(D){case"hex":return st(this,v,T);case"utf8":case"utf-8":return Ke(this,v,T);case"ascii":return Be(this,v,T);case"latin1":case"binary":return tt(this,v,T);case"base64":return Xe(this,v,T);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return it(this,v,T);default:if(Y)throw new TypeError("Unknown encoding: "+D);D=(D+"").toLowerCase(),Y=!0}}y.prototype._isBuffer=!0;function Ae(D,v,T){const Y=D[v];D[v]=D[T],D[T]=Y}y.prototype.swap16=function(){const v=this.length;if(v%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let T=0;T<v;T+=2)Ae(this,T,T+1);return this},y.prototype.swap32=function(){const v=this.length;if(v%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let T=0;T<v;T+=4)Ae(this,T,T+3),Ae(this,T+1,T+2);return this},y.prototype.swap64=function(){const v=this.length;if(v%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let T=0;T<v;T+=8)Ae(this,T,T+7),Ae(this,T+1,T+6),Ae(this,T+2,T+5),Ae(this,T+3,T+4);return this},y.prototype.toString=function(){const v=this.length;return v===0?"":arguments.length===0?Ke(this,0,v):Ie.apply(this,arguments)},y.prototype.toLocaleString=y.prototype.toString,y.prototype.equals=function(v){if(!y.isBuffer(v))throw new TypeError("Argument must be a Buffer");return this===v?!0:y.compare(this,v)===0},y.prototype.inspect=function(){let v="";const T=r.INSPECT_MAX_BYTES;return v=this.toString("hex",0,T).replace(/(.{2})/g,"$1 ").trim(),this.length>T&&(v+=" ... "),"<Buffer "+v+">"},E&&(y.prototype[E]=y.prototype.inspect),y.prototype.compare=function(v,T,Y,_e,ve){if(et(v,Uint8Array)&&(v=y.from(v,v.offset,v.byteLength)),!y.isBuffer(v))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof v);if(T===void 0&&(T=0),Y===void 0&&(Y=v?v.length:0),_e===void 0&&(_e=0),ve===void 0&&(ve=this.length),T<0||Y>v.length||_e<0||ve>this.length)throw new RangeError("out of range index");if(_e>=ve&&T>=Y)return 0;if(_e>=ve)return-1;if(T>=Y)return 1;if(T>>>=0,Y>>>=0,_e>>>=0,ve>>>=0,this===v)return 0;let Se=ve-_e,Fe=Y-T;const je=Math.min(Se,Fe),ze=this.slice(_e,ve),We=v.slice(T,Y);for(let Pe=0;Pe<je;++Pe)if(ze[Pe]!==We[Pe]){Se=ze[Pe],Fe=We[Pe];break}return Se<Fe?-1:Fe<Se?1:0};function Re(D,v,T,Y,_e){if(D.length===0)return-1;if(typeof T=="string"?(Y=T,T=0):T>2147483647?T=2147483647:T<-2147483648&&(T=-2147483648),T=+T,_t(T)&&(T=_e?0:D.length-1),T<0&&(T=D.length+T),T>=D.length){if(_e)return-1;T=D.length-1}else if(T<0)if(_e)T=0;else return-1;if(typeof v=="string"&&(v=y.from(v,Y)),y.isBuffer(v))return v.length===0?-1:ke(D,v,T,Y,_e);if(typeof v=="number")return v=v&255,typeof Uint8Array.prototype.indexOf=="function"?_e?Uint8Array.prototype.indexOf.call(D,v,T):Uint8Array.prototype.lastIndexOf.call(D,v,T):ke(D,[v],T,Y,_e);throw new TypeError("val must be string, number or Buffer")}function ke(D,v,T,Y,_e){let ve=1,Se=D.length,Fe=v.length;if(Y!==void 0&&(Y=String(Y).toLowerCase(),Y==="ucs2"||Y==="ucs-2"||Y==="utf16le"||Y==="utf-16le")){if(D.length<2||v.length<2)return-1;ve=2,Se/=2,Fe/=2,T/=2}function je(We,Pe){return ve===1?We[Pe]:We.readUInt16BE(Pe*ve)}let ze;if(_e){let We=-1;for(ze=T;ze<Se;ze++)if(je(D,ze)===je(v,We===-1?0:ze-We)){if(We===-1&&(We=ze),ze-We+1===Fe)return We*ve}else We!==-1&&(ze-=ze-We),We=-1}else for(T+Fe>Se&&(T=Se-Fe),ze=T;ze>=0;ze--){let We=!0;for(let Pe=0;Pe<Fe;Pe++)if(je(D,ze+Pe)!==je(v,Pe)){We=!1;break}if(We)return ze}return-1}y.prototype.includes=function(v,T,Y){return this.indexOf(v,T,Y)!==-1},y.prototype.indexOf=function(v,T,Y){return Re(this,v,T,Y,!0)},y.prototype.lastIndexOf=function(v,T,Y){return Re(this,v,T,Y,!1)};function De(D,v,T,Y){T=Number(T)||0;const _e=D.length-T;Y?(Y=Number(Y),Y>_e&&(Y=_e)):Y=_e;const ve=v.length;Y>ve/2&&(Y=ve/2);let Se;for(Se=0;Se<Y;++Se){const Fe=parseInt(v.substr(Se*2,2),16);if(_t(Fe))return Se;D[T+Se]=Fe}return Se}function he(D,v,T,Y){return at(Ge(v,D.length-T),D,T,Y)}function Le(D,v,T,Y){return at(rt(v),D,T,Y)}function Ce(D,v,T,Y){return at(ct(v),D,T,Y)}function Oe(D,v,T,Y){return at(dt(v,D.length-T),D,T,Y)}y.prototype.write=function(v,T,Y,_e){if(T===void 0)_e="utf8",Y=this.length,T=0;else if(Y===void 0&&typeof T=="string")_e=T,Y=this.length,T=0;else if(isFinite(T))T=T>>>0,isFinite(Y)?(Y=Y>>>0,_e===void 0&&(_e="utf8")):(_e=Y,Y=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ve=this.length-T;if((Y===void 0||Y>ve)&&(Y=ve),v.length>0&&(Y<0||T<0)||T>this.length)throw new RangeError("Attempt to write outside buffer bounds");_e||(_e="utf8");let Se=!1;for(;;)switch(_e){case"hex":return De(this,v,T,Y);case"utf8":case"utf-8":return he(this,v,T,Y);case"ascii":case"latin1":case"binary":return Le(this,v,T,Y);case"base64":return Ce(this,v,T,Y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Oe(this,v,T,Y);default:if(Se)throw new TypeError("Unknown encoding: "+_e);_e=(""+_e).toLowerCase(),Se=!0}},y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Xe(D,v,T){return v===0&&T===D.length?g.fromByteArray(D):g.fromByteArray(D.slice(v,T))}function Ke(D,v,T){T=Math.min(D.length,T);const Y=[];let _e=v;for(;_e<T;){const ve=D[_e];let Se=null,Fe=ve>239?4:ve>223?3:ve>191?2:1;if(_e+Fe<=T){let je,ze,We,Pe;switch(Fe){case 1:ve<128&&(Se=ve);break;case 2:je=D[_e+1],(je&192)===128&&(Pe=(ve&31)<<6|je&63,Pe>127&&(Se=Pe));break;case 3:je=D[_e+1],ze=D[_e+2],(je&192)===128&&(ze&192)===128&&(Pe=(ve&15)<<12|(je&63)<<6|ze&63,Pe>2047&&(Pe<55296||Pe>57343)&&(Se=Pe));break;case 4:je=D[_e+1],ze=D[_e+2],We=D[_e+3],(je&192)===128&&(ze&192)===128&&(We&192)===128&&(Pe=(ve&15)<<18|(je&63)<<12|(ze&63)<<6|We&63,Pe>65535&&Pe<1114112&&(Se=Pe))}}Se===null?(Se=65533,Fe=1):Se>65535&&(Se-=65536,Y.push(Se>>>10&1023|55296),Se=56320|Se&1023),Y.push(Se),_e+=Fe}return Qe(Y)}const Je=4096;function Qe(D){const v=D.length;if(v<=Je)return String.fromCharCode.apply(String,D);let T="",Y=0;for(;Y<v;)T+=String.fromCharCode.apply(String,D.slice(Y,Y+=Je));return T}function Be(D,v,T){let Y="";T=Math.min(D.length,T);for(let _e=v;_e<T;++_e)Y+=String.fromCharCode(D[_e]&127);return Y}function tt(D,v,T){let Y="";T=Math.min(D.length,T);for(let _e=v;_e<T;++_e)Y+=String.fromCharCode(D[_e]);return Y}function st(D,v,T){const Y=D.length;(!v||v<0)&&(v=0),(!T||T<0||T>Y)&&(T=Y);let _e="";for(let ve=v;ve<T;++ve)_e+=pt[D[ve]];return _e}function it(D,v,T){const Y=D.slice(v,T);let _e="";for(let ve=0;ve<Y.length-1;ve+=2)_e+=String.fromCharCode(Y[ve]+Y[ve+1]*256);return _e}y.prototype.slice=function(v,T){const Y=this.length;v=~~v,T=T===void 0?Y:~~T,v<0?(v+=Y,v<0&&(v=0)):v>Y&&(v=Y),T<0?(T+=Y,T<0&&(T=0)):T>Y&&(T=Y),T<v&&(T=v);const _e=this.subarray(v,T);return Object.setPrototypeOf(_e,y.prototype),_e};function Ue(D,v,T){if(D%1!==0||D<0)throw new RangeError("offset is not uint");if(D+v>T)throw new RangeError("Trying to access beyond buffer length")}y.prototype.readUintLE=y.prototype.readUIntLE=function(v,T,Y){v=v>>>0,T=T>>>0,Y||Ue(v,T,this.length);let _e=this[v],ve=1,Se=0;for(;++Se<T&&(ve*=256);)_e+=this[v+Se]*ve;return _e},y.prototype.readUintBE=y.prototype.readUIntBE=function(v,T,Y){v=v>>>0,T=T>>>0,Y||Ue(v,T,this.length);let _e=this[v+--T],ve=1;for(;T>0&&(ve*=256);)_e+=this[v+--T]*ve;return _e},y.prototype.readUint8=y.prototype.readUInt8=function(v,T){return v=v>>>0,T||Ue(v,1,this.length),this[v]},y.prototype.readUint16LE=y.prototype.readUInt16LE=function(v,T){return v=v>>>0,T||Ue(v,2,this.length),this[v]|this[v+1]<<8},y.prototype.readUint16BE=y.prototype.readUInt16BE=function(v,T){return v=v>>>0,T||Ue(v,2,this.length),this[v]<<8|this[v+1]},y.prototype.readUint32LE=y.prototype.readUInt32LE=function(v,T){return v=v>>>0,T||Ue(v,4,this.length),(this[v]|this[v+1]<<8|this[v+2]<<16)+this[v+3]*16777216},y.prototype.readUint32BE=y.prototype.readUInt32BE=function(v,T){return v=v>>>0,T||Ue(v,4,this.length),this[v]*16777216+(this[v+1]<<16|this[v+2]<<8|this[v+3])},y.prototype.readBigUInt64LE=ot(function(v){v=v>>>0,Ze(v,"offset");const T=this[v],Y=this[v+7];(T===void 0||Y===void 0)&&Ye(v,this.length-8);const _e=T+this[++v]*2**8+this[++v]*2**16+this[++v]*2**24,ve=this[++v]+this[++v]*2**8+this[++v]*2**16+Y*2**24;return BigInt(_e)+(BigInt(ve)<<BigInt(32))}),y.prototype.readBigUInt64BE=ot(function(v){v=v>>>0,Ze(v,"offset");const T=this[v],Y=this[v+7];(T===void 0||Y===void 0)&&Ye(v,this.length-8);const _e=T*2**24+this[++v]*2**16+this[++v]*2**8+this[++v],ve=this[++v]*2**24+this[++v]*2**16+this[++v]*2**8+Y;return(BigInt(_e)<<BigInt(32))+BigInt(ve)}),y.prototype.readIntLE=function(v,T,Y){v=v>>>0,T=T>>>0,Y||Ue(v,T,this.length);let _e=this[v],ve=1,Se=0;for(;++Se<T&&(ve*=256);)_e+=this[v+Se]*ve;return ve*=128,_e>=ve&&(_e-=Math.pow(2,8*T)),_e},y.prototype.readIntBE=function(v,T,Y){v=v>>>0,T=T>>>0,Y||Ue(v,T,this.length);let _e=T,ve=1,Se=this[v+--_e];for(;_e>0&&(ve*=256);)Se+=this[v+--_e]*ve;return ve*=128,Se>=ve&&(Se-=Math.pow(2,8*T)),Se},y.prototype.readInt8=function(v,T){return v=v>>>0,T||Ue(v,1,this.length),this[v]&128?(255-this[v]+1)*-1:this[v]},y.prototype.readInt16LE=function(v,T){v=v>>>0,T||Ue(v,2,this.length);const Y=this[v]|this[v+1]<<8;return Y&32768?Y|4294901760:Y},y.prototype.readInt16BE=function(v,T){v=v>>>0,T||Ue(v,2,this.length);const Y=this[v+1]|this[v]<<8;return Y&32768?Y|4294901760:Y},y.prototype.readInt32LE=function(v,T){return v=v>>>0,T||Ue(v,4,this.length),this[v]|this[v+1]<<8|this[v+2]<<16|this[v+3]<<24},y.prototype.readInt32BE=function(v,T){return v=v>>>0,T||Ue(v,4,this.length),this[v]<<24|this[v+1]<<16|this[v+2]<<8|this[v+3]},y.prototype.readBigInt64LE=ot(function(v){v=v>>>0,Ze(v,"offset");const T=this[v],Y=this[v+7];(T===void 0||Y===void 0)&&Ye(v,this.length-8);const _e=this[v+4]+this[v+5]*2**8+this[v+6]*2**16+(Y<<24);return(BigInt(_e)<<BigInt(32))+BigInt(T+this[++v]*2**8+this[++v]*2**16+this[++v]*2**24)}),y.prototype.readBigInt64BE=ot(function(v){v=v>>>0,Ze(v,"offset");const T=this[v],Y=this[v+7];(T===void 0||Y===void 0)&&Ye(v,this.length-8);const _e=(T<<24)+this[++v]*2**16+this[++v]*2**8+this[++v];return(BigInt(_e)<<BigInt(32))+BigInt(this[++v]*2**24+this[++v]*2**16+this[++v]*2**8+Y)}),y.prototype.readFloatLE=function(v,T){return v=v>>>0,T||Ue(v,4,this.length),l.read(this,v,!0,23,4)},y.prototype.readFloatBE=function(v,T){return v=v>>>0,T||Ue(v,4,this.length),l.read(this,v,!1,23,4)},y.prototype.readDoubleLE=function(v,T){return v=v>>>0,T||Ue(v,8,this.length),l.read(this,v,!0,52,8)},y.prototype.readDoubleBE=function(v,T){return v=v>>>0,T||Ue(v,8,this.length),l.read(this,v,!1,52,8)};function Ve(D,v,T,Y,_e,ve){if(!y.isBuffer(D))throw new TypeError('"buffer" argument must be a Buffer instance');if(v>_e||v<ve)throw new RangeError('"value" argument is out of bounds');if(T+Y>D.length)throw new RangeError("Index out of range")}y.prototype.writeUintLE=y.prototype.writeUIntLE=function(v,T,Y,_e){if(v=+v,T=T>>>0,Y=Y>>>0,!_e){const Fe=Math.pow(2,8*Y)-1;Ve(this,v,T,Y,Fe,0)}let ve=1,Se=0;for(this[T]=v&255;++Se<Y&&(ve*=256);)this[T+Se]=v/ve&255;return T+Y},y.prototype.writeUintBE=y.prototype.writeUIntBE=function(v,T,Y,_e){if(v=+v,T=T>>>0,Y=Y>>>0,!_e){const Fe=Math.pow(2,8*Y)-1;Ve(this,v,T,Y,Fe,0)}let ve=Y-1,Se=1;for(this[T+ve]=v&255;--ve>=0&&(Se*=256);)this[T+ve]=v/Se&255;return T+Y},y.prototype.writeUint8=y.prototype.writeUInt8=function(v,T,Y){return v=+v,T=T>>>0,Y||Ve(this,v,T,1,255,0),this[T]=v&255,T+1},y.prototype.writeUint16LE=y.prototype.writeUInt16LE=function(v,T,Y){return v=+v,T=T>>>0,Y||Ve(this,v,T,2,65535,0),this[T]=v&255,this[T+1]=v>>>8,T+2},y.prototype.writeUint16BE=y.prototype.writeUInt16BE=function(v,T,Y){return v=+v,T=T>>>0,Y||Ve(this,v,T,2,65535,0),this[T]=v>>>8,this[T+1]=v&255,T+2},y.prototype.writeUint32LE=y.prototype.writeUInt32LE=function(v,T,Y){return v=+v,T=T>>>0,Y||Ve(this,v,T,4,4294967295,0),this[T+3]=v>>>24,this[T+2]=v>>>16,this[T+1]=v>>>8,this[T]=v&255,T+4},y.prototype.writeUint32BE=y.prototype.writeUInt32BE=function(v,T,Y){return v=+v,T=T>>>0,Y||Ve(this,v,T,4,4294967295,0),this[T]=v>>>24,this[T+1]=v>>>16,this[T+2]=v>>>8,this[T+3]=v&255,T+4};function lt(D,v,T,Y,_e){He(v,Y,_e,D,T,7);let ve=Number(v&BigInt(4294967295));D[T++]=ve,ve=ve>>8,D[T++]=ve,ve=ve>>8,D[T++]=ve,ve=ve>>8,D[T++]=ve;let Se=Number(v>>BigInt(32)&BigInt(4294967295));return D[T++]=Se,Se=Se>>8,D[T++]=Se,Se=Se>>8,D[T++]=Se,Se=Se>>8,D[T++]=Se,T}function ft(D,v,T,Y,_e){He(v,Y,_e,D,T,7);let ve=Number(v&BigInt(4294967295));D[T+7]=ve,ve=ve>>8,D[T+6]=ve,ve=ve>>8,D[T+5]=ve,ve=ve>>8,D[T+4]=ve;let Se=Number(v>>BigInt(32)&BigInt(4294967295));return D[T+3]=Se,Se=Se>>8,D[T+2]=Se,Se=Se>>8,D[T+1]=Se,Se=Se>>8,D[T]=Se,T+8}y.prototype.writeBigUInt64LE=ot(function(v,T=0){return lt(this,v,T,BigInt(0),BigInt("0xffffffffffffffff"))}),y.prototype.writeBigUInt64BE=ot(function(v,T=0){return ft(this,v,T,BigInt(0),BigInt("0xffffffffffffffff"))}),y.prototype.writeIntLE=function(v,T,Y,_e){if(v=+v,T=T>>>0,!_e){const je=Math.pow(2,8*Y-1);Ve(this,v,T,Y,je-1,-je)}let ve=0,Se=1,Fe=0;for(this[T]=v&255;++ve<Y&&(Se*=256);)v<0&&Fe===0&&this[T+ve-1]!==0&&(Fe=1),this[T+ve]=(v/Se>>0)-Fe&255;return T+Y},y.prototype.writeIntBE=function(v,T,Y,_e){if(v=+v,T=T>>>0,!_e){const je=Math.pow(2,8*Y-1);Ve(this,v,T,Y,je-1,-je)}let ve=Y-1,Se=1,Fe=0;for(this[T+ve]=v&255;--ve>=0&&(Se*=256);)v<0&&Fe===0&&this[T+ve+1]!==0&&(Fe=1),this[T+ve]=(v/Se>>0)-Fe&255;return T+Y},y.prototype.writeInt8=function(v,T,Y){return v=+v,T=T>>>0,Y||Ve(this,v,T,1,127,-128),v<0&&(v=255+v+1),this[T]=v&255,T+1},y.prototype.writeInt16LE=function(v,T,Y){return v=+v,T=T>>>0,Y||Ve(this,v,T,2,32767,-32768),this[T]=v&255,this[T+1]=v>>>8,T+2},y.prototype.writeInt16BE=function(v,T,Y){return v=+v,T=T>>>0,Y||Ve(this,v,T,2,32767,-32768),this[T]=v>>>8,this[T+1]=v&255,T+2},y.prototype.writeInt32LE=function(v,T,Y){return v=+v,T=T>>>0,Y||Ve(this,v,T,4,2147483647,-2147483648),this[T]=v&255,this[T+1]=v>>>8,this[T+2]=v>>>16,this[T+3]=v>>>24,T+4},y.prototype.writeInt32BE=function(v,T,Y){return v=+v,T=T>>>0,Y||Ve(this,v,T,4,2147483647,-2147483648),v<0&&(v=4294967295+v+1),this[T]=v>>>24,this[T+1]=v>>>16,this[T+2]=v>>>8,this[T+3]=v&255,T+4},y.prototype.writeBigInt64LE=ot(function(v,T=0){return lt(this,v,T,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),y.prototype.writeBigInt64BE=ot(function(v,T=0){return ft(this,v,T,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ut(D,v,T,Y,_e,ve){if(T+Y>D.length)throw new RangeError("Index out of range");if(T<0)throw new RangeError("Index out of range")}function ht(D,v,T,Y,_e){return v=+v,T=T>>>0,_e||ut(D,v,T,4),l.write(D,v,T,Y,23,4),T+4}y.prototype.writeFloatLE=function(v,T,Y){return ht(this,v,T,!0,Y)},y.prototype.writeFloatBE=function(v,T,Y){return ht(this,v,T,!1,Y)};function z(D,v,T,Y,_e){return v=+v,T=T>>>0,_e||ut(D,v,T,8),l.write(D,v,T,Y,52,8),T+8}y.prototype.writeDoubleLE=function(v,T,Y){return z(this,v,T,!0,Y)},y.prototype.writeDoubleBE=function(v,T,Y){return z(this,v,T,!1,Y)},y.prototype.copy=function(v,T,Y,_e){if(!y.isBuffer(v))throw new TypeError("argument should be a Buffer");if(Y||(Y=0),!_e&&_e!==0&&(_e=this.length),T>=v.length&&(T=v.length),T||(T=0),_e>0&&_e<Y&&(_e=Y),_e===Y||v.length===0||this.length===0)return 0;if(T<0)throw new RangeError("targetStart out of bounds");if(Y<0||Y>=this.length)throw new RangeError("Index out of range");if(_e<0)throw new RangeError("sourceEnd out of bounds");_e>this.length&&(_e=this.length),v.length-T<_e-Y&&(_e=v.length-T+Y);const ve=_e-Y;return this===v&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(T,Y,_e):Uint8Array.prototype.set.call(v,this.subarray(Y,_e),T),ve},y.prototype.fill=function(v,T,Y,_e){if(typeof v=="string"){if(typeof T=="string"?(_e=T,T=0,Y=this.length):typeof Y=="string"&&(_e=Y,Y=this.length),_e!==void 0&&typeof _e!="string")throw new TypeError("encoding must be a string");if(typeof _e=="string"&&!y.isEncoding(_e))throw new TypeError("Unknown encoding: "+_e);if(v.length===1){const Se=v.charCodeAt(0);(_e==="utf8"&&Se<128||_e==="latin1")&&(v=Se)}}else typeof v=="number"?v=v&255:typeof v=="boolean"&&(v=Number(v));if(T<0||this.length<T||this.length<Y)throw new RangeError("Out of range index");if(Y<=T)return this;T=T>>>0,Y=Y===void 0?this.length:Y>>>0,v||(v=0);let ve;if(typeof v=="number")for(ve=T;ve<Y;++ve)this[ve]=v;else{const Se=y.isBuffer(v)?v:y.from(v,_e),Fe=Se.length;if(Fe===0)throw new TypeError('The value "'+v+'" is invalid for argument "value"');for(ve=0;ve<Y-T;++ve)this[ve+T]=Se[ve%Fe]}return this};const k={};function $e(D,v,T){k[D]=class extends T{constructor(){super(),Object.defineProperty(this,"message",{value:v.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${D}]`,this.stack,delete this.name}get code(){return D}set code(_e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:_e,writable:!0})}toString(){return`${this.name} [${D}]: ${this.message}`}}}$e("ERR_BUFFER_OUT_OF_BOUNDS",function(D){return D?`${D} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),$e("ERR_INVALID_ARG_TYPE",function(D,v){return`The "${D}" argument must be of type number. Received type ${typeof v}`},TypeError),$e("ERR_OUT_OF_RANGE",function(D,v,T){let Y=`The value of "${D}" is out of range.`,_e=T;return Number.isInteger(T)&&Math.abs(T)>2**32?_e=Ee(String(T)):typeof T=="bigint"&&(_e=String(T),(T>BigInt(2)**BigInt(32)||T<-(BigInt(2)**BigInt(32)))&&(_e=Ee(_e)),_e+="n"),Y+=` It must be ${v}. Received ${_e}`,Y},RangeError);function Ee(D){let v="",T=D.length;const Y=D[0]==="-"?1:0;for(;T>=Y+4;T-=3)v=`_${D.slice(T-3,T)}${v}`;return`${D.slice(0,T)}${v}`}function Me(D,v,T){Ze(v,"offset"),(D[v]===void 0||D[v+T]===void 0)&&Ye(v,D.length-(T+1))}function He(D,v,T,Y,_e,ve){if(D>T||D<v){const Se=typeof v=="bigint"?"n":"";let Fe;throw ve>3?v===0||v===BigInt(0)?Fe=`>= 0${Se} and < 2${Se} ** ${(ve+1)*8}${Se}`:Fe=`>= -(2${Se} ** ${(ve+1)*8-1}${Se}) and < 2 ** ${(ve+1)*8-1}${Se}`:Fe=`>= ${v}${Se} and <= ${T}${Se}`,new k.ERR_OUT_OF_RANGE("value",Fe,D)}Me(Y,_e,ve)}function Ze(D,v){if(typeof D!="number")throw new k.ERR_INVALID_ARG_TYPE(v,"number",D)}function Ye(D,v,T){throw Math.floor(D)!==D?(Ze(D,T),new k.ERR_OUT_OF_RANGE(T||"offset","an integer",D)):v<0?new k.ERR_BUFFER_OUT_OF_BOUNDS:new k.ERR_OUT_OF_RANGE(T||"offset",`>= ${T?1:0} and <= ${v}`,D)}const qe=/[^+/0-9A-Za-z-_]/g;function nt(D){if(D=D.split("=")[0],D=D.trim().replace(qe,""),D.length<2)return"";for(;D.length%4!==0;)D=D+"=";return D}function Ge(D,v){v=v||1/0;let T;const Y=D.length;let _e=null;const ve=[];for(let Se=0;Se<Y;++Se){if(T=D.charCodeAt(Se),T>55295&&T<57344){if(!_e){if(T>56319){(v-=3)>-1&&ve.push(239,191,189);continue}else if(Se+1===Y){(v-=3)>-1&&ve.push(239,191,189);continue}_e=T;continue}if(T<56320){(v-=3)>-1&&ve.push(239,191,189),_e=T;continue}T=(_e-55296<<10|T-56320)+65536}else _e&&(v-=3)>-1&&ve.push(239,191,189);if(_e=null,T<128){if((v-=1)<0)break;ve.push(T)}else if(T<2048){if((v-=2)<0)break;ve.push(T>>6|192,T&63|128)}else if(T<65536){if((v-=3)<0)break;ve.push(T>>12|224,T>>6&63|128,T&63|128)}else if(T<1114112){if((v-=4)<0)break;ve.push(T>>18|240,T>>12&63|128,T>>6&63|128,T&63|128)}else throw new Error("Invalid code point")}return ve}function rt(D){const v=[];for(let T=0;T<D.length;++T)v.push(D.charCodeAt(T)&255);return v}function dt(D,v){let T,Y,_e;const ve=[];for(let Se=0;Se<D.length&&!((v-=2)<0);++Se)T=D.charCodeAt(Se),Y=T>>8,_e=T%256,ve.push(_e),ve.push(Y);return ve}function ct(D){return g.toByteArray(nt(D))}function at(D,v,T,Y){let _e;for(_e=0;_e<Y&&!(_e+T>=v.length||_e>=D.length);++_e)v[_e+T]=D[_e];return _e}function et(D,v){return D instanceof v||D!=null&&D.constructor!=null&&D.constructor.name!=null&&D.constructor.name===v.name}function _t(D){return D!==D}const pt=function(){const D="0123456789abcdef",v=new Array(256);for(let T=0;T<16;++T){const Y=T*16;for(let _e=0;_e<16;++_e)v[Y+_e]=D[T]+D[_e]}return v}();function ot(D){return typeof BigInt=="undefined"?mt:D}function mt(){throw new Error("BigInt not supported")}})(buffer$1),globalThis.Buffer=buffer$1.Buffer;var utf8$5={},utils$r={},support$5={},nodestream,blob;if(support$5.base64=!0,support$5.array=!0,support$5.string=!0,support$5.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",support$5.nodebuffer=typeof Buffer!="undefined",support$5.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")blob=support$5.blob=!1;else{var buffer=new ArrayBuffer(0);try{blob=support$5.blob=new Blob([buffer],{type:"application/zip"}).size===0}catch(r){try{var Builder=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,builder=new Builder;builder.append(buffer),blob=support$5.blob=builder.getBlob("application/zip").size===0}catch(g){blob=support$5.blob=!1}}}try{nodestream=support$5.nodestream=!!require("readable-stream").Readable}catch(r){nodestream=support$5.nodestream=!1}var base64$1={},utils$q=utils$r,support$4=support$5,_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";base64$1.encode=function(r){for(var g=[],l,E,A,I,N,y,M,O=0,Z=r.length,xe=Z,V=utils$q.getTypeOf(r)!=="string";O<r.length;)xe=Z-O,V?(l=r[O++],E=O<Z?r[O++]:0,A=O<Z?r[O++]:0):(l=r.charCodeAt(O++),E=O<Z?r.charCodeAt(O++):0,A=O<Z?r.charCodeAt(O++):0),I=l>>2,N=(l&3)<<4|E>>4,y=xe>1?(E&15)<<2|A>>6:64,M=xe>2?A&63:64,g.push(_keyStr.charAt(I)+_keyStr.charAt(N)+_keyStr.charAt(y)+_keyStr.charAt(M));return g.join("")},base64$1.decode=function(r){var g,l,E,A,I,N,y,M=0,O=0,Z="data:";if(r.substr(0,Z.length)===Z)throw new Error("Invalid base64 input, it looks like a data url.");r=r.replace(/[^A-Za-z0-9+/=]/g,"");var xe=r.length*3/4;if(r.charAt(r.length-1)===_keyStr.charAt(64)&&xe--,r.charAt(r.length-2)===_keyStr.charAt(64)&&xe--,xe%1!==0)throw new Error("Invalid base64 input, bad content length.");var V;for(support$4.uint8array?V=new Uint8Array(xe|0):V=new Array(xe|0);M<r.length;)A=_keyStr.indexOf(r.charAt(M++)),I=_keyStr.indexOf(r.charAt(M++)),N=_keyStr.indexOf(r.charAt(M++)),y=_keyStr.indexOf(r.charAt(M++)),g=A<<2|I>>4,l=(I&15)<<4|N>>2,E=(N&3)<<6|y,V[O++]=g,N!==64&&(V[O++]=l),y!==64&&(V[O++]=E);return V};var nodejsUtils$2={isNode:typeof Buffer!="undefined",newBufferFrom:function(r,g){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,g);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,g)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var g=new Buffer(r);return g.fill(0),g},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}},Mutation=commonjsGlobal.MutationObserver||commonjsGlobal.WebKitMutationObserver,scheduleDrain;if(Mutation){var called=0,observer=new Mutation(nextTick),element=commonjsGlobal.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(!commonjsGlobal.setImmediate&&typeof commonjsGlobal.MessageChannel!="undefined"){var channel=new commonjsGlobal.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}else"document"in commonjsGlobal&&"onreadystatechange"in commonjsGlobal.document.createElement("script")?scheduleDrain=function(){var r=commonjsGlobal.document.createElement("script");r.onreadystatechange=function(){nextTick(),r.onreadystatechange=null,r.parentNode.removeChild(r),r=null},commonjsGlobal.document.documentElement.appendChild(r)}:scheduleDrain=function(){setTimeout(nextTick,0)};var draining,queue=[];function nextTick(){draining=!0;for(var r,g,l=queue.length;l;){for(g=queue,queue=[],r=-1;++r<l;)g[r]();l=queue.length}draining=!1}var lib$2=immediate$1;function immediate$1(r){queue.push(r)===1&&!draining&&scheduleDrain()}var immediate=lib$2;function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"],lib$1=Promise$1;function Promise$1(r){if(typeof r!="function")throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,r!==INTERNAL&&safelyResolveThenable(this,r)}Promise$1.prototype.finally=function(r){if(typeof r!="function")return this;var g=this.constructor;return this.then(l,E);function l(A){function I(){return A}return g.resolve(r()).then(I)}function E(A){function I(){throw A}return g.resolve(r()).then(I)}},Promise$1.prototype.catch=function(r){return this.then(null,r)},Promise$1.prototype.then=function(r,g){if(typeof r!="function"&&this.state===FULFILLED||typeof g!="function"&&this.state===REJECTED)return this;var l=new this.constructor(INTERNAL);if(this.state!==PENDING){var E=this.state===FULFILLED?r:g;unwrap(l,E,this.outcome)}else this.queue.push(new QueueItem(l,r,g));return l};function QueueItem(r,g,l){this.promise=r,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof l=="function"&&(this.onRejected=l,this.callRejected=this.otherCallRejected)}QueueItem.prototype.callFulfilled=function(r){handlers.resolve(this.promise,r)},QueueItem.prototype.otherCallFulfilled=function(r){unwrap(this.promise,this.onFulfilled,r)},QueueItem.prototype.callRejected=function(r){handlers.reject(this.promise,r)},QueueItem.prototype.otherCallRejected=function(r){unwrap(this.promise,this.onRejected,r)};function unwrap(r,g,l){immediate(function(){var E;try{E=g(l)}catch(A){return handlers.reject(r,A)}E===r?handlers.reject(r,new TypeError("Cannot resolve promise with itself")):handlers.resolve(r,E)})}handlers.resolve=function(r,g){var l=tryCatch(getThen,g);if(l.status==="error")return handlers.reject(r,l.value);var E=l.value;if(E)safelyResolveThenable(r,E);else{r.state=FULFILLED,r.outcome=g;for(var A=-1,I=r.queue.length;++A<I;)r.queue[A].callFulfilled(g)}return r},handlers.reject=function(r,g){r.state=REJECTED,r.outcome=g;for(var l=-1,E=r.queue.length;++l<E;)r.queue[l].callRejected(g);return r};function getThen(r){var g=r&&r.then;if(r&&(typeof r=="object"||typeof r=="function")&&typeof g=="function")return function(){g.apply(r,arguments)}}function safelyResolveThenable(r,g){var l=!1;function E(y){l||(l=!0,handlers.reject(r,y))}function A(y){l||(l=!0,handlers.resolve(r,y))}function I(){g(A,E)}var N=tryCatch(I);N.status==="error"&&E(N.value)}function tryCatch(r,g){var l={};try{l.value=r(g),l.status="success"}catch(E){l.status="error",l.value=E}return l}Promise$1.resolve=resolve;function resolve(r){return r instanceof this?r:handlers.resolve(new this(INTERNAL),r)}Promise$1.reject=reject;function reject(r){var g=new this(INTERNAL);return handlers.reject(g,r)}Promise$1.all=all;function all(r){var g=this;if(Object.prototype.toString.call(r)!=="[object Array]")return this.reject(new TypeError("must be an array"));var l=r.length,E=!1;if(!l)return this.resolve([]);for(var A=new Array(l),I=0,N=-1,y=new this(INTERNAL);++N<l;)M(r[N],N);return y;function M(O,Z){g.resolve(O).then(xe,function(V){E||(E=!0,handlers.reject(y,V))});function xe(V){A[Z]=V,++I===l&&!E&&(E=!0,handlers.resolve(y,A))}}}Promise$1.race=race;function race(r){var g=this;if(Object.prototype.toString.call(r)!=="[object Array]")return this.reject(new TypeError("must be an array"));var l=r.length,E=!1;if(!l)return this.resolve([]);for(var A=-1,I=new this(INTERNAL);++A<l;)N(r[A]);return I;function N(y){g.resolve(y).then(function(M){E||(E=!0,handlers.resolve(I,M))},function(M){E||(E=!0,handlers.reject(I,M))})}}var ES6Promise=null;typeof Promise!="undefined"?ES6Promise=Promise:ES6Promise=lib$1;var external$3={Promise:ES6Promise};(function(r,g){if(r.setImmediate)return;var l=1,E={},A=!1,I=r.document,N;function y(Te){typeof Te!="function"&&(Te=new Function(""+Te));for(var Ne=new Array(arguments.length-1),Ie=0;Ie<Ne.length;Ie++)Ne[Ie]=arguments[Ie+1];var Ae={callback:Te,args:Ne};return E[l]=Ae,N(l),l++}function M(Te){delete E[Te]}function O(Te){var Ne=Te.callback,Ie=Te.args;switch(Ie.length){case 0:Ne();break;case 1:Ne(Ie[0]);break;case 2:Ne(Ie[0],Ie[1]);break;case 3:Ne(Ie[0],Ie[1],Ie[2]);break;default:Ne.apply(g,Ie);break}}function Z(Te){if(A)setTimeout(Z,0,Te);else{var Ne=E[Te];if(Ne){A=!0;try{O(Ne)}finally{M(Te),A=!1}}}}function xe(){N=function(Te){setTimeout(function(){Z(Te)})}}function V(){if(r.postMessage&&!r.importScripts){var Te=!0,Ne=r.onmessage;return r.onmessage=function(){Te=!1},r.postMessage("","*"),r.onmessage=Ne,Te}}function ce(){var Te="setImmediate$"+Math.random()+"$",Ne=function(Ie){Ie.source===r&&typeof Ie.data=="string"&&Ie.data.indexOf(Te)===0&&Z(+Ie.data.slice(Te.length))};r.addEventListener?r.addEventListener("message",Ne,!1):r.attachEvent("onmessage",Ne),N=function(Ie){r.postMessage(Te+Ie,"*")}}function me(){var Te=new MessageChannel;Te.port1.onmessage=function(Ne){var Ie=Ne.data;Z(Ie)},N=function(Ne){Te.port2.postMessage(Ne)}}function we(){var Te=I.documentElement;N=function(Ne){var Ie=I.createElement("script");Ie.onreadystatechange=function(){Z(Ne),Ie.onreadystatechange=null,Te.removeChild(Ie),Ie=null},Te.appendChild(Ie)}}function ye(){N=function(Te){setTimeout(Z,0,Te)}}var be=Object.getPrototypeOf&&Object.getPrototypeOf(r);be=be&&be.setTimeout?be:r,{}.toString.call(r.undefined)==="[object undefined]"?xe():V()?ce():r.MessageChannel?me():I&&"onreadystatechange"in I.createElement("script")?we():ye(),be.setImmediate=y,be.clearImmediate=M})(typeof self=="undefined"?commonjsGlobal:self),function(r){var g=support$5,l=base64$1,E=nodejsUtils$2,A=external$3;function I(V){var ce=null;return g.uint8array?ce=new Uint8Array(V.length):ce=new Array(V.length),y(V,ce)}r.newBlob=function(V,ce){r.checkSupport("blob");try{return new Blob([V],{type:ce})}catch(ye){try{var me=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,we=new me;return we.append(V),we.getBlob(ce)}catch(be){throw new Error("Bug : can't construct the Blob.")}}};function N(V){return V}function y(V,ce){for(var me=0;me<V.length;++me)ce[me]=V.charCodeAt(me)&255;return ce}var M={stringifyByChunk:function(V,ce,me){var we=[],ye=0,be=V.length;if(be<=me)return String.fromCharCode.apply(null,V);for(;ye<be;)ce==="array"||ce==="nodebuffer"?we.push(String.fromCharCode.apply(null,V.slice(ye,Math.min(ye+me,be)))):we.push(String.fromCharCode.apply(null,V.subarray(ye,Math.min(ye+me,be)))),ye+=me;return we.join("")},stringifyByChar:function(V){for(var ce="",me=0;me<V.length;me++)ce+=String.fromCharCode(V[me]);return ce},applyCanBeUsed:{uint8array:function(){try{return g.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(V){return!1}}(),nodebuffer:function(){try{return g.nodebuffer&&String.fromCharCode.apply(null,E.allocBuffer(1)).length===1}catch(V){return!1}}()}};function O(V){var ce=65536,me=r.getTypeOf(V),we=!0;if(me==="uint8array"?we=M.applyCanBeUsed.uint8array:me==="nodebuffer"&&(we=M.applyCanBeUsed.nodebuffer),we)for(;ce>1;)try{return M.stringifyByChunk(V,me,ce)}catch(ye){ce=Math.floor(ce/2)}return M.stringifyByChar(V)}r.applyFromCharCode=O;function Z(V,ce){for(var me=0;me<V.length;me++)ce[me]=V[me];return ce}var xe={};xe.string={string:N,array:function(V){return y(V,new Array(V.length))},arraybuffer:function(V){return xe.string.uint8array(V).buffer},uint8array:function(V){return y(V,new Uint8Array(V.length))},nodebuffer:function(V){return y(V,E.allocBuffer(V.length))}},xe.array={string:O,array:N,arraybuffer:function(V){return new Uint8Array(V).buffer},uint8array:function(V){return new Uint8Array(V)},nodebuffer:function(V){return E.newBufferFrom(V)}},xe.arraybuffer={string:function(V){return O(new Uint8Array(V))},array:function(V){return Z(new Uint8Array(V),new Array(V.byteLength))},arraybuffer:N,uint8array:function(V){return new Uint8Array(V)},nodebuffer:function(V){return E.newBufferFrom(new Uint8Array(V))}},xe.uint8array={string:O,array:function(V){return Z(V,new Array(V.length))},arraybuffer:function(V){return V.buffer},uint8array:N,nodebuffer:function(V){return E.newBufferFrom(V)}},xe.nodebuffer={string:O,array:function(V){return Z(V,new Array(V.length))},arraybuffer:function(V){return xe.nodebuffer.uint8array(V).buffer},uint8array:function(V){return Z(V,new Uint8Array(V.length))},nodebuffer:N},r.transformTo=function(V,ce){if(ce||(ce=""),!V)return ce;r.checkSupport(V);var me=r.getTypeOf(ce),we=xe[me][V](ce);return we},r.resolve=function(V){for(var ce=V.split("/"),me=[],we=0;we<ce.length;we++){var ye=ce[we];ye==="."||ye===""&&we!==0&&we!==ce.length-1||(ye===".."?me.pop():me.push(ye))}return me.join("/")},r.getTypeOf=function(V){if(typeof V=="string")return"string";if(Object.prototype.toString.call(V)==="[object Array]")return"array";if(g.nodebuffer&&E.isBuffer(V))return"nodebuffer";if(g.uint8array&&V instanceof Uint8Array)return"uint8array";if(g.arraybuffer&&V instanceof ArrayBuffer)return"arraybuffer"},r.checkSupport=function(V){var ce=g[V.toLowerCase()];if(!ce)throw new Error(V+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(V){var ce="",me,we;for(we=0;we<(V||"").length;we++)me=V.charCodeAt(we),ce+="\\x"+(me<16?"0":"")+me.toString(16).toUpperCase();return ce},r.delay=function(V,ce,me){setImmediate(function(){V.apply(me||null,ce||[])})},r.inherits=function(V,ce){var me=function(){};me.prototype=ce.prototype,V.prototype=new me},r.extend=function(){var V={},ce,me;for(ce=0;ce<arguments.length;ce++)for(me in arguments[ce])Object.prototype.hasOwnProperty.call(arguments[ce],me)&&typeof V[me]=="undefined"&&(V[me]=arguments[ce][me]);return V},r.prepareContent=function(V,ce,me,we,ye){var be=A.Promise.resolve(ce).then(function(Te){var Ne=g.blob&&(Te instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Te))!==-1);return Ne&&typeof FileReader!="undefined"?new A.Promise(function(Ie,Ae){var Re=new FileReader;Re.onload=function(ke){Ie(ke.target.result)},Re.onerror=function(ke){Ae(ke.target.error)},Re.readAsArrayBuffer(Te)}):Te});return be.then(function(Te){var Ne=r.getTypeOf(Te);return Ne?(Ne==="arraybuffer"?Te=r.transformTo("uint8array",Te):Ne==="string"&&(ye?Te=l.decode(Te):me&&we!==!0&&(Te=I(Te))),Te):A.Promise.reject(new Error("Can't read the data of '"+V+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}}(utils$r);function GenericWorker$b(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}GenericWorker$b.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return this.isFinished?!1:(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,g){return this._listeners[r].push(g),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,g){if(this._listeners[r])for(var l=0;l<this._listeners[r].length;l++)this._listeners[r][l].call(this,g)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var g=this;return r.on("data",function(l){g.processChunk(l)}),r.on("end",function(){g.end()}),r.on("error",function(l){g.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var r=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,g){return this.extraStreamInfo[r]=g,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}};var GenericWorker_1=GenericWorker$b;(function(r){for(var g=utils$r,l=support$5,E=nodejsUtils$2,A=GenericWorker_1,I=new Array(256),N=0;N<256;N++)I[N]=N>=252?6:N>=248?5:N>=240?4:N>=224?3:N>=192?2:1;I[254]=I[254]=1;var y=function(V){var ce,me,we,ye,be,Te=V.length,Ne=0;for(ye=0;ye<Te;ye++)me=V.charCodeAt(ye),(me&64512)===55296&&ye+1<Te&&(we=V.charCodeAt(ye+1),(we&64512)===56320&&(me=65536+(me-55296<<10)+(we-56320),ye++)),Ne+=me<128?1:me<2048?2:me<65536?3:4;for(l.uint8array?ce=new Uint8Array(Ne):ce=new Array(Ne),be=0,ye=0;be<Ne;ye++)me=V.charCodeAt(ye),(me&64512)===55296&&ye+1<Te&&(we=V.charCodeAt(ye+1),(we&64512)===56320&&(me=65536+(me-55296<<10)+(we-56320),ye++)),me<128?ce[be++]=me:me<2048?(ce[be++]=192|me>>>6,ce[be++]=128|me&63):me<65536?(ce[be++]=224|me>>>12,ce[be++]=128|me>>>6&63,ce[be++]=128|me&63):(ce[be++]=240|me>>>18,ce[be++]=128|me>>>12&63,ce[be++]=128|me>>>6&63,ce[be++]=128|me&63);return ce},M=function(V,ce){var me;for(ce=ce||V.length,ce>V.length&&(ce=V.length),me=ce-1;me>=0&&(V[me]&192)===128;)me--;return me<0||me===0?ce:me+I[V[me]]>ce?me:ce},O=function(V){var ce,me,we,ye,be=V.length,Te=new Array(be*2);for(me=0,ce=0;ce<be;){if(we=V[ce++],we<128){Te[me++]=we;continue}if(ye=I[we],ye>4){Te[me++]=65533,ce+=ye-1;continue}for(we&=ye===2?31:ye===3?15:7;ye>1&&ce<be;)we=we<<6|V[ce++]&63,ye--;if(ye>1){Te[me++]=65533;continue}we<65536?Te[me++]=we:(we-=65536,Te[me++]=55296|we>>10&1023,Te[me++]=56320|we&1023)}return Te.length!==me&&(Te.subarray?Te=Te.subarray(0,me):Te.length=me),g.applyFromCharCode(Te)};r.utf8encode=function(ce){return l.nodebuffer?E.newBufferFrom(ce,"utf-8"):y(ce)},r.utf8decode=function(ce){return l.nodebuffer?g.transformTo("nodebuffer",ce).toString("utf-8"):(ce=g.transformTo(l.uint8array?"uint8array":"array",ce),O(ce))};function Z(){A.call(this,"utf-8 decode"),this.leftOver=null}g.inherits(Z,A),Z.prototype.processChunk=function(V){var ce=g.transformTo(l.uint8array?"uint8array":"array",V.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var me=ce;ce=new Uint8Array(me.length+this.leftOver.length),ce.set(this.leftOver,0),ce.set(me,this.leftOver.length)}else ce=this.leftOver.concat(ce);this.leftOver=null}var we=M(ce),ye=ce;we!==ce.length&&(l.uint8array?(ye=ce.subarray(0,we),this.leftOver=ce.subarray(we,ce.length)):(ye=ce.slice(0,we),this.leftOver=ce.slice(we,ce.length))),this.push({data:r.utf8decode(ye),meta:V.meta})},Z.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=Z;function xe(){A.call(this,"utf-8 encode")}g.inherits(xe,A),xe.prototype.processChunk=function(V){this.push({data:r.utf8encode(V.data),meta:V.meta})},r.Utf8EncodeWorker=xe})(utf8$5);var GenericWorker$a=GenericWorker_1,utils$p=utils$r;function ConvertWorker$1(r){GenericWorker$a.call(this,"ConvertWorker to "+r),this.destType=r}utils$p.inherits(ConvertWorker$1,GenericWorker$a),ConvertWorker$1.prototype.processChunk=function(r){this.push({data:utils$p.transformTo(this.destType,r.data),meta:r.meta})};var ConvertWorker_1=ConvertWorker$1,utils$o=utils$r,ConvertWorker=ConvertWorker_1,GenericWorker$9=GenericWorker_1,base64=base64$1,support$3=support$5,external$2=external$3,NodejsStreamOutputAdapter=null;if(support$3.nodestream)try{NodejsStreamOutputAdapter=require("../nodejs/NodejsStreamOutputAdapter")}catch(r){}function transformZipOutput(r,g,l){switch(r){case"blob":return utils$o.newBlob(utils$o.transformTo("arraybuffer",g),l);case"base64":return base64.encode(g);default:return utils$o.transformTo(r,g)}}function concat(r,g){var l,E=0,A=null,I=0;for(l=0;l<g.length;l++)I+=g[l].length;switch(r){case"string":return g.join("");case"array":return Array.prototype.concat.apply([],g);case"uint8array":for(A=new Uint8Array(I),l=0;l<g.length;l++)A.set(g[l],E),E+=g[l].length;return A;case"nodebuffer":return Buffer.concat(g);default:throw new Error("concat : unsupported type '"+r+"'")}}function accumulate(r,g){return new external$2.Promise(function(l,E){var A=[],I=r._internalType,N=r._outputType,y=r._mimeType;r.on("data",function(M,O){A.push(M),g&&g(O)}).on("error",function(M){A=[],E(M)}).on("end",function(){try{var M=transformZipOutput(N,concat(I,A),y);l(M)}catch(O){E(O)}A=[]}).resume()})}function StreamHelper$2(r,g,l){var E=g;switch(g){case"blob":case"arraybuffer":E="uint8array";break;case"base64":E="string";break}try{this._internalType=E,this._outputType=g,this._mimeType=l,utils$o.checkSupport(E),this._worker=r.pipe(new ConvertWorker(E)),r.lock()}catch(A){this._worker=new GenericWorker$9("error"),this._worker.error(A)}}StreamHelper$2.prototype={accumulate:function(r){return accumulate(this,r)},on:function(r,g){var l=this;return r==="data"?this._worker.on(r,function(E){g.call(l,E.data,E.meta)}):this._worker.on(r,function(){utils$o.delay(g,arguments,l)}),this},resume:function(){return utils$o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(r){if(utils$o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new NodejsStreamOutputAdapter(this,{objectMode:this._outputType!=="nodebuffer"},r)}};var StreamHelper_1=StreamHelper$2,defaults$1={};defaults$1.base64=!1,defaults$1.binary=!1,defaults$1.dir=!1,defaults$1.createFolders=!0,defaults$1.date=null,defaults$1.compression=null,defaults$1.compressionOptions=null,defaults$1.comment=null,defaults$1.unixPermissions=null,defaults$1.dosPermissions=null;var utils$n=utils$r,GenericWorker$8=GenericWorker_1,DEFAULT_BLOCK_SIZE=16*1024;function DataWorker$2(r){GenericWorker$8.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,r.then(function(l){g.dataIsReady=!0,g.data=l,g.max=l&&l.length||0,g.type=utils$n.getTypeOf(l),g.isPaused||g._tickAndRepeat()},function(l){g.error(l)})}utils$n.inherits(DataWorker$2,GenericWorker$8),DataWorker$2.prototype.cleanUp=function(){GenericWorker$8.prototype.cleanUp.call(this),this.data=null},DataWorker$2.prototype.resume=function(){return GenericWorker$8.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,utils$n.delay(this._tickAndRepeat,[],this)),!0):!1},DataWorker$2.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(utils$n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},DataWorker$2.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var r=DEFAULT_BLOCK_SIZE,g=null,l=Math.min(this.max,this.index+r);if(this.index>=this.max)return this.end();switch(this.type){case"string":g=this.data.substring(this.index,l);break;case"uint8array":g=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":g=this.data.slice(this.index,l);break}return this.index=l,this.push({data:g,meta:{percent:this.max?this.index/this.max*100:0}})};var DataWorker_1=DataWorker$2,utils$m=utils$r;function makeTable$1(){for(var r,g=[],l=0;l<256;l++){r=l;for(var E=0;E<8;E++)r=r&1?3988292384^r>>>1:r>>>1;g[l]=r}return g}var crcTable$1=makeTable$1();function crc32$5(r,g,l,E){var A=crcTable$1,I=E+l;r=r^-1;for(var N=E;N<I;N++)r=r>>>8^A[(r^g[N])&255];return r^-1}function crc32str(r,g,l,E){var A=crcTable$1,I=E+l;r=r^-1;for(var N=E;N<I;N++)r=r>>>8^A[(r^g.charCodeAt(N))&255];return r^-1}var crc32_1$1=function(g,l){if(typeof g=="undefined"||!g.length)return 0;var E=utils$m.getTypeOf(g)!=="string";return E?crc32$5(l|0,g,g.length,0):crc32str(l|0,g,g.length,0)},GenericWorker$7=GenericWorker_1,crc32$4=crc32_1$1,utils$l=utils$r;function Crc32Probe$2(){GenericWorker$7.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}utils$l.inherits(Crc32Probe$2,GenericWorker$7),Crc32Probe$2.prototype.processChunk=function(r){this.streamInfo.crc32=crc32$4(r.data,this.streamInfo.crc32||0),this.push(r)};var Crc32Probe_1=Crc32Probe$2,utils$k=utils$r,GenericWorker$6=GenericWorker_1;function DataLengthProbe$1(r){GenericWorker$6.call(this,"DataLengthProbe for "+r),this.propName=r,this.withStreamInfo(r,0)}utils$k.inherits(DataLengthProbe$1,GenericWorker$6),DataLengthProbe$1.prototype.processChunk=function(r){if(r){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+r.data.length}GenericWorker$6.prototype.processChunk.call(this,r)};var DataLengthProbe_1=DataLengthProbe$1,external$1=external$3,DataWorker$1=DataWorker_1,Crc32Probe$1=Crc32Probe_1,DataLengthProbe=DataLengthProbe_1;function CompressedObject$3(r,g,l,E,A){this.compressedSize=r,this.uncompressedSize=g,this.crc32=l,this.compression=E,this.compressedContent=A}CompressedObject$3.prototype={getContentWorker:function(){var r=new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new DataLengthProbe("data_length")),g=this;return r.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),r},getCompressedWorker:function(){return new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},CompressedObject$3.createWorkerFrom=function(r,g,l){return r.pipe(new Crc32Probe$1).pipe(new DataLengthProbe("uncompressedSize")).pipe(g.compressWorker(l)).pipe(new DataLengthProbe("compressedSize")).withStreamInfo("compression",g)};var compressedObject=CompressedObject$3,StreamHelper$1=StreamHelper_1,DataWorker=DataWorker_1,utf8$4=utf8$5,CompressedObject$2=compressedObject,GenericWorker$5=GenericWorker_1,ZipObject$1=function(r,g,l){this.name=r,this.dir=l.dir,this.date=l.date,this.comment=l.comment,this.unixPermissions=l.unixPermissions,this.dosPermissions=l.dosPermissions,this._data=g,this._dataBinary=l.binary,this.options={compression:l.compression,compressionOptions:l.compressionOptions}};ZipObject$1.prototype={internalStream:function(r){var g=null,l="string";try{if(!r)throw new Error("No output type specified.");l=r.toLowerCase();var E=l==="string"||l==="text";(l==="binarystring"||l==="text")&&(l="string"),g=this._decompressWorker();var A=!this._dataBinary;A&&!E&&(g=g.pipe(new utf8$4.Utf8EncodeWorker)),!A&&E&&(g=g.pipe(new utf8$4.Utf8DecodeWorker))}catch(I){g=new GenericWorker$5("error"),g.error(I)}return new StreamHelper$1(g,l,"")},async:function(r,g){return this.internalStream(r).accumulate(g)},nodeStream:function(r,g){return this.internalStream(r||"nodebuffer").toNodejsStream(g)},_compressWorker:function(r,g){if(this._data instanceof CompressedObject$2&&this._data.compression.magic===r.magic)return this._data.getCompressedWorker();var l=this._decompressWorker();return this._dataBinary||(l=l.pipe(new utf8$4.Utf8EncodeWorker)),CompressedObject$2.createWorkerFrom(l,r,g)},_decompressWorker:function(){return this._data instanceof CompressedObject$2?this._data.getContentWorker():this._data instanceof GenericWorker$5?this._data:new DataWorker(this._data)}};for(var removedMethods=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],removedFn=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},i$1=0;i$1<removedMethods.length;i$1++)ZipObject$1.prototype[removedMethods[i$1]]=removedFn;var zipObject=ZipObject$1,generate$1={},compressions$2={},flate={},common={};(function(r){var g=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function l(I,N){return Object.prototype.hasOwnProperty.call(I,N)}r.assign=function(I){for(var N=Array.prototype.slice.call(arguments,1);N.length;){var y=N.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var M in y)l(y,M)&&(I[M]=y[M])}}return I},r.shrinkBuf=function(I,N){return I.length===N?I:I.subarray?I.subarray(0,N):(I.length=N,I)};var E={arraySet:function(I,N,y,M,O){if(N.subarray&&I.subarray){I.set(N.subarray(y,y+M),O);return}for(var Z=0;Z<M;Z++)I[O+Z]=N[y+Z]},flattenChunks:function(I){var N,y,M,O,Z,xe;for(M=0,N=0,y=I.length;N<y;N++)M+=I[N].length;for(xe=new Uint8Array(M),O=0,N=0,y=I.length;N<y;N++)Z=I[N],xe.set(Z,O),O+=Z.length;return xe}},A={arraySet:function(I,N,y,M,O){for(var Z=0;Z<M;Z++)I[O+Z]=N[y+Z]},flattenChunks:function(I){return[].concat.apply([],I)}};r.setTyped=function(I){I?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,E)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,A))},r.setTyped(g)})(common);var deflate$4={},deflate$3={},trees$1={},utils$j=common,Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(r){for(var g=r.length;--g>=0;)r[g]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);var static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(r,g,l,E,A){this.static_tree=r,this.extra_bits=g,this.extra_base=l,this.elems=E,this.max_length=A,this.has_stree=r&&r.length}var static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(r,g){this.dyn_tree=r,this.max_code=0,this.stat_desc=g}function d_code(r){return r<256?_dist_code[r]:_dist_code[256+(r>>>7)]}function put_short(r,g){r.pending_buf[r.pending++]=g&255,r.pending_buf[r.pending++]=g>>>8&255}function send_bits(r,g,l){r.bi_valid>Buf_size-l?(r.bi_buf|=g<<r.bi_valid&65535,put_short(r,r.bi_buf),r.bi_buf=g>>Buf_size-r.bi_valid,r.bi_valid+=l-Buf_size):(r.bi_buf|=g<<r.bi_valid&65535,r.bi_valid+=l)}function send_code(r,g,l){send_bits(r,l[g*2],l[g*2+1])}function bi_reverse(r,g){var l=0;do l|=r&1,r>>>=1,l<<=1;while(--g>0);return l>>>1}function bi_flush(r){r.bi_valid===16?(put_short(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=r.bi_buf&255,r.bi_buf>>=8,r.bi_valid-=8)}function gen_bitlen(r,g){var l=g.dyn_tree,E=g.max_code,A=g.stat_desc.static_tree,I=g.stat_desc.has_stree,N=g.stat_desc.extra_bits,y=g.stat_desc.extra_base,M=g.stat_desc.max_length,O,Z,xe,V,ce,me,we=0;for(V=0;V<=MAX_BITS$1;V++)r.bl_count[V]=0;for(l[r.heap[r.heap_max]*2+1]=0,O=r.heap_max+1;O<HEAP_SIZE$1;O++)Z=r.heap[O],V=l[l[Z*2+1]*2+1]+1,V>M&&(V=M,we++),l[Z*2+1]=V,!(Z>E)&&(r.bl_count[V]++,ce=0,Z>=y&&(ce=N[Z-y]),me=l[Z*2],r.opt_len+=me*(V+ce),I&&(r.static_len+=me*(A[Z*2+1]+ce)));if(we!==0){do{for(V=M-1;r.bl_count[V]===0;)V--;r.bl_count[V]--,r.bl_count[V+1]+=2,r.bl_count[M]--,we-=2}while(we>0);for(V=M;V!==0;V--)for(Z=r.bl_count[V];Z!==0;)xe=r.heap[--O],!(xe>E)&&(l[xe*2+1]!==V&&(r.opt_len+=(V-l[xe*2+1])*l[xe*2],l[xe*2+1]=V),Z--)}}function gen_codes(r,g,l){var E=new Array(MAX_BITS$1+1),A=0,I,N;for(I=1;I<=MAX_BITS$1;I++)E[I]=A=A+l[I-1]<<1;for(N=0;N<=g;N++){var y=r[N*2+1];y!==0&&(r[N*2]=bi_reverse(E[y]++,y))}}function tr_static_init(){var r,g,l,E,A,I=new Array(MAX_BITS$1+1);for(l=0,E=0;E<LENGTH_CODES$1-1;E++)for(base_length[E]=l,r=0;r<1<<extra_lbits[E];r++)_length_code[l++]=E;for(_length_code[l-1]=E,A=0,E=0;E<16;E++)for(base_dist[E]=A,r=0;r<1<<extra_dbits[E];r++)_dist_code[A++]=E;for(A>>=7;E<D_CODES$1;E++)for(base_dist[E]=A<<7,r=0;r<1<<extra_dbits[E]-7;r++)_dist_code[256+A++]=E;for(g=0;g<=MAX_BITS$1;g++)I[g]=0;for(r=0;r<=143;)static_ltree[r*2+1]=8,r++,I[8]++;for(;r<=255;)static_ltree[r*2+1]=9,r++,I[9]++;for(;r<=279;)static_ltree[r*2+1]=7,r++,I[7]++;for(;r<=287;)static_ltree[r*2+1]=8,r++,I[8]++;for(gen_codes(static_ltree,L_CODES$1+1,I),r=0;r<D_CODES$1;r++)static_dtree[r*2+1]=5,static_dtree[r*2]=bi_reverse(r,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)}function init_block(r){var g;for(g=0;g<L_CODES$1;g++)r.dyn_ltree[g*2]=0;for(g=0;g<D_CODES$1;g++)r.dyn_dtree[g*2]=0;for(g=0;g<BL_CODES$1;g++)r.bl_tree[g*2]=0;r.dyn_ltree[END_BLOCK*2]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0}function bi_windup(r){r.bi_valid>8?put_short(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0}function copy_block(r,g,l,E){bi_windup(r),E&&(put_short(r,l),put_short(r,~l)),utils$j.arraySet(r.pending_buf,r.window,g,l,r.pending),r.pending+=l}function smaller(r,g,l,E){var A=g*2,I=l*2;return r[A]<r[I]||r[A]===r[I]&&E[g]<=E[l]}function pqdownheap(r,g,l){for(var E=r.heap[l],A=l<<1;A<=r.heap_len&&(A<r.heap_len&&smaller(g,r.heap[A+1],r.heap[A],r.depth)&&A++,!smaller(g,E,r.heap[A],r.depth));)r.heap[l]=r.heap[A],l=A,A<<=1;r.heap[l]=E}function compress_block(r,g,l){var E,A,I=0,N,y;if(r.last_lit!==0)do E=r.pending_buf[r.d_buf+I*2]<<8|r.pending_buf[r.d_buf+I*2+1],A=r.pending_buf[r.l_buf+I],I++,E===0?send_code(r,A,g):(N=_length_code[A],send_code(r,N+LITERALS$1+1,g),y=extra_lbits[N],y!==0&&(A-=base_length[N],send_bits(r,A,y)),E--,N=d_code(E),send_code(r,N,l),y=extra_dbits[N],y!==0&&(E-=base_dist[N],send_bits(r,E,y)));while(I<r.last_lit);send_code(r,END_BLOCK,g)}function build_tree(r,g){var l=g.dyn_tree,E=g.stat_desc.static_tree,A=g.stat_desc.has_stree,I=g.stat_desc.elems,N,y,M=-1,O;for(r.heap_len=0,r.heap_max=HEAP_SIZE$1,N=0;N<I;N++)l[N*2]!==0?(r.heap[++r.heap_len]=M=N,r.depth[N]=0):l[N*2+1]=0;for(;r.heap_len<2;)O=r.heap[++r.heap_len]=M<2?++M:0,l[O*2]=1,r.depth[O]=0,r.opt_len--,A&&(r.static_len-=E[O*2+1]);for(g.max_code=M,N=r.heap_len>>1;N>=1;N--)pqdownheap(r,l,N);O=I;do N=r.heap[1],r.heap[1]=r.heap[r.heap_len--],pqdownheap(r,l,1),y=r.heap[1],r.heap[--r.heap_max]=N,r.heap[--r.heap_max]=y,l[O*2]=l[N*2]+l[y*2],r.depth[O]=(r.depth[N]>=r.depth[y]?r.depth[N]:r.depth[y])+1,l[N*2+1]=l[y*2+1]=O,r.heap[1]=O++,pqdownheap(r,l,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],gen_bitlen(r,g),gen_codes(l,M,r.bl_count)}function scan_tree(r,g,l){var E,A=-1,I,N=g[0*2+1],y=0,M=7,O=4;for(N===0&&(M=138,O=3),g[(l+1)*2+1]=65535,E=0;E<=l;E++)I=N,N=g[(E+1)*2+1],!(++y<M&&I===N)&&(y<O?r.bl_tree[I*2]+=y:I!==0?(I!==A&&r.bl_tree[I*2]++,r.bl_tree[REP_3_6*2]++):y<=10?r.bl_tree[REPZ_3_10*2]++:r.bl_tree[REPZ_11_138*2]++,y=0,A=I,N===0?(M=138,O=3):I===N?(M=6,O=3):(M=7,O=4))}function send_tree(r,g,l){var E,A=-1,I,N=g[0*2+1],y=0,M=7,O=4;for(N===0&&(M=138,O=3),E=0;E<=l;E++)if(I=N,N=g[(E+1)*2+1],!(++y<M&&I===N)){if(y<O)do send_code(r,I,r.bl_tree);while(--y!==0);else I!==0?(I!==A&&(send_code(r,I,r.bl_tree),y--),send_code(r,REP_3_6,r.bl_tree),send_bits(r,y-3,2)):y<=10?(send_code(r,REPZ_3_10,r.bl_tree),send_bits(r,y-3,3)):(send_code(r,REPZ_11_138,r.bl_tree),send_bits(r,y-11,7));y=0,A=I,N===0?(M=138,O=3):I===N?(M=6,O=3):(M=7,O=4)}}function build_bl_tree(r){var g;for(scan_tree(r,r.dyn_ltree,r.l_desc.max_code),scan_tree(r,r.dyn_dtree,r.d_desc.max_code),build_tree(r,r.bl_desc),g=BL_CODES$1-1;g>=3&&r.bl_tree[bl_order[g]*2+1]===0;g--);return r.opt_len+=3*(g+1)+5+5+4,g}function send_all_trees(r,g,l,E){var A;for(send_bits(r,g-257,5),send_bits(r,l-1,5),send_bits(r,E-4,4),A=0;A<E;A++)send_bits(r,r.bl_tree[bl_order[A]*2+1],3);send_tree(r,r.dyn_ltree,g-1),send_tree(r,r.dyn_dtree,l-1)}function detect_data_type(r){var g=4093624447,l;for(l=0;l<=31;l++,g>>>=1)if(g&1&&r.dyn_ltree[l*2]!==0)return Z_BINARY;if(r.dyn_ltree[9*2]!==0||r.dyn_ltree[10*2]!==0||r.dyn_ltree[13*2]!==0)return Z_TEXT;for(l=32;l<LITERALS$1;l++)if(r.dyn_ltree[l*2]!==0)return Z_TEXT;return Z_BINARY}var static_init_done=!1;function _tr_init(r){static_init_done||(tr_static_init(),static_init_done=!0),r.l_desc=new TreeDesc(r.dyn_ltree,static_l_desc),r.d_desc=new TreeDesc(r.dyn_dtree,static_d_desc),r.bl_desc=new TreeDesc(r.bl_tree,static_bl_desc),r.bi_buf=0,r.bi_valid=0,init_block(r)}function _tr_stored_block(r,g,l,E){send_bits(r,(STORED_BLOCK<<1)+(E?1:0),3),copy_block(r,g,l,!0)}function _tr_align(r){send_bits(r,STATIC_TREES<<1,3),send_code(r,END_BLOCK,static_ltree),bi_flush(r)}function _tr_flush_block(r,g,l,E){var A,I,N=0;r.level>0?(r.strm.data_type===Z_UNKNOWN$1&&(r.strm.data_type=detect_data_type(r)),build_tree(r,r.l_desc),build_tree(r,r.d_desc),N=build_bl_tree(r),A=r.opt_len+3+7>>>3,I=r.static_len+3+7>>>3,I<=A&&(A=I)):A=I=l+5,l+4<=A&&g!==-1?_tr_stored_block(r,g,l,E):r.strategy===Z_FIXED$1||I===A?(send_bits(r,(STATIC_TREES<<1)+(E?1:0),3),compress_block(r,static_ltree,static_dtree)):(send_bits(r,(DYN_TREES<<1)+(E?1:0),3),send_all_trees(r,r.l_desc.max_code+1,r.d_desc.max_code+1,N+1),compress_block(r,r.dyn_ltree,r.dyn_dtree)),init_block(r),E&&bi_windup(r)}function _tr_tally(r,g,l){return r.pending_buf[r.d_buf+r.last_lit*2]=g>>>8&255,r.pending_buf[r.d_buf+r.last_lit*2+1]=g&255,r.pending_buf[r.l_buf+r.last_lit]=l&255,r.last_lit++,g===0?r.dyn_ltree[l*2]++:(r.matches++,g--,r.dyn_ltree[(_length_code[l]+LITERALS$1+1)*2]++,r.dyn_dtree[d_code(g)*2]++),r.last_lit===r.lit_bufsize-1}trees$1._tr_init=_tr_init,trees$1._tr_stored_block=_tr_stored_block,trees$1._tr_flush_block=_tr_flush_block,trees$1._tr_tally=_tr_tally,trees$1._tr_align=_tr_align;function adler32$2(r,g,l,E){for(var A=r&65535|0,I=r>>>16&65535|0,N=0;l!==0;){N=l>2e3?2e3:l,l-=N;do A=A+g[E++]|0,I=I+A|0;while(--N);A%=65521,I%=65521}return A|I<<16|0}var adler32_1=adler32$2;function makeTable(){for(var r,g=[],l=0;l<256;l++){r=l;for(var E=0;E<8;E++)r=r&1?3988292384^r>>>1:r>>>1;g[l]=r}return g}var crcTable=makeTable();function crc32$3(r,g,l,E){var A=crcTable,I=E+l;r^=-1;for(var N=E;N<I;N++)r=r>>>8^A[(r^g[N])&255];return r^-1}var crc32_1=crc32$3,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},utils$i=common,trees=trees$1,adler32$1=adler32_1,crc32$2=crc32_1,msg$2=messages,Z_NO_FLUSH$1=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH$2=4,Z_BLOCK$1=5,Z_OK$2=0,Z_STREAM_END$2=1,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_BUF_ERROR$1=-5,Z_DEFAULT_COMPRESSION$1=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY$1=0,Z_UNKNOWN=2,Z_DEFLATED$2=8,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;function err(r,g){return r.msg=msg$2[g],g}function rank(r){return(r<<1)-(r>4?9:0)}function zero(r){for(var g=r.length;--g>=0;)r[g]=0}function flush_pending(r){var g=r.state,l=g.pending;l>r.avail_out&&(l=r.avail_out),l!==0&&(utils$i.arraySet(r.output,g.pending_buf,g.pending_out,l,r.next_out),r.next_out+=l,g.pending_out+=l,r.total_out+=l,r.avail_out-=l,g.pending-=l,g.pending===0&&(g.pending_out=0))}function flush_block_only(r,g){trees._tr_flush_block(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,g),r.block_start=r.strstart,flush_pending(r.strm)}function put_byte(r,g){r.pending_buf[r.pending++]=g}function putShortMSB(r,g){r.pending_buf[r.pending++]=g>>>8&255,r.pending_buf[r.pending++]=g&255}function read_buf(r,g,l,E){var A=r.avail_in;return A>E&&(A=E),A===0?0:(r.avail_in-=A,utils$i.arraySet(g,r.input,r.next_in,A,l),r.state.wrap===1?r.adler=adler32$1(r.adler,g,A,l):r.state.wrap===2&&(r.adler=crc32$2(r.adler,g,A,l)),r.next_in+=A,r.total_in+=A,A)}function longest_match(r,g){var l=r.max_chain_length,E=r.strstart,A,I,N=r.prev_length,y=r.nice_match,M=r.strstart>r.w_size-MIN_LOOKAHEAD?r.strstart-(r.w_size-MIN_LOOKAHEAD):0,O=r.window,Z=r.w_mask,xe=r.prev,V=r.strstart+MAX_MATCH,ce=O[E+N-1],me=O[E+N];r.prev_length>=r.good_match&&(l>>=2),y>r.lookahead&&(y=r.lookahead);do if(A=g,!(O[A+N]!==me||O[A+N-1]!==ce||O[A]!==O[E]||O[++A]!==O[E+1])){E+=2,A++;do;while(O[++E]===O[++A]&&O[++E]===O[++A]&&O[++E]===O[++A]&&O[++E]===O[++A]&&O[++E]===O[++A]&&O[++E]===O[++A]&&O[++E]===O[++A]&&O[++E]===O[++A]&&E<V);if(I=MAX_MATCH-(V-E),E=V-MAX_MATCH,I>N){if(r.match_start=g,N=I,I>=y)break;ce=O[E+N-1],me=O[E+N]}}while((g=xe[g&Z])>M&&--l!==0);return N<=r.lookahead?N:r.lookahead}function fill_window(r){var g=r.w_size,l,E,A,I,N;do{if(I=r.window_size-r.lookahead-r.strstart,r.strstart>=g+(g-MIN_LOOKAHEAD)){utils$i.arraySet(r.window,r.window,g,g,0),r.match_start-=g,r.strstart-=g,r.block_start-=g,E=r.hash_size,l=E;do A=r.head[--l],r.head[l]=A>=g?A-g:0;while(--E);E=g,l=E;do A=r.prev[--l],r.prev[l]=A>=g?A-g:0;while(--E);I+=g}if(r.strm.avail_in===0)break;if(E=read_buf(r.strm,r.window,r.strstart+r.lookahead,I),r.lookahead+=E,r.lookahead+r.insert>=MIN_MATCH)for(N=r.strstart-r.insert,r.ins_h=r.window[N],r.ins_h=(r.ins_h<<r.hash_shift^r.window[N+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[N+MIN_MATCH-1])&r.hash_mask,r.prev[N&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=N,N++,r.insert--,!(r.lookahead+r.insert<MIN_MATCH)););}while(r.lookahead<MIN_LOOKAHEAD&&r.strm.avail_in!==0)}function deflate_stored(r,g){var l=65535;for(l>r.pending_buf_size-5&&(l=r.pending_buf_size-5);;){if(r.lookahead<=1){if(fill_window(r),r.lookahead===0&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;var E=r.block_start+l;if((r.strstart===0||r.strstart>=E)&&(r.lookahead=r.strstart-E,r.strstart=E,flush_block_only(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-MIN_LOOKAHEAD&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=0,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):(r.strstart>r.block_start&&(flush_block_only(r,!1),r.strm.avail_out===0),BS_NEED_MORE)}function deflate_fast(r,g){for(var l,E;;){if(r.lookahead<MIN_LOOKAHEAD){if(fill_window(r),r.lookahead<MIN_LOOKAHEAD&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}if(l=0,r.lookahead>=MIN_MATCH&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),l!==0&&r.strstart-l<=r.w_size-MIN_LOOKAHEAD&&(r.match_length=longest_match(r,l)),r.match_length>=MIN_MATCH)if(E=trees._tr_tally(r,r.strstart-r.match_start,r.match_length-MIN_MATCH),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=MIN_MATCH){r.match_length--;do r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!==0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else E=trees._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(E&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=r.strstart<MIN_MATCH-1?r.strstart:MIN_MATCH-1,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(r,g){for(var l,E,A;;){if(r.lookahead<MIN_LOOKAHEAD){if(fill_window(r),r.lookahead<MIN_LOOKAHEAD&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}if(l=0,r.lookahead>=MIN_MATCH&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=MIN_MATCH-1,l!==0&&r.prev_length<r.max_lazy_match&&r.strstart-l<=r.w_size-MIN_LOOKAHEAD&&(r.match_length=longest_match(r,l),r.match_length<=5&&(r.strategy===Z_FILTERED||r.match_length===MIN_MATCH&&r.strstart-r.match_start>4096)&&(r.match_length=MIN_MATCH-1)),r.prev_length>=MIN_MATCH&&r.match_length<=r.prev_length){A=r.strstart+r.lookahead-MIN_MATCH,E=trees._tr_tally(r,r.strstart-1-r.prev_match,r.prev_length-MIN_MATCH),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=A&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!==0);if(r.match_available=0,r.match_length=MIN_MATCH-1,r.strstart++,E&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}else if(r.match_available){if(E=trees._tr_tally(r,0,r.window[r.strstart-1]),E&&flush_block_only(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return BS_NEED_MORE}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(E=trees._tr_tally(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<MIN_MATCH-1?r.strstart:MIN_MATCH-1,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(r,g){for(var l,E,A,I,N=r.window;;){if(r.lookahead<=MAX_MATCH){if(fill_window(r),r.lookahead<=MAX_MATCH&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=MIN_MATCH&&r.strstart>0&&(A=r.strstart-1,E=N[A],E===N[++A]&&E===N[++A]&&E===N[++A])){I=r.strstart+MAX_MATCH;do;while(E===N[++A]&&E===N[++A]&&E===N[++A]&&E===N[++A]&&E===N[++A]&&E===N[++A]&&E===N[++A]&&E===N[++A]&&A<I);r.match_length=MAX_MATCH-(I-A),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=MIN_MATCH?(l=trees._tr_tally(r,1,r.match_length-MIN_MATCH),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(l=trees._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),l&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=0,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(r,g){for(var l;;){if(r.lookahead===0&&(fill_window(r),r.lookahead===0)){if(g===Z_NO_FLUSH$1)return BS_NEED_MORE;break}if(r.match_length=0,l=trees._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,l&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=0,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(r,g,l,E,A){this.good_length=r,this.max_lazy=g,this.nice_length=l,this.max_chain=E,this.func=A}var configuration_table;configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(r){r.window_size=2*r.w_size,zero(r.head),r.max_lazy_match=configuration_table[r.level].max_lazy,r.good_match=configuration_table[r.level].good_length,r.nice_match=configuration_table[r.level].nice_length,r.max_chain_length=configuration_table[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=MIN_MATCH-1,r.match_available=0,r.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils$i.Buf16(HEAP_SIZE*2),this.dyn_dtree=new utils$i.Buf16((2*D_CODES+1)*2),this.bl_tree=new utils$i.Buf16((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils$i.Buf16(MAX_BITS+1),this.heap=new utils$i.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils$i.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(r){var g;return!r||!r.state?err(r,Z_STREAM_ERROR$1):(r.total_in=r.total_out=0,r.data_type=Z_UNKNOWN,g=r.state,g.pending=0,g.pending_out=0,g.wrap<0&&(g.wrap=-g.wrap),g.status=g.wrap?INIT_STATE:BUSY_STATE,r.adler=g.wrap===2?0:1,g.last_flush=Z_NO_FLUSH$1,trees._tr_init(g),Z_OK$2)}function deflateReset(r){var g=deflateResetKeep(r);return g===Z_OK$2&&lm_init(r.state),g}function deflateSetHeader(r,g){return!r||!r.state||r.state.wrap!==2?Z_STREAM_ERROR$1:(r.state.gzhead=g,Z_OK$2)}function deflateInit2(r,g,l,E,A,I){if(!r)return Z_STREAM_ERROR$1;var N=1;if(g===Z_DEFAULT_COMPRESSION$1&&(g=6),E<0?(N=0,E=-E):E>15&&(N=2,E-=16),A<1||A>MAX_MEM_LEVEL||l!==Z_DEFLATED$2||E<8||E>15||g<0||g>9||I<0||I>Z_FIXED)return err(r,Z_STREAM_ERROR$1);E===8&&(E=9);var y=new DeflateState;return r.state=y,y.strm=r,y.wrap=N,y.gzhead=null,y.w_bits=E,y.w_size=1<<y.w_bits,y.w_mask=y.w_size-1,y.hash_bits=A+7,y.hash_size=1<<y.hash_bits,y.hash_mask=y.hash_size-1,y.hash_shift=~~((y.hash_bits+MIN_MATCH-1)/MIN_MATCH),y.window=new utils$i.Buf8(y.w_size*2),y.head=new utils$i.Buf16(y.hash_size),y.prev=new utils$i.Buf16(y.w_size),y.lit_bufsize=1<<A+6,y.pending_buf_size=y.lit_bufsize*4,y.pending_buf=new utils$i.Buf8(y.pending_buf_size),y.d_buf=1*y.lit_bufsize,y.l_buf=3*y.lit_bufsize,y.level=g,y.strategy=I,y.method=l,deflateReset(r)}function deflateInit(r,g){return deflateInit2(r,g,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1)}function deflate$2(r,g){var l,E,A,I;if(!r||!r.state||g>Z_BLOCK$1||g<0)return r?err(r,Z_STREAM_ERROR$1):Z_STREAM_ERROR$1;if(E=r.state,!r.output||!r.input&&r.avail_in!==0||E.status===FINISH_STATE&&g!==Z_FINISH$2)return err(r,r.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$1);if(E.strm=r,l=E.last_flush,E.last_flush=g,E.status===INIT_STATE)if(E.wrap===2)r.adler=0,put_byte(E,31),put_byte(E,139),put_byte(E,8),E.gzhead?(put_byte(E,(E.gzhead.text?1:0)+(E.gzhead.hcrc?2:0)+(E.gzhead.extra?4:0)+(E.gzhead.name?8:0)+(E.gzhead.comment?16:0)),put_byte(E,E.gzhead.time&255),put_byte(E,E.gzhead.time>>8&255),put_byte(E,E.gzhead.time>>16&255),put_byte(E,E.gzhead.time>>24&255),put_byte(E,E.level===9?2:E.strategy>=Z_HUFFMAN_ONLY||E.level<2?4:0),put_byte(E,E.gzhead.os&255),E.gzhead.extra&&E.gzhead.extra.length&&(put_byte(E,E.gzhead.extra.length&255),put_byte(E,E.gzhead.extra.length>>8&255)),E.gzhead.hcrc&&(r.adler=crc32$2(r.adler,E.pending_buf,E.pending,0)),E.gzindex=0,E.status=EXTRA_STATE):(put_byte(E,0),put_byte(E,0),put_byte(E,0),put_byte(E,0),put_byte(E,0),put_byte(E,E.level===9?2:E.strategy>=Z_HUFFMAN_ONLY||E.level<2?4:0),put_byte(E,OS_CODE),E.status=BUSY_STATE);else{var N=Z_DEFLATED$2+(E.w_bits-8<<4)<<8,y=-1;E.strategy>=Z_HUFFMAN_ONLY||E.level<2?y=0:E.level<6?y=1:E.level===6?y=2:y=3,N|=y<<6,E.strstart!==0&&(N|=PRESET_DICT),N+=31-N%31,E.status=BUSY_STATE,putShortMSB(E,N),E.strstart!==0&&(putShortMSB(E,r.adler>>>16),putShortMSB(E,r.adler&65535)),r.adler=1}if(E.status===EXTRA_STATE)if(E.gzhead.extra){for(A=E.pending;E.gzindex<(E.gzhead.extra.length&65535)&&!(E.pending===E.pending_buf_size&&(E.gzhead.hcrc&&E.pending>A&&(r.adler=crc32$2(r.adler,E.pending_buf,E.pending-A,A)),flush_pending(r),A=E.pending,E.pending===E.pending_buf_size));)put_byte(E,E.gzhead.extra[E.gzindex]&255),E.gzindex++;E.gzhead.hcrc&&E.pending>A&&(r.adler=crc32$2(r.adler,E.pending_buf,E.pending-A,A)),E.gzindex===E.gzhead.extra.length&&(E.gzindex=0,E.status=NAME_STATE)}else E.status=NAME_STATE;if(E.status===NAME_STATE)if(E.gzhead.name){A=E.pending;do{if(E.pending===E.pending_buf_size&&(E.gzhead.hcrc&&E.pending>A&&(r.adler=crc32$2(r.adler,E.pending_buf,E.pending-A,A)),flush_pending(r),A=E.pending,E.pending===E.pending_buf_size)){I=1;break}E.gzindex<E.gzhead.name.length?I=E.gzhead.name.charCodeAt(E.gzindex++)&255:I=0,put_byte(E,I)}while(I!==0);E.gzhead.hcrc&&E.pending>A&&(r.adler=crc32$2(r.adler,E.pending_buf,E.pending-A,A)),I===0&&(E.gzindex=0,E.status=COMMENT_STATE)}else E.status=COMMENT_STATE;if(E.status===COMMENT_STATE)if(E.gzhead.comment){A=E.pending;do{if(E.pending===E.pending_buf_size&&(E.gzhead.hcrc&&E.pending>A&&(r.adler=crc32$2(r.adler,E.pending_buf,E.pending-A,A)),flush_pending(r),A=E.pending,E.pending===E.pending_buf_size)){I=1;break}E.gzindex<E.gzhead.comment.length?I=E.gzhead.comment.charCodeAt(E.gzindex++)&255:I=0,put_byte(E,I)}while(I!==0);E.gzhead.hcrc&&E.pending>A&&(r.adler=crc32$2(r.adler,E.pending_buf,E.pending-A,A)),I===0&&(E.status=HCRC_STATE)}else E.status=HCRC_STATE;if(E.status===HCRC_STATE&&(E.gzhead.hcrc?(E.pending+2>E.pending_buf_size&&flush_pending(r),E.pending+2<=E.pending_buf_size&&(put_byte(E,r.adler&255),put_byte(E,r.adler>>8&255),r.adler=0,E.status=BUSY_STATE)):E.status=BUSY_STATE),E.pending!==0){if(flush_pending(r),r.avail_out===0)return E.last_flush=-1,Z_OK$2}else if(r.avail_in===0&&rank(g)<=rank(l)&&g!==Z_FINISH$2)return err(r,Z_BUF_ERROR$1);if(E.status===FINISH_STATE&&r.avail_in!==0)return err(r,Z_BUF_ERROR$1);if(r.avail_in!==0||E.lookahead!==0||g!==Z_NO_FLUSH$1&&E.status!==FINISH_STATE){var M=E.strategy===Z_HUFFMAN_ONLY?deflate_huff(E,g):E.strategy===Z_RLE?deflate_rle(E,g):configuration_table[E.level].func(E,g);if((M===BS_FINISH_STARTED||M===BS_FINISH_DONE)&&(E.status=FINISH_STATE),M===BS_NEED_MORE||M===BS_FINISH_STARTED)return r.avail_out===0&&(E.last_flush=-1),Z_OK$2;if(M===BS_BLOCK_DONE&&(g===Z_PARTIAL_FLUSH?trees._tr_align(E):g!==Z_BLOCK$1&&(trees._tr_stored_block(E,0,0,!1),g===Z_FULL_FLUSH&&(zero(E.head),E.lookahead===0&&(E.strstart=0,E.block_start=0,E.insert=0))),flush_pending(r),r.avail_out===0))return E.last_flush=-1,Z_OK$2}return g!==Z_FINISH$2?Z_OK$2:E.wrap<=0?Z_STREAM_END$2:(E.wrap===2?(put_byte(E,r.adler&255),put_byte(E,r.adler>>8&255),put_byte(E,r.adler>>16&255),put_byte(E,r.adler>>24&255),put_byte(E,r.total_in&255),put_byte(E,r.total_in>>8&255),put_byte(E,r.total_in>>16&255),put_byte(E,r.total_in>>24&255)):(putShortMSB(E,r.adler>>>16),putShortMSB(E,r.adler&65535)),flush_pending(r),E.wrap>0&&(E.wrap=-E.wrap),E.pending!==0?Z_OK$2:Z_STREAM_END$2)}function deflateEnd(r){var g;return!r||!r.state?Z_STREAM_ERROR$1:(g=r.state.status,g!==INIT_STATE&&g!==EXTRA_STATE&&g!==NAME_STATE&&g!==COMMENT_STATE&&g!==HCRC_STATE&&g!==BUSY_STATE&&g!==FINISH_STATE?err(r,Z_STREAM_ERROR$1):(r.state=null,g===BUSY_STATE?err(r,Z_DATA_ERROR$1):Z_OK$2))}function deflateSetDictionary(r,g){var l=g.length,E,A,I,N,y,M,O,Z;if(!r||!r.state||(E=r.state,N=E.wrap,N===2||N===1&&E.status!==INIT_STATE||E.lookahead))return Z_STREAM_ERROR$1;for(N===1&&(r.adler=adler32$1(r.adler,g,l,0)),E.wrap=0,l>=E.w_size&&(N===0&&(zero(E.head),E.strstart=0,E.block_start=0,E.insert=0),Z=new utils$i.Buf8(E.w_size),utils$i.arraySet(Z,g,l-E.w_size,E.w_size,0),g=Z,l=E.w_size),y=r.avail_in,M=r.next_in,O=r.input,r.avail_in=l,r.next_in=0,r.input=g,fill_window(E);E.lookahead>=MIN_MATCH;){A=E.strstart,I=E.lookahead-(MIN_MATCH-1);do E.ins_h=(E.ins_h<<E.hash_shift^E.window[A+MIN_MATCH-1])&E.hash_mask,E.prev[A&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=A,A++;while(--I);E.strstart=A,E.lookahead=MIN_MATCH-1,fill_window(E)}return E.strstart+=E.lookahead,E.block_start=E.strstart,E.insert=E.lookahead,E.lookahead=0,E.match_length=E.prev_length=MIN_MATCH-1,E.match_available=0,r.next_in=M,r.input=O,r.avail_in=y,E.wrap=N,Z_OK$2}deflate$3.deflateInit=deflateInit,deflate$3.deflateInit2=deflateInit2,deflate$3.deflateReset=deflateReset,deflate$3.deflateResetKeep=deflateResetKeep,deflate$3.deflateSetHeader=deflateSetHeader,deflate$3.deflate=deflate$2,deflate$3.deflateEnd=deflateEnd,deflate$3.deflateSetDictionary=deflateSetDictionary,deflate$3.deflateInfo="pako deflate (from Nodeca project)";var strings$2={},utils$h=common,STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(r){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(r){STR_APPLY_UIA_OK=!1}for(var _utf8len=new utils$h.Buf8(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1,strings$2.string2buf=function(r){var g,l,E,A,I,N=r.length,y=0;for(A=0;A<N;A++)l=r.charCodeAt(A),(l&64512)===55296&&A+1<N&&(E=r.charCodeAt(A+1),(E&64512)===56320&&(l=65536+(l-55296<<10)+(E-56320),A++)),y+=l<128?1:l<2048?2:l<65536?3:4;for(g=new utils$h.Buf8(y),I=0,A=0;I<y;A++)l=r.charCodeAt(A),(l&64512)===55296&&A+1<N&&(E=r.charCodeAt(A+1),(E&64512)===56320&&(l=65536+(l-55296<<10)+(E-56320),A++)),l<128?g[I++]=l:l<2048?(g[I++]=192|l>>>6,g[I++]=128|l&63):l<65536?(g[I++]=224|l>>>12,g[I++]=128|l>>>6&63,g[I++]=128|l&63):(g[I++]=240|l>>>18,g[I++]=128|l>>>12&63,g[I++]=128|l>>>6&63,g[I++]=128|l&63);return g};function buf2binstring(r,g){if(g<65534&&(r.subarray&&STR_APPLY_UIA_OK||!r.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils$h.shrinkBuf(r,g));for(var l="",E=0;E<g;E++)l+=String.fromCharCode(r[E]);return l}strings$2.buf2binstring=function(r){return buf2binstring(r,r.length)},strings$2.binstring2buf=function(r){for(var g=new utils$h.Buf8(r.length),l=0,E=g.length;l<E;l++)g[l]=r.charCodeAt(l);return g},strings$2.buf2string=function(r,g){var l,E,A,I,N=g||r.length,y=new Array(N*2);for(E=0,l=0;l<N;){if(A=r[l++],A<128){y[E++]=A;continue}if(I=_utf8len[A],I>4){y[E++]=65533,l+=I-1;continue}for(A&=I===2?31:I===3?15:7;I>1&&l<N;)A=A<<6|r[l++]&63,I--;if(I>1){y[E++]=65533;continue}A<65536?y[E++]=A:(A-=65536,y[E++]=55296|A>>10&1023,y[E++]=56320|A&1023)}return buf2binstring(y,E)},strings$2.utf8border=function(r,g){var l;for(g=g||r.length,g>r.length&&(g=r.length),l=g-1;l>=0&&(r[l]&192)===128;)l--;return l<0||l===0?g:l+_utf8len[r[l]]>g?l:g};function ZStream$2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream$2,zlib_deflate=deflate$3,utils$g=common,strings$1=strings$2,msg$1=messages,ZStream$1=zstream,toString$1=Object.prototype.toString,Z_NO_FLUSH=0,Z_FINISH$1=4,Z_OK$1=0,Z_STREAM_END$1=1,Z_SYNC_FLUSH=2,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED$1=8;function Deflate(r){if(!(this instanceof Deflate))return new Deflate(r);this.options=utils$g.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},r||{});var g=this.options;g.raw&&g.windowBits>0?g.windowBits=-g.windowBits:g.gzip&&g.windowBits>0&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream$1,this.strm.avail_out=0;var l=zlib_deflate.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(l!==Z_OK$1)throw new Error(msg$1[l]);if(g.header&&zlib_deflate.deflateSetHeader(this.strm,g.header),g.dictionary){var E;if(typeof g.dictionary=="string"?E=strings$1.string2buf(g.dictionary):toString$1.call(g.dictionary)==="[object ArrayBuffer]"?E=new Uint8Array(g.dictionary):E=g.dictionary,l=zlib_deflate.deflateSetDictionary(this.strm,E),l!==Z_OK$1)throw new Error(msg$1[l]);this._dict_set=!0}}Deflate.prototype.push=function(r,g){var l=this.strm,E=this.options.chunkSize,A,I;if(this.ended)return!1;I=g===~~g?g:g===!0?Z_FINISH$1:Z_NO_FLUSH,typeof r=="string"?l.input=strings$1.string2buf(r):toString$1.call(r)==="[object ArrayBuffer]"?l.input=new Uint8Array(r):l.input=r,l.next_in=0,l.avail_in=l.input.length;do{if(l.avail_out===0&&(l.output=new utils$g.Buf8(E),l.next_out=0,l.avail_out=E),A=zlib_deflate.deflate(l,I),A!==Z_STREAM_END$1&&A!==Z_OK$1)return this.onEnd(A),this.ended=!0,!1;(l.avail_out===0||l.avail_in===0&&(I===Z_FINISH$1||I===Z_SYNC_FLUSH))&&(this.options.to==="string"?this.onData(strings$1.buf2binstring(utils$g.shrinkBuf(l.output,l.next_out))):this.onData(utils$g.shrinkBuf(l.output,l.next_out)))}while((l.avail_in>0||l.avail_out===0)&&A!==Z_STREAM_END$1);return I===Z_FINISH$1?(A=zlib_deflate.deflateEnd(this.strm),this.onEnd(A),this.ended=!0,A===Z_OK$1):(I===Z_SYNC_FLUSH&&(this.onEnd(Z_OK$1),l.avail_out=0),!0)},Deflate.prototype.onData=function(r){this.chunks.push(r)},Deflate.prototype.onEnd=function(r){r===Z_OK$1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$g.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function deflate$1(r,g){var l=new Deflate(g);if(l.push(r,!0),l.err)throw l.msg||msg$1[l.err];return l.result}function deflateRaw(r,g){return g=g||{},g.raw=!0,deflate$1(r,g)}function gzip(r,g){return g=g||{},g.gzip=!0,deflate$1(r,g)}deflate$4.Deflate=Deflate,deflate$4.deflate=deflate$1,deflate$4.deflateRaw=deflateRaw,deflate$4.gzip=gzip;var inflate$4={},inflate$3={},BAD$1=30,TYPE$1=12,inffast=function(g,l){var E,A,I,N,y,M,O,Z,xe,V,ce,me,we,ye,be,Te,Ne,Ie,Ae,Re,ke,De,he,Le,Ce;E=g.state,A=g.next_in,Le=g.input,I=A+(g.avail_in-5),N=g.next_out,Ce=g.output,y=N-(l-g.avail_out),M=N+(g.avail_out-257),O=E.dmax,Z=E.wsize,xe=E.whave,V=E.wnext,ce=E.window,me=E.hold,we=E.bits,ye=E.lencode,be=E.distcode,Te=(1<<E.lenbits)-1,Ne=(1<<E.distbits)-1;e:do{we<15&&(me+=Le[A++]<<we,we+=8,me+=Le[A++]<<we,we+=8),Ie=ye[me&Te];t:for(;;){if(Ae=Ie>>>24,me>>>=Ae,we-=Ae,Ae=Ie>>>16&255,Ae===0)Ce[N++]=Ie&65535;else if(Ae&16){Re=Ie&65535,Ae&=15,Ae&&(we<Ae&&(me+=Le[A++]<<we,we+=8),Re+=me&(1<<Ae)-1,me>>>=Ae,we-=Ae),we<15&&(me+=Le[A++]<<we,we+=8,me+=Le[A++]<<we,we+=8),Ie=be[me&Ne];r:for(;;){if(Ae=Ie>>>24,me>>>=Ae,we-=Ae,Ae=Ie>>>16&255,Ae&16){if(ke=Ie&65535,Ae&=15,we<Ae&&(me+=Le[A++]<<we,we+=8,we<Ae&&(me+=Le[A++]<<we,we+=8)),ke+=me&(1<<Ae)-1,ke>O){g.msg="invalid distance too far back",E.mode=BAD$1;break e}if(me>>>=Ae,we-=Ae,Ae=N-y,ke>Ae){if(Ae=ke-Ae,Ae>xe&&E.sane){g.msg="invalid distance too far back",E.mode=BAD$1;break e}if(De=0,he=ce,V===0){if(De+=Z-Ae,Ae<Re){Re-=Ae;do Ce[N++]=ce[De++];while(--Ae);De=N-ke,he=Ce}}else if(V<Ae){if(De+=Z+V-Ae,Ae-=V,Ae<Re){Re-=Ae;do Ce[N++]=ce[De++];while(--Ae);if(De=0,V<Re){Ae=V,Re-=Ae;do Ce[N++]=ce[De++];while(--Ae);De=N-ke,he=Ce}}}else if(De+=V-Ae,Ae<Re){Re-=Ae;do Ce[N++]=ce[De++];while(--Ae);De=N-ke,he=Ce}for(;Re>2;)Ce[N++]=he[De++],Ce[N++]=he[De++],Ce[N++]=he[De++],Re-=3;Re&&(Ce[N++]=he[De++],Re>1&&(Ce[N++]=he[De++]))}else{De=N-ke;do Ce[N++]=Ce[De++],Ce[N++]=Ce[De++],Ce[N++]=Ce[De++],Re-=3;while(Re>2);Re&&(Ce[N++]=Ce[De++],Re>1&&(Ce[N++]=Ce[De++]))}}else if((Ae&64)===0){Ie=be[(Ie&65535)+(me&(1<<Ae)-1)];continue r}else{g.msg="invalid distance code",E.mode=BAD$1;break e}break}}else if((Ae&64)===0){Ie=ye[(Ie&65535)+(me&(1<<Ae)-1)];continue t}else if(Ae&32){E.mode=TYPE$1;break e}else{g.msg="invalid literal/length code",E.mode=BAD$1;break e}break}}while(A<I&&N<M);Re=we>>3,A-=Re,we-=Re<<3,me&=(1<<we)-1,g.next_in=A,g.next_out=N,g.avail_in=A<I?5+(I-A):5-(A-I),g.avail_out=N<M?257+(M-N):257-(N-M),E.hold=me,E.bits=we},utils$f=common,MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],inftrees=function(g,l,E,A,I,N,y,M){var O=M.bits,Z=0,xe=0,V=0,ce=0,me=0,we=0,ye=0,be=0,Te=0,Ne=0,Ie,Ae,Re,ke,De,he=null,Le=0,Ce,Oe=new utils$f.Buf16(MAXBITS+1),Xe=new utils$f.Buf16(MAXBITS+1),Ke=null,Je=0,Qe,Be,tt;for(Z=0;Z<=MAXBITS;Z++)Oe[Z]=0;for(xe=0;xe<A;xe++)Oe[l[E+xe]]++;for(me=O,ce=MAXBITS;ce>=1&&Oe[ce]===0;ce--);if(me>ce&&(me=ce),ce===0)return I[N++]=1<<24|64<<16|0,I[N++]=1<<24|64<<16|0,M.bits=1,0;for(V=1;V<ce&&Oe[V]===0;V++);for(me<V&&(me=V),be=1,Z=1;Z<=MAXBITS;Z++)if(be<<=1,be-=Oe[Z],be<0)return-1;if(be>0&&(g===CODES$1||ce!==1))return-1;for(Xe[1]=0,Z=1;Z<MAXBITS;Z++)Xe[Z+1]=Xe[Z]+Oe[Z];for(xe=0;xe<A;xe++)l[E+xe]!==0&&(y[Xe[l[E+xe]]++]=xe);if(g===CODES$1?(he=Ke=y,Ce=19):g===LENS$1?(he=lbase,Le-=257,Ke=lext,Je-=257,Ce=256):(he=dbase,Ke=dext,Ce=-1),Ne=0,xe=0,Z=V,De=N,we=me,ye=0,Re=-1,Te=1<<me,ke=Te-1,g===LENS$1&&Te>ENOUGH_LENS$1||g===DISTS$1&&Te>ENOUGH_DISTS$1)return 1;for(;;){Qe=Z-ye,y[xe]<Ce?(Be=0,tt=y[xe]):y[xe]>Ce?(Be=Ke[Je+y[xe]],tt=he[Le+y[xe]]):(Be=96,tt=0),Ie=1<<Z-ye,Ae=1<<we,V=Ae;do Ae-=Ie,I[De+(Ne>>ye)+Ae]=Qe<<24|Be<<16|tt|0;while(Ae!==0);for(Ie=1<<Z-1;Ne&Ie;)Ie>>=1;if(Ie!==0?(Ne&=Ie-1,Ne+=Ie):Ne=0,xe++,--Oe[Z]===0){if(Z===ce)break;Z=l[E+y[xe]]}if(Z>me&&(Ne&ke)!==Re){for(ye===0&&(ye=me),De+=V,we=Z-ye,be=1<<we;we+ye<ce&&(be-=Oe[we+ye],!(be<=0));)we++,be<<=1;if(Te+=1<<we,g===LENS$1&&Te>ENOUGH_LENS$1||g===DISTS$1&&Te>ENOUGH_DISTS$1)return 1;Re=Ne&ke,I[Re]=me<<24|we<<16|De-N|0}}return Ne!==0&&(I[De+Ne]=Z-ye<<24|64<<16|0),M.bits=me,0},utils$e=common,adler32=adler32_1,crc32$1=crc32_1,inflate_fast=inffast,inflate_table=inftrees,CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS;function zswap32(r){return(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils$e.Buf16(320),this.work=new utils$e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(r){var g;return!r||!r.state?Z_STREAM_ERROR:(g=r.state,r.total_in=r.total_out=g.total=0,r.msg="",g.wrap&&(r.adler=g.wrap&1),g.mode=HEAD,g.last=0,g.havedict=0,g.dmax=32768,g.head=null,g.hold=0,g.bits=0,g.lencode=g.lendyn=new utils$e.Buf32(ENOUGH_LENS),g.distcode=g.distdyn=new utils$e.Buf32(ENOUGH_DISTS),g.sane=1,g.back=-1,Z_OK)}function inflateReset(r){var g;return!r||!r.state?Z_STREAM_ERROR:(g=r.state,g.wsize=0,g.whave=0,g.wnext=0,inflateResetKeep(r))}function inflateReset2(r,g){var l,E;return!r||!r.state||(E=r.state,g<0?(l=0,g=-g):(l=(g>>4)+1,g<48&&(g&=15)),g&&(g<8||g>15))?Z_STREAM_ERROR:(E.window!==null&&E.wbits!==g&&(E.window=null),E.wrap=l,E.wbits=g,inflateReset(r))}function inflateInit2(r,g){var l,E;return r?(E=new InflateState,r.state=E,E.window=null,l=inflateReset2(r,g),l!==Z_OK&&(r.state=null),l):Z_STREAM_ERROR}function inflateInit(r){return inflateInit2(r,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(r){if(virgin){var g;for(lenfix=new utils$e.Buf32(512),distfix=new utils$e.Buf32(32),g=0;g<144;)r.lens[g++]=8;for(;g<256;)r.lens[g++]=9;for(;g<280;)r.lens[g++]=7;for(;g<288;)r.lens[g++]=8;for(inflate_table(LENS,r.lens,0,288,lenfix,0,r.work,{bits:9}),g=0;g<32;)r.lens[g++]=5;inflate_table(DISTS,r.lens,0,32,distfix,0,r.work,{bits:5}),virgin=!1}r.lencode=lenfix,r.lenbits=9,r.distcode=distfix,r.distbits=5}function updatewindow(r,g,l,E){var A,I=r.state;return I.window===null&&(I.wsize=1<<I.wbits,I.wnext=0,I.whave=0,I.window=new utils$e.Buf8(I.wsize)),E>=I.wsize?(utils$e.arraySet(I.window,g,l-I.wsize,I.wsize,0),I.wnext=0,I.whave=I.wsize):(A=I.wsize-I.wnext,A>E&&(A=E),utils$e.arraySet(I.window,g,l-E,A,I.wnext),E-=A,E?(utils$e.arraySet(I.window,g,l-E,E,0),I.wnext=E,I.whave=I.wsize):(I.wnext+=A,I.wnext===I.wsize&&(I.wnext=0),I.whave<I.wsize&&(I.whave+=A))),0}function inflate$2(r,g){var l,E,A,I,N,y,M,O,Z,xe,V,ce,me,we,ye=0,be,Te,Ne,Ie,Ae,Re,ke,De,he=new utils$e.Buf8(4),Le,Ce,Oe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!r||!r.state||!r.output||!r.input&&r.avail_in!==0)return Z_STREAM_ERROR;l=r.state,l.mode===TYPE&&(l.mode=TYPEDO),N=r.next_out,A=r.output,M=r.avail_out,I=r.next_in,E=r.input,y=r.avail_in,O=l.hold,Z=l.bits,xe=y,V=M,De=Z_OK;e:for(;;)switch(l.mode){case HEAD:if(l.wrap===0){l.mode=TYPEDO;break}for(;Z<16;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}if(l.wrap&2&&O===35615){l.check=0,he[0]=O&255,he[1]=O>>>8&255,l.check=crc32$1(l.check,he,2,0),O=0,Z=0,l.mode=FLAGS;break}if(l.flags=0,l.head&&(l.head.done=!1),!(l.wrap&1)||(((O&255)<<8)+(O>>8))%31){r.msg="incorrect header check",l.mode=BAD;break}if((O&15)!==Z_DEFLATED){r.msg="unknown compression method",l.mode=BAD;break}if(O>>>=4,Z-=4,ke=(O&15)+8,l.wbits===0)l.wbits=ke;else if(ke>l.wbits){r.msg="invalid window size",l.mode=BAD;break}l.dmax=1<<ke,r.adler=l.check=1,l.mode=O&512?DICTID:TYPE,O=0,Z=0;break;case FLAGS:for(;Z<16;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}if(l.flags=O,(l.flags&255)!==Z_DEFLATED){r.msg="unknown compression method",l.mode=BAD;break}if(l.flags&57344){r.msg="unknown header flags set",l.mode=BAD;break}l.head&&(l.head.text=O>>8&1),l.flags&512&&(he[0]=O&255,he[1]=O>>>8&255,l.check=crc32$1(l.check,he,2,0)),O=0,Z=0,l.mode=TIME;case TIME:for(;Z<32;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}l.head&&(l.head.time=O),l.flags&512&&(he[0]=O&255,he[1]=O>>>8&255,he[2]=O>>>16&255,he[3]=O>>>24&255,l.check=crc32$1(l.check,he,4,0)),O=0,Z=0,l.mode=OS;case OS:for(;Z<16;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}l.head&&(l.head.xflags=O&255,l.head.os=O>>8),l.flags&512&&(he[0]=O&255,he[1]=O>>>8&255,l.check=crc32$1(l.check,he,2,0)),O=0,Z=0,l.mode=EXLEN;case EXLEN:if(l.flags&1024){for(;Z<16;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}l.length=O,l.head&&(l.head.extra_len=O),l.flags&512&&(he[0]=O&255,he[1]=O>>>8&255,l.check=crc32$1(l.check,he,2,0)),O=0,Z=0}else l.head&&(l.head.extra=null);l.mode=EXTRA;case EXTRA:if(l.flags&1024&&(ce=l.length,ce>y&&(ce=y),ce&&(l.head&&(ke=l.head.extra_len-l.length,l.head.extra||(l.head.extra=new Array(l.head.extra_len)),utils$e.arraySet(l.head.extra,E,I,ce,ke)),l.flags&512&&(l.check=crc32$1(l.check,E,ce,I)),y-=ce,I+=ce,l.length-=ce),l.length))break e;l.length=0,l.mode=NAME;case NAME:if(l.flags&2048){if(y===0)break e;ce=0;do ke=E[I+ce++],l.head&&ke&&l.length<65536&&(l.head.name+=String.fromCharCode(ke));while(ke&&ce<y);if(l.flags&512&&(l.check=crc32$1(l.check,E,ce,I)),y-=ce,I+=ce,ke)break e}else l.head&&(l.head.name=null);l.length=0,l.mode=COMMENT;case COMMENT:if(l.flags&4096){if(y===0)break e;ce=0;do ke=E[I+ce++],l.head&&ke&&l.length<65536&&(l.head.comment+=String.fromCharCode(ke));while(ke&&ce<y);if(l.flags&512&&(l.check=crc32$1(l.check,E,ce,I)),y-=ce,I+=ce,ke)break e}else l.head&&(l.head.comment=null);l.mode=HCRC;case HCRC:if(l.flags&512){for(;Z<16;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}if(O!==(l.check&65535)){r.msg="header crc mismatch",l.mode=BAD;break}O=0,Z=0}l.head&&(l.head.hcrc=l.flags>>9&1,l.head.done=!0),r.adler=l.check=0,l.mode=TYPE;break;case DICTID:for(;Z<32;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}r.adler=l.check=zswap32(O),O=0,Z=0,l.mode=DICT;case DICT:if(l.havedict===0)return r.next_out=N,r.avail_out=M,r.next_in=I,r.avail_in=y,l.hold=O,l.bits=Z,Z_NEED_DICT;r.adler=l.check=1,l.mode=TYPE;case TYPE:if(g===Z_BLOCK||g===Z_TREES)break e;case TYPEDO:if(l.last){O>>>=Z&7,Z-=Z&7,l.mode=CHECK;break}for(;Z<3;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}switch(l.last=O&1,O>>>=1,Z-=1,O&3){case 0:l.mode=STORED;break;case 1:if(fixedtables(l),l.mode=LEN_,g===Z_TREES){O>>>=2,Z-=2;break e}break;case 2:l.mode=TABLE;break;case 3:r.msg="invalid block type",l.mode=BAD}O>>>=2,Z-=2;break;case STORED:for(O>>>=Z&7,Z-=Z&7;Z<32;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}if((O&65535)!==(O>>>16^65535)){r.msg="invalid stored block lengths",l.mode=BAD;break}if(l.length=O&65535,O=0,Z=0,l.mode=COPY_,g===Z_TREES)break e;case COPY_:l.mode=COPY;case COPY:if(ce=l.length,ce){if(ce>y&&(ce=y),ce>M&&(ce=M),ce===0)break e;utils$e.arraySet(A,E,I,ce,N),y-=ce,I+=ce,M-=ce,N+=ce,l.length-=ce;break}l.mode=TYPE;break;case TABLE:for(;Z<14;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}if(l.nlen=(O&31)+257,O>>>=5,Z-=5,l.ndist=(O&31)+1,O>>>=5,Z-=5,l.ncode=(O&15)+4,O>>>=4,Z-=4,l.nlen>286||l.ndist>30){r.msg="too many length or distance symbols",l.mode=BAD;break}l.have=0,l.mode=LENLENS;case LENLENS:for(;l.have<l.ncode;){for(;Z<3;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}l.lens[Oe[l.have++]]=O&7,O>>>=3,Z-=3}for(;l.have<19;)l.lens[Oe[l.have++]]=0;if(l.lencode=l.lendyn,l.lenbits=7,Le={bits:l.lenbits},De=inflate_table(CODES,l.lens,0,19,l.lencode,0,l.work,Le),l.lenbits=Le.bits,De){r.msg="invalid code lengths set",l.mode=BAD;break}l.have=0,l.mode=CODELENS;case CODELENS:for(;l.have<l.nlen+l.ndist;){for(;ye=l.lencode[O&(1<<l.lenbits)-1],be=ye>>>24,Te=ye>>>16&255,Ne=ye&65535,!(be<=Z);){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}if(Ne<16)O>>>=be,Z-=be,l.lens[l.have++]=Ne;else{if(Ne===16){for(Ce=be+2;Z<Ce;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}if(O>>>=be,Z-=be,l.have===0){r.msg="invalid bit length repeat",l.mode=BAD;break}ke=l.lens[l.have-1],ce=3+(O&3),O>>>=2,Z-=2}else if(Ne===17){for(Ce=be+3;Z<Ce;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}O>>>=be,Z-=be,ke=0,ce=3+(O&7),O>>>=3,Z-=3}else{for(Ce=be+7;Z<Ce;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}O>>>=be,Z-=be,ke=0,ce=11+(O&127),O>>>=7,Z-=7}if(l.have+ce>l.nlen+l.ndist){r.msg="invalid bit length repeat",l.mode=BAD;break}for(;ce--;)l.lens[l.have++]=ke}}if(l.mode===BAD)break;if(l.lens[256]===0){r.msg="invalid code -- missing end-of-block",l.mode=BAD;break}if(l.lenbits=9,Le={bits:l.lenbits},De=inflate_table(LENS,l.lens,0,l.nlen,l.lencode,0,l.work,Le),l.lenbits=Le.bits,De){r.msg="invalid literal/lengths set",l.mode=BAD;break}if(l.distbits=6,l.distcode=l.distdyn,Le={bits:l.distbits},De=inflate_table(DISTS,l.lens,l.nlen,l.ndist,l.distcode,0,l.work,Le),l.distbits=Le.bits,De){r.msg="invalid distances set",l.mode=BAD;break}if(l.mode=LEN_,g===Z_TREES)break e;case LEN_:l.mode=LEN;case LEN:if(y>=6&&M>=258){r.next_out=N,r.avail_out=M,r.next_in=I,r.avail_in=y,l.hold=O,l.bits=Z,inflate_fast(r,V),N=r.next_out,A=r.output,M=r.avail_out,I=r.next_in,E=r.input,y=r.avail_in,O=l.hold,Z=l.bits,l.mode===TYPE&&(l.back=-1);break}for(l.back=0;ye=l.lencode[O&(1<<l.lenbits)-1],be=ye>>>24,Te=ye>>>16&255,Ne=ye&65535,!(be<=Z);){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}if(Te&&(Te&240)===0){for(Ie=be,Ae=Te,Re=Ne;ye=l.lencode[Re+((O&(1<<Ie+Ae)-1)>>Ie)],be=ye>>>24,Te=ye>>>16&255,Ne=ye&65535,!(Ie+be<=Z);){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}O>>>=Ie,Z-=Ie,l.back+=Ie}if(O>>>=be,Z-=be,l.back+=be,l.length=Ne,Te===0){l.mode=LIT;break}if(Te&32){l.back=-1,l.mode=TYPE;break}if(Te&64){r.msg="invalid literal/length code",l.mode=BAD;break}l.extra=Te&15,l.mode=LENEXT;case LENEXT:if(l.extra){for(Ce=l.extra;Z<Ce;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}l.length+=O&(1<<l.extra)-1,O>>>=l.extra,Z-=l.extra,l.back+=l.extra}l.was=l.length,l.mode=DIST;case DIST:for(;ye=l.distcode[O&(1<<l.distbits)-1],be=ye>>>24,Te=ye>>>16&255,Ne=ye&65535,!(be<=Z);){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}if((Te&240)===0){for(Ie=be,Ae=Te,Re=Ne;ye=l.distcode[Re+((O&(1<<Ie+Ae)-1)>>Ie)],be=ye>>>24,Te=ye>>>16&255,Ne=ye&65535,!(Ie+be<=Z);){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}O>>>=Ie,Z-=Ie,l.back+=Ie}if(O>>>=be,Z-=be,l.back+=be,Te&64){r.msg="invalid distance code",l.mode=BAD;break}l.offset=Ne,l.extra=Te&15,l.mode=DISTEXT;case DISTEXT:if(l.extra){for(Ce=l.extra;Z<Ce;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}l.offset+=O&(1<<l.extra)-1,O>>>=l.extra,Z-=l.extra,l.back+=l.extra}if(l.offset>l.dmax){r.msg="invalid distance too far back",l.mode=BAD;break}l.mode=MATCH;case MATCH:if(M===0)break e;if(ce=V-M,l.offset>ce){if(ce=l.offset-ce,ce>l.whave&&l.sane){r.msg="invalid distance too far back",l.mode=BAD;break}ce>l.wnext?(ce-=l.wnext,me=l.wsize-ce):me=l.wnext-ce,ce>l.length&&(ce=l.length),we=l.window}else we=A,me=N-l.offset,ce=l.length;ce>M&&(ce=M),M-=ce,l.length-=ce;do A[N++]=we[me++];while(--ce);l.length===0&&(l.mode=LEN);break;case LIT:if(M===0)break e;A[N++]=l.length,M--,l.mode=LEN;break;case CHECK:if(l.wrap){for(;Z<32;){if(y===0)break e;y--,O|=E[I++]<<Z,Z+=8}if(V-=M,r.total_out+=V,l.total+=V,V&&(r.adler=l.check=l.flags?crc32$1(l.check,A,V,N-V):adler32(l.check,A,V,N-V)),V=M,(l.flags?O:zswap32(O))!==l.check){r.msg="incorrect data check",l.mode=BAD;break}O=0,Z=0}l.mode=LENGTH;case LENGTH:if(l.wrap&&l.flags){for(;Z<32;){if(y===0)break e;y--,O+=E[I++]<<Z,Z+=8}if(O!==(l.total&4294967295)){r.msg="incorrect length check",l.mode=BAD;break}O=0,Z=0}l.mode=DONE;case DONE:De=Z_STREAM_END;break e;case BAD:De=Z_DATA_ERROR;break e;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return r.next_out=N,r.avail_out=M,r.next_in=I,r.avail_in=y,l.hold=O,l.bits=Z,(l.wsize||V!==r.avail_out&&l.mode<BAD&&(l.mode<CHECK||g!==Z_FINISH))&&updatewindow(r,r.output,r.next_out,V-r.avail_out),xe-=r.avail_in,V-=r.avail_out,r.total_in+=xe,r.total_out+=V,l.total+=V,l.wrap&&V&&(r.adler=l.check=l.flags?crc32$1(l.check,A,V,r.next_out-V):adler32(l.check,A,V,r.next_out-V)),r.data_type=l.bits+(l.last?64:0)+(l.mode===TYPE?128:0)+(l.mode===LEN_||l.mode===COPY_?256:0),(xe===0&&V===0||g===Z_FINISH)&&De===Z_OK&&(De=Z_BUF_ERROR),De}function inflateEnd(r){if(!r||!r.state)return Z_STREAM_ERROR;var g=r.state;return g.window&&(g.window=null),r.state=null,Z_OK}function inflateGetHeader(r,g){var l;return!r||!r.state||(l=r.state,(l.wrap&2)===0)?Z_STREAM_ERROR:(l.head=g,g.done=!1,Z_OK)}function inflateSetDictionary(r,g){var l=g.length,E,A,I;return!r||!r.state||(E=r.state,E.wrap!==0&&E.mode!==DICT)?Z_STREAM_ERROR:E.mode===DICT&&(A=1,A=adler32(A,g,l,0),A!==E.check)?Z_DATA_ERROR:(I=updatewindow(r,g,l,l),I?(E.mode=MEM,Z_MEM_ERROR):(E.havedict=1,Z_OK))}inflate$3.inflateReset=inflateReset,inflate$3.inflateReset2=inflateReset2,inflate$3.inflateResetKeep=inflateResetKeep,inflate$3.inflateInit=inflateInit,inflate$3.inflateInit2=inflateInit2,inflate$3.inflate=inflate$2,inflate$3.inflateEnd=inflateEnd,inflate$3.inflateGetHeader=inflateGetHeader,inflate$3.inflateSetDictionary=inflateSetDictionary,inflate$3.inflateInfo="pako inflate (from Nodeca project)";var constants$1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function GZheader$1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader$1,zlib_inflate=inflate$3,utils$d=common,strings=strings$2,c$3=constants$1,msg=messages,ZStream=zstream,GZheader=gzheader,toString=Object.prototype.toString;function Inflate(r){if(!(this instanceof Inflate))return new Inflate(r);this.options=utils$d.assign({chunkSize:16384,windowBits:0,to:""},r||{});var g=this.options;g.raw&&g.windowBits>=0&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),g.windowBits>=0&&g.windowBits<16&&!(r&&r.windowBits)&&(g.windowBits+=32),g.windowBits>15&&g.windowBits<48&&(g.windowBits&15)===0&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var l=zlib_inflate.inflateInit2(this.strm,g.windowBits);if(l!==c$3.Z_OK)throw new Error(msg[l]);if(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),g.dictionary&&(typeof g.dictionary=="string"?g.dictionary=strings.string2buf(g.dictionary):toString.call(g.dictionary)==="[object ArrayBuffer]"&&(g.dictionary=new Uint8Array(g.dictionary)),g.raw&&(l=zlib_inflate.inflateSetDictionary(this.strm,g.dictionary),l!==c$3.Z_OK)))throw new Error(msg[l])}Inflate.prototype.push=function(r,g){var l=this.strm,E=this.options.chunkSize,A=this.options.dictionary,I,N,y,M,O,Z=!1;if(this.ended)return!1;N=g===~~g?g:g===!0?c$3.Z_FINISH:c$3.Z_NO_FLUSH,typeof r=="string"?l.input=strings.binstring2buf(r):toString.call(r)==="[object ArrayBuffer]"?l.input=new Uint8Array(r):l.input=r,l.next_in=0,l.avail_in=l.input.length;do{if(l.avail_out===0&&(l.output=new utils$d.Buf8(E),l.next_out=0,l.avail_out=E),I=zlib_inflate.inflate(l,c$3.Z_NO_FLUSH),I===c$3.Z_NEED_DICT&&A&&(I=zlib_inflate.inflateSetDictionary(this.strm,A)),I===c$3.Z_BUF_ERROR&&Z===!0&&(I=c$3.Z_OK,Z=!1),I!==c$3.Z_STREAM_END&&I!==c$3.Z_OK)return this.onEnd(I),this.ended=!0,!1;l.next_out&&(l.avail_out===0||I===c$3.Z_STREAM_END||l.avail_in===0&&(N===c$3.Z_FINISH||N===c$3.Z_SYNC_FLUSH))&&(this.options.to==="string"?(y=strings.utf8border(l.output,l.next_out),M=l.next_out-y,O=strings.buf2string(l.output,y),l.next_out=M,l.avail_out=E-M,M&&utils$d.arraySet(l.output,l.output,y,M,0),this.onData(O)):this.onData(utils$d.shrinkBuf(l.output,l.next_out))),l.avail_in===0&&l.avail_out===0&&(Z=!0)}while((l.avail_in>0||l.avail_out===0)&&I!==c$3.Z_STREAM_END);return I===c$3.Z_STREAM_END&&(N=c$3.Z_FINISH),N===c$3.Z_FINISH?(I=zlib_inflate.inflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===c$3.Z_OK):(N===c$3.Z_SYNC_FLUSH&&(this.onEnd(c$3.Z_OK),l.avail_out=0),!0)},Inflate.prototype.onData=function(r){this.chunks.push(r)},Inflate.prototype.onEnd=function(r){r===c$3.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$d.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function inflate$1(r,g){var l=new Inflate(g);if(l.push(r,!0),l.err)throw l.msg||msg[l.err];return l.result}function inflateRaw(r,g){return g=g||{},g.raw=!0,inflate$1(r,g)}inflate$4.Inflate=Inflate,inflate$4.inflate=inflate$1,inflate$4.inflateRaw=inflateRaw,inflate$4.ungzip=inflate$1;var assign=common.assign,deflate=deflate$4,inflate=inflate$4,constants=constants$1,pako$1={};assign(pako$1,deflate,inflate,constants);var pako_1=pako$1,USE_TYPEDARRAY=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",pako=pako_1,utils$c=utils$r,GenericWorker$4=GenericWorker_1,ARRAY_TYPE=USE_TYPEDARRAY?"uint8array":"array";flate.magic="\b\0";function FlateWorker(r,g){GenericWorker$4.call(this,"FlateWorker/"+r),this._pako=null,this._pakoAction=r,this._pakoOptions=g,this.meta={}}utils$c.inherits(FlateWorker,GenericWorker$4),FlateWorker.prototype.processChunk=function(r){this.meta=r.meta,this._pako===null&&this._createPako(),this._pako.push(utils$c.transformTo(ARRAY_TYPE,r.data),!1)},FlateWorker.prototype.flush=function(){GenericWorker$4.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},FlateWorker.prototype.cleanUp=function(){GenericWorker$4.prototype.cleanUp.call(this),this._pako=null},FlateWorker.prototype._createPako=function(){this._pako=new pako[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var r=this;this._pako.onData=function(g){r.push({data:g,meta:r.meta})}},flate.compressWorker=function(r){return new FlateWorker("Deflate",r)},flate.uncompressWorker=function(){return new FlateWorker("Inflate",{})};var GenericWorker$3=GenericWorker_1;compressions$2.STORE={magic:"\0\0",compressWorker:function(){return new GenericWorker$3("STORE compression")},uncompressWorker:function(){return new GenericWorker$3("STORE decompression")}},compressions$2.DEFLATE=flate;var signature$1={};signature$1.LOCAL_FILE_HEADER="PK",signature$1.CENTRAL_FILE_HEADER="PK",signature$1.CENTRAL_DIRECTORY_END="PK",signature$1.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",signature$1.ZIP64_CENTRAL_DIRECTORY_END="PK",signature$1.DATA_DESCRIPTOR="PK\x07\b";var utils$b=utils$r,GenericWorker$2=GenericWorker_1,utf8$3=utf8$5,crc32=crc32_1$1,signature=signature$1,decToHex=function(r,g){var l="",E;for(E=0;E<g;E++)l+=String.fromCharCode(r&255),r=r>>>8;return l},generateUnixExternalFileAttr=function(r,g){var l=r;return r||(l=g?16893:33204),(l&65535)<<16},generateDosExternalFileAttr=function(r){return(r||0)&63},generateZipParts=function(r,g,l,E,A,I){var N=r.file,y=r.compression,M=I!==utf8$3.utf8encode,O=utils$b.transformTo("string",I(N.name)),Z=utils$b.transformTo("string",utf8$3.utf8encode(N.name)),xe=N.comment,V=utils$b.transformTo("string",I(xe)),ce=utils$b.transformTo("string",utf8$3.utf8encode(xe)),me=Z.length!==N.name.length,we=ce.length!==xe.length,ye,be,Te="",Ne="",Ie="",Ae=N.dir,Re=N.date,ke={crc32:0,compressedSize:0,uncompressedSize:0};(!g||l)&&(ke.crc32=r.crc32,ke.compressedSize=r.compressedSize,ke.uncompressedSize=r.uncompressedSize);var De=0;g&&(De|=8),!M&&(me||we)&&(De|=2048);var he=0,Le=0;Ae&&(he|=16),A==="UNIX"?(Le=798,he|=generateUnixExternalFileAttr(N.unixPermissions,Ae)):(Le=20,he|=generateDosExternalFileAttr(N.dosPermissions)),ye=Re.getUTCHours(),ye=ye<<6,ye=ye|Re.getUTCMinutes(),ye=ye<<5,ye=ye|Re.getUTCSeconds()/2,be=Re.getUTCFullYear()-1980,be=be<<4,be=be|Re.getUTCMonth()+1,be=be<<5,be=be|Re.getUTCDate(),me&&(Ne=decToHex(1,1)+decToHex(crc32(O),4)+Z,Te+="up"+decToHex(Ne.length,2)+Ne),we&&(Ie=decToHex(1,1)+decToHex(crc32(V),4)+ce,Te+="uc"+decToHex(Ie.length,2)+Ie);var Ce="";Ce+=`
\0`,Ce+=decToHex(De,2),Ce+=y.magic,Ce+=decToHex(ye,2),Ce+=decToHex(be,2),Ce+=decToHex(ke.crc32,4),Ce+=decToHex(ke.compressedSize,4),Ce+=decToHex(ke.uncompressedSize,4),Ce+=decToHex(O.length,2),Ce+=decToHex(Te.length,2);var Oe=signature.LOCAL_FILE_HEADER+Ce+O+Te,Xe=signature.CENTRAL_FILE_HEADER+decToHex(Le,2)+Ce+decToHex(V.length,2)+"\0\0\0\0"+decToHex(he,4)+decToHex(E,4)+O+Te+V;return{fileRecord:Oe,dirRecord:Xe}},generateCentralDirectoryEnd=function(r,g,l,E,A){var I="",N=utils$b.transformTo("string",A(E));return I=signature.CENTRAL_DIRECTORY_END+"\0\0\0\0"+decToHex(r,2)+decToHex(r,2)+decToHex(g,4)+decToHex(l,4)+decToHex(N.length,2)+N,I},generateDataDescriptors=function(r){var g="";return g=signature.DATA_DESCRIPTOR+decToHex(r.crc32,4)+decToHex(r.compressedSize,4)+decToHex(r.uncompressedSize,4),g};function ZipFileWorker$1(r,g,l,E){GenericWorker$2.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=l,this.encodeFileName=E,this.streamFiles=r,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}utils$b.inherits(ZipFileWorker$1,GenericWorker$2),ZipFileWorker$1.prototype.push=function(r){var g=r.meta.percent||0,l=this.entriesCount,E=this._sources.length;this.accumulate?this.contentBuffer.push(r):(this.bytesWritten+=r.data.length,GenericWorker$2.prototype.push.call(this,{data:r.data,meta:{currentFile:this.currentFile,percent:l?(g+100*(l-E-1))/l:100}}))},ZipFileWorker$1.prototype.openedSource=function(r){this.currentSourceOffset=this.bytesWritten,this.currentFile=r.file.name;var g=this.streamFiles&&!r.file.dir;if(g){var l=generateZipParts(r,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:l.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ZipFileWorker$1.prototype.closedSource=function(r){this.accumulate=!1;var g=this.streamFiles&&!r.file.dir,l=generateZipParts(r,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(l.dirRecord),g)this.push({data:generateDataDescriptors(r),meta:{percent:100}});else for(this.push({data:l.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ZipFileWorker$1.prototype.flush=function(){for(var r=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var l=this.bytesWritten-r,E=generateCentralDirectoryEnd(this.dirRecords.length,l,r,this.zipComment,this.encodeFileName);this.push({data:E,meta:{percent:100}})},ZipFileWorker$1.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ZipFileWorker$1.prototype.registerPrevious=function(r){this._sources.push(r);var g=this;return r.on("data",function(l){g.processChunk(l)}),r.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),r.on("error",function(l){g.error(l)}),this},ZipFileWorker$1.prototype.resume=function(){if(!GenericWorker$2.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},ZipFileWorker$1.prototype.error=function(r){var g=this._sources;if(!GenericWorker$2.prototype.error.call(this,r))return!1;for(var l=0;l<g.length;l++)try{g[l].error(r)}catch(E){}return!0},ZipFileWorker$1.prototype.lock=function(){GenericWorker$2.prototype.lock.call(this);for(var r=this._sources,g=0;g<r.length;g++)r[g].lock()};var ZipFileWorker_1=ZipFileWorker$1,compressions$1=compressions$2,ZipFileWorker=ZipFileWorker_1,getCompression=function(r,g){var l=r||g,E=compressions$1[l];if(!E)throw new Error(l+" is not a valid compression method !");return E};generate$1.generateWorker=function(r,g,l){var E=new ZipFileWorker(g.streamFiles,l,g.platform,g.encodeFileName),A=0;try{r.forEach(function(I,N){A++;var y=getCompression(N.options.compression,g.compression),M=N.options.compressionOptions||g.compressionOptions||{},O=N.dir,Z=N.date;N._compressWorker(y,M).withStreamInfo("file",{name:I,dir:O,date:Z,comment:N.comment||"",unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions}).pipe(E)}),E.entriesCount=A}catch(I){E.error(I)}return E};var utils$a=utils$r,GenericWorker$1=GenericWorker_1;function NodejsStreamInputAdapter$1(r,g){GenericWorker$1.call(this,"Nodejs stream input adapter for "+r),this._upstreamEnded=!1,this._bindStream(g)}utils$a.inherits(NodejsStreamInputAdapter$1,GenericWorker$1),NodejsStreamInputAdapter$1.prototype._bindStream=function(r){var g=this;this._stream=r,r.pause(),r.on("data",function(l){g.push({data:l,meta:{percent:0}})}).on("error",function(l){g.isPaused?this.generatedError=l:g.error(l)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},NodejsStreamInputAdapter$1.prototype.pause=function(){return GenericWorker$1.prototype.pause.call(this)?(this._stream.pause(),!0):!1},NodejsStreamInputAdapter$1.prototype.resume=function(){return GenericWorker$1.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};var NodejsStreamInputAdapter_1=NodejsStreamInputAdapter$1,utf8$2=utf8$5,utils$9=utils$r,GenericWorker=GenericWorker_1,StreamHelper=StreamHelper_1,defaults=defaults$1,CompressedObject$1=compressedObject,ZipObject=zipObject,generate=generate$1,nodejsUtils$1=nodejsUtils$2,NodejsStreamInputAdapter=NodejsStreamInputAdapter_1,fileAdd=function(r,g,l){var E=utils$9.getTypeOf(g),A,I=utils$9.extend(l||{},defaults);I.date=I.date||new Date,I.compression!==null&&(I.compression=I.compression.toUpperCase()),typeof I.unixPermissions=="string"&&(I.unixPermissions=parseInt(I.unixPermissions,8)),I.unixPermissions&&I.unixPermissions&16384&&(I.dir=!0),I.dosPermissions&&I.dosPermissions&16&&(I.dir=!0),I.dir&&(r=forceTrailingSlash(r)),I.createFolders&&(A=parentFolder(r))&&folderAdd.call(this,A,!0);var N=E==="string"&&I.binary===!1&&I.base64===!1;(!l||typeof l.binary=="undefined")&&(I.binary=!N);var y=g instanceof CompressedObject$1&&g.uncompressedSize===0;(y||I.dir||!g||g.length===0)&&(I.base64=!1,I.binary=!0,g="",I.compression="STORE",E="string");var M=null;g instanceof CompressedObject$1||g instanceof GenericWorker?M=g:nodejsUtils$1.isNode&&nodejsUtils$1.isStream(g)?M=new NodejsStreamInputAdapter(r,g):M=utils$9.prepareContent(r,g,I.binary,I.optimizedBinaryString,I.base64);var O=new ZipObject(r,M,I);this.files[r]=O},parentFolder=function(r){r.slice(-1)==="/"&&(r=r.substring(0,r.length-1));var g=r.lastIndexOf("/");return g>0?r.substring(0,g):""},forceTrailingSlash=function(r){return r.slice(-1)!=="/"&&(r+="/"),r},folderAdd=function(r,g){return g=typeof g!="undefined"?g:defaults.createFolders,r=forceTrailingSlash(r),this.files[r]||fileAdd.call(this,r,null,{dir:!0,createFolders:g}),this.files[r]};function isRegExp(r){return Object.prototype.toString.call(r)==="[object RegExp]"}var out={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(r){var g,l,E;for(g in this.files)E=this.files[g],l=g.slice(this.root.length,g.length),l&&g.slice(0,this.root.length)===this.root&&r(l,E)},filter:function(r){var g=[];return this.forEach(function(l,E){r(l,E)&&g.push(E)}),g},file:function(r,g,l){if(arguments.length===1)if(isRegExp(r)){var E=r;return this.filter(function(I,N){return!N.dir&&E.test(I)})}else{var A=this.files[this.root+r];return A&&!A.dir?A:null}else r=this.root+r,fileAdd.call(this,r,g,l);return this},folder:function(r){if(!r)return this;if(isRegExp(r))return this.filter(function(A,I){return I.dir&&r.test(A)});var g=this.root+r,l=folderAdd.call(this,g),E=this.clone();return E.root=l.name,E},remove:function(r){r=this.root+r;var g=this.files[r];if(g||(r.slice(-1)!=="/"&&(r+="/"),g=this.files[r]),g&&!g.dir)delete this.files[r];else for(var l=this.filter(function(A,I){return I.name.slice(0,r.length)===r}),E=0;E<l.length;E++)delete this.files[l[E].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(r){var g,l={};try{if(l=utils$9.extend(r||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:utf8$2.utf8encode}),l.type=l.type.toLowerCase(),l.compression=l.compression.toUpperCase(),l.type==="binarystring"&&(l.type="string"),!l.type)throw new Error("No output type specified.");utils$9.checkSupport(l.type),(l.platform==="darwin"||l.platform==="freebsd"||l.platform==="linux"||l.platform==="sunos")&&(l.platform="UNIX"),l.platform==="win32"&&(l.platform="DOS");var E=l.comment||this.comment||"";g=generate.generateWorker(this,l,E)}catch(A){g=new GenericWorker("error"),g.error(A)}return new StreamHelper(g,l.type||"string",l.mimeType)},generateAsync:function(r,g){return this.generateInternalStream(r).accumulate(g)},generateNodeStream:function(r,g){return r=r||{},r.type||(r.type="nodebuffer"),this.generateInternalStream(r).toNodejsStream(g)}},object=out,utils$8=utils$r;function DataReader$2(r){this.data=r,this.length=r.length,this.index=0,this.zero=0}DataReader$2.prototype={checkOffset:function(r){this.checkIndex(this.index+r)},checkIndex:function(r){if(this.length<this.zero+r||r<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+r+"). Corrupted zip ?")},setIndex:function(r){this.checkIndex(r),this.index=r},skip:function(r){this.setIndex(this.index+r)},byteAt:function(){},readInt:function(r){var g=0,l;for(this.checkOffset(r),l=this.index+r-1;l>=this.index;l--)g=(g<<8)+this.byteAt(l);return this.index+=r,g},readString:function(r){return utils$8.transformTo("string",this.readData(r))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var r=this.readInt(4);return new Date(Date.UTC((r>>25&127)+1980,(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(r&31)<<1))}};var DataReader_1=DataReader$2,DataReader$1=DataReader_1,utils$7=utils$r;function ArrayReader$2(r){DataReader$1.call(this,r);for(var g=0;g<this.data.length;g++)r[g]=r[g]&255}utils$7.inherits(ArrayReader$2,DataReader$1),ArrayReader$2.prototype.byteAt=function(r){return this.data[this.zero+r]},ArrayReader$2.prototype.lastIndexOfSignature=function(r){for(var g=r.charCodeAt(0),l=r.charCodeAt(1),E=r.charCodeAt(2),A=r.charCodeAt(3),I=this.length-4;I>=0;--I)if(this.data[I]===g&&this.data[I+1]===l&&this.data[I+2]===E&&this.data[I+3]===A)return I-this.zero;return-1},ArrayReader$2.prototype.readAndCheckSignature=function(r){var g=r.charCodeAt(0),l=r.charCodeAt(1),E=r.charCodeAt(2),A=r.charCodeAt(3),I=this.readData(4);return g===I[0]&&l===I[1]&&E===I[2]&&A===I[3]},ArrayReader$2.prototype.readData=function(r){if(this.checkOffset(r),r===0)return[];var g=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var ArrayReader_1=ArrayReader$2,DataReader=DataReader_1,utils$6=utils$r;function StringReader$1(r){DataReader.call(this,r)}utils$6.inherits(StringReader$1,DataReader),StringReader$1.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},StringReader$1.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},StringReader$1.prototype.readAndCheckSignature=function(r){var g=this.readData(4);return r===g},StringReader$1.prototype.readData=function(r){this.checkOffset(r);var g=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var StringReader_1=StringReader$1,ArrayReader$1=ArrayReader_1,utils$5=utils$r;function Uint8ArrayReader$2(r){ArrayReader$1.call(this,r)}utils$5.inherits(Uint8ArrayReader$2,ArrayReader$1),Uint8ArrayReader$2.prototype.readData=function(r){if(this.checkOffset(r),r===0)return new Uint8Array(0);var g=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var Uint8ArrayReader_1=Uint8ArrayReader$2,Uint8ArrayReader$1=Uint8ArrayReader_1,utils$4=utils$r;function NodeBufferReader$1(r){Uint8ArrayReader$1.call(this,r)}utils$4.inherits(NodeBufferReader$1,Uint8ArrayReader$1),NodeBufferReader$1.prototype.readData=function(r){this.checkOffset(r);var g=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var NodeBufferReader_1=NodeBufferReader$1,utils$3=utils$r,support$2=support$5,ArrayReader=ArrayReader_1,StringReader=StringReader_1,NodeBufferReader=NodeBufferReader_1,Uint8ArrayReader=Uint8ArrayReader_1,readerFor$2=function(r){var g=utils$3.getTypeOf(r);return utils$3.checkSupport(g),g==="string"&&!support$2.uint8array?new StringReader(r):g==="nodebuffer"?new NodeBufferReader(r):support$2.uint8array?new Uint8ArrayReader(utils$3.transformTo("uint8array",r)):new ArrayReader(utils$3.transformTo("array",r))},readerFor$1=readerFor$2,utils$2=utils$r,CompressedObject=compressedObject,crc32fn=crc32_1$1,utf8$1=utf8$5,compressions=compressions$2,support$1=support$5,MADE_BY_DOS=0,MADE_BY_UNIX=3,findCompression=function(r){for(var g in compressions)if(Object.prototype.hasOwnProperty.call(compressions,g)&&compressions[g].magic===r)return compressions[g];return null};function ZipEntry$1(r,g){this.options=r,this.loadOptions=g}ZipEntry$1.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(r){var g,l;if(r.skip(22),this.fileNameLength=r.readInt(2),l=r.readInt(2),this.fileName=r.readData(this.fileNameLength),r.skip(l),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(g=findCompression(this.compressionMethod),g===null)throw new Error("Corrupted zip : compression "+utils$2.pretty(this.compressionMethod)+" unknown (inner file : "+utils$2.transformTo("string",this.fileName)+")");this.decompressed=new CompressedObject(this.compressedSize,this.uncompressedSize,this.crc32,g,r.readData(this.compressedSize))},readCentralPart:function(r){this.versionMadeBy=r.readInt(2),r.skip(2),this.bitFlag=r.readInt(2),this.compressionMethod=r.readString(2),this.date=r.readDate(),this.crc32=r.readInt(4),this.compressedSize=r.readInt(4),this.uncompressedSize=r.readInt(4);var g=r.readInt(2);if(this.extraFieldsLength=r.readInt(2),this.fileCommentLength=r.readInt(2),this.diskNumberStart=r.readInt(2),this.internalFileAttributes=r.readInt(2),this.externalFileAttributes=r.readInt(4),this.localHeaderOffset=r.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");r.skip(g),this.readExtraFields(r),this.parseZIP64ExtraField(r),this.fileComment=r.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var r=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),r===MADE_BY_DOS&&(this.dosPermissions=this.externalFileAttributes&63),r===MADE_BY_UNIX&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var r=readerFor$1(this.extraFields[1].value);this.uncompressedSize===utils$2.MAX_VALUE_32BITS&&(this.uncompressedSize=r.readInt(8)),this.compressedSize===utils$2.MAX_VALUE_32BITS&&(this.compressedSize=r.readInt(8)),this.localHeaderOffset===utils$2.MAX_VALUE_32BITS&&(this.localHeaderOffset=r.readInt(8)),this.diskNumberStart===utils$2.MAX_VALUE_32BITS&&(this.diskNumberStart=r.readInt(4))}},readExtraFields:function(r){var g=r.index+this.extraFieldsLength,l,E,A;for(this.extraFields||(this.extraFields={});r.index+4<g;)l=r.readInt(2),E=r.readInt(2),A=r.readData(E),this.extraFields[l]={id:l,length:E,value:A};r.setIndex(g)},handleUTF8:function(){var r=support$1.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=utf8$1.utf8decode(this.fileName),this.fileCommentStr=utf8$1.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var l=utils$2.transformTo(r,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(l)}var E=this.findExtraFieldUnicodeComment();if(E!==null)this.fileCommentStr=E;else{var A=utils$2.transformTo(r,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(A)}}},findExtraFieldUnicodePath:function(){var r=this.extraFields[28789];if(r){var g=readerFor$1(r.value);return g.readInt(1)!==1||crc32fn(this.fileName)!==g.readInt(4)?null:utf8$1.utf8decode(g.readData(r.length-5))}return null},findExtraFieldUnicodeComment:function(){var r=this.extraFields[25461];if(r){var g=readerFor$1(r.value);return g.readInt(1)!==1||crc32fn(this.fileComment)!==g.readInt(4)?null:utf8$1.utf8decode(g.readData(r.length-5))}return null}};var zipEntry=ZipEntry$1,readerFor=readerFor$2,utils$1=utils$r,sig=signature$1,ZipEntry=zipEntry,support=support$5;function ZipEntries$1(r){this.files=[],this.loadOptions=r}ZipEntries$1.prototype={checkSignature:function(r){if(!this.reader.readAndCheckSignature(r)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+utils$1.pretty(g)+", expected "+utils$1.pretty(r)+")")}},isSignature:function(r,g){var l=this.reader.index;this.reader.setIndex(r);var E=this.reader.readString(4),A=E===g;return this.reader.setIndex(l),A},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var r=this.reader.readData(this.zipCommentLength),g=support.uint8array?"uint8array":"array",l=utils$1.transformTo(g,r);this.zipComment=this.loadOptions.decodeFileName(l)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var r=this.zip64EndOfCentralSize-44,g=0,l,E,A;g<r;)l=this.reader.readInt(2),E=this.reader.readInt(4),A=this.reader.readData(E),this.zip64ExtensibleData[l]={id:l,length:E,value:A}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var r,g;for(r=0;r<this.files.length;r++)g=this.files[r],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(sig.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var r;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(sig.CENTRAL_FILE_HEADER);)r=new ZipEntry({zip64:this.zip64},this.loadOptions),r.readCentralPart(this.reader),this.files.push(r);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var r=this.reader.lastIndexOfSignature(sig.CENTRAL_DIRECTORY_END);if(r<0){var g=!this.isSignature(0,sig.LOCAL_FILE_HEADER);throw g?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(r);var l=r;if(this.checkSignature(sig.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===utils$1.MAX_VALUE_16BITS||this.diskWithCentralDirStart===utils$1.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===utils$1.MAX_VALUE_16BITS||this.centralDirRecords===utils$1.MAX_VALUE_16BITS||this.centralDirSize===utils$1.MAX_VALUE_32BITS||this.centralDirOffset===utils$1.MAX_VALUE_32BITS){if(this.zip64=!0,r=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),r<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(r),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,sig.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var E=this.centralDirOffset+this.centralDirSize;this.zip64&&(E+=20,E+=12+this.zip64EndOfCentralSize);var A=l-E;if(A>0)this.isSignature(l,sig.CENTRAL_FILE_HEADER)||(this.reader.zero=A);else if(A<0)throw new Error("Corrupted zip: missing "+Math.abs(A)+" bytes.")},prepareReader:function(r){this.reader=readerFor(r)},load:function(r){this.prepareReader(r),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var zipEntries=ZipEntries$1,utils=utils$r,external=external$3,utf8=utf8$5,ZipEntries=zipEntries,Crc32Probe=Crc32Probe_1,nodejsUtils=nodejsUtils$2;function checkEntryCRC32(r){return new external.Promise(function(g,l){var E=r.decompressed.getContentWorker().pipe(new Crc32Probe);E.on("error",function(A){l(A)}).on("end",function(){E.streamInfo.crc32!==r.decompressed.crc32?l(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}var load=function(r,g){var l=this;return g=utils.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:utf8.utf8decode}),nodejsUtils.isNode&&nodejsUtils.isStream(r)?external.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):utils.prepareContent("the loaded zip file",r,!0,g.optimizedBinaryString,g.base64).then(function(E){var A=new ZipEntries(g);return A.load(E),A}).then(function(A){var I=[external.Promise.resolve(A)],N=A.files;if(g.checkCRC32)for(var y=0;y<N.length;y++)I.push(checkEntryCRC32(N[y]));return external.Promise.all(I)}).then(function(A){for(var I=A.shift(),N=I.files,y=0;y<N.length;y++){var M=N[y],O=M.fileNameStr,Z=utils.resolve(M.fileNameStr);l.file(Z,M.decompressed,{binary:!0,optimizedBinaryString:!0,date:M.date,dir:M.dir,comment:M.fileCommentStr.length?M.fileCommentStr:null,unixPermissions:M.unixPermissions,dosPermissions:M.dosPermissions,createFolders:g.createFolders}),M.dir||(l.file(Z).unsafeOriginalName=O)}return I.zipComment.length&&(l.comment=I.zipComment),l})};function JSZip(){if(!(this instanceof JSZip))return new JSZip;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new JSZip;for(var g in this)typeof this[g]!="function"&&(r[g]=this[g]);return r}}JSZip.prototype=object,JSZip.prototype.loadAsync=load,JSZip.support=support$5,JSZip.defaults=defaults$1,JSZip.version="3.10.1",JSZip.loadAsync=function(r,g){return new JSZip().loadAsync(r,g)},JSZip.external=external$3;var lib=JSZip;const t=r=>lib.loadAsync(r),s$1=(r,g)=>{const l=r.file(g);return l?l.async("text"):null},o=(r,g,l)=>r.file(g,l,{binary:!1}),p$2=(r,g)=>r.generateAsync({type:"uint8array",compression:"DEFLATE",compressionOptions:{level:g}});var sax={},string_decoder={},safeBuffer={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(r,g){var l=buffer$1,E=l.Buffer;function A(N,y){for(var M in N)y[M]=N[M]}E.from&&E.alloc&&E.allocUnsafe&&E.allocUnsafeSlow?r.exports=l:(A(l,g),g.Buffer=I);function I(N,y,M){return E(N,y,M)}I.prototype=Object.create(E.prototype),A(E,I),I.from=function(N,y,M){if(typeof N=="number")throw new TypeError("Argument must not be a number");return E(N,y,M)},I.alloc=function(N,y,M){if(typeof N!="number")throw new TypeError("Argument must be a number");var O=E(N);return y!==void 0?typeof M=="string"?O.fill(y,M):O.fill(y):O.fill(0),O},I.allocUnsafe=function(N){if(typeof N!="number")throw new TypeError("Argument must be a number");return E(N)},I.allocUnsafeSlow=function(N){if(typeof N!="number")throw new TypeError("Argument must be a number");return l.SlowBuffer(N)}})(safeBuffer,safeBuffer.exports);var Buffer$1=safeBuffer.exports.Buffer,isEncoding=Buffer$1.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(r){if(!r)return"utf8";for(var g;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(g)return;r=(""+r).toLowerCase(),g=!0}}function normalizeEncoding(r){var g=_normalizeEncoding(r);if(typeof g!="string"&&(Buffer$1.isEncoding===isEncoding||!isEncoding(r)))throw new Error("Unknown encoding: "+r);return g||r}string_decoder.StringDecoder=StringDecoder;function StringDecoder(r){this.encoding=normalizeEncoding(r);var g;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,g=4;break;case"utf8":this.fillLast=utf8FillLast,g=4;break;case"base64":this.text=base64Text,this.end=base64End,g=3;break;default:this.write=simpleWrite,this.end=simpleEnd;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer$1.allocUnsafe(g)}StringDecoder.prototype.write=function(r){if(r.length===0)return"";var g,l;if(this.lastNeed){if(g=this.fillLast(r),g===void 0)return"";l=this.lastNeed,this.lastNeed=0}else l=0;return l<r.length?g?g+this.text(r,l):this.text(r,l):g||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function utf8CheckByte(r){return r<=127?0:r>>5===6?2:r>>4===14?3:r>>3===30?4:r>>6===2?-1:-2}function utf8CheckIncomplete(r,g,l){var E=g.length-1;if(E<l)return 0;var A=utf8CheckByte(g[E]);return A>=0?(A>0&&(r.lastNeed=A-1),A):--E<l||A===-2?0:(A=utf8CheckByte(g[E]),A>=0?(A>0&&(r.lastNeed=A-2),A):--E<l||A===-2?0:(A=utf8CheckByte(g[E]),A>=0?(A>0&&(A===2?A=0:r.lastNeed=A-3),A):0))}function utf8CheckExtraBytes(r,g,l){if((g[0]&192)!==128)return r.lastNeed=0,"\uFFFD";if(r.lastNeed>1&&g.length>1){if((g[1]&192)!==128)return r.lastNeed=1,"\uFFFD";if(r.lastNeed>2&&g.length>2&&(g[2]&192)!==128)return r.lastNeed=2,"\uFFFD"}}function utf8FillLast(r){var g=this.lastTotal-this.lastNeed,l=utf8CheckExtraBytes(this,r);if(l!==void 0)return l;if(this.lastNeed<=r.length)return r.copy(this.lastChar,g,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,g,0,r.length),this.lastNeed-=r.length}function utf8Text(r,g){var l=utf8CheckIncomplete(this,r,g);if(!this.lastNeed)return r.toString("utf8",g);this.lastTotal=l;var E=r.length-(l-this.lastNeed);return r.copy(this.lastChar,0,E),r.toString("utf8",g,E)}function utf8End(r){var g=r&&r.length?this.write(r):"";return this.lastNeed?g+"\uFFFD":g}function utf16Text(r,g){if((r.length-g)%2===0){var l=r.toString("utf16le",g);if(l){var E=l.charCodeAt(l.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],l.slice(0,-1)}return l}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",g,r.length-1)}function utf16End(r){var g=r&&r.length?this.write(r):"";if(this.lastNeed){var l=this.lastTotal-this.lastNeed;return g+this.lastChar.toString("utf16le",0,l)}return g}function base64Text(r,g){var l=(r.length-g)%3;return l===0?r.toString("base64",g):(this.lastNeed=3-l,this.lastTotal=3,l===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",g,r.length-l))}function base64End(r){var g=r&&r.length?this.write(r):"";return this.lastNeed?g+this.lastChar.toString("base64",0,3-this.lastNeed):g}function simpleWrite(r){return r.toString(this.encoding)}function simpleEnd(r){return r&&r.length?this.write(r):""}(function(r){(function(g){g.parser=function(z,k){return new E(z,k)},g.SAXParser=E,g.SAXStream=Z,g.createStream=O,g.MAX_BUFFER_LENGTH=64*1024;var l=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];g.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function E(z,k){if(!(this instanceof E))return new E(z,k);var $e=this;I($e),$e.q=$e.c="",$e.bufferCheckPosition=g.MAX_BUFFER_LENGTH,$e.opt=k||{},$e.opt.lowercase=$e.opt.lowercase||$e.opt.lowercasetags,$e.looseCase=$e.opt.lowercase?"toLowerCase":"toUpperCase",$e.tags=[],$e.closed=$e.closedRoot=$e.sawRoot=!1,$e.tag=$e.error=null,$e.strict=!!z,$e.noscript=!!(z||$e.opt.noscript),$e.state=he.BEGIN,$e.strictEntities=$e.opt.strictEntities,$e.ENTITIES=$e.strictEntities?Object.create(g.XML_ENTITIES):Object.create(g.ENTITIES),$e.attribList=[],$e.opt.xmlns&&($e.ns=Object.create(we)),$e.trackPosition=$e.opt.position!==!1,$e.trackPosition&&($e.position=$e.line=$e.column=0),Ce($e,"onready")}Object.create||(Object.create=function(z){function k(){}k.prototype=z;var $e=new k;return $e}),Object.keys||(Object.keys=function(z){var k=[];for(var $e in z)z.hasOwnProperty($e)&&k.push($e);return k});function A(z){for(var k=Math.max(g.MAX_BUFFER_LENGTH,10),$e=0,Ee=0,Me=l.length;Ee<Me;Ee++){var He=z[l[Ee]].length;if(He>k)switch(l[Ee]){case"textNode":Xe(z);break;case"cdata":Oe(z,"oncdata",z.cdata),z.cdata="";break;case"script":Oe(z,"onscript",z.script),z.script="";break;default:Je(z,"Max buffer length exceeded: "+l[Ee])}$e=Math.max($e,He)}var Ze=g.MAX_BUFFER_LENGTH-$e;z.bufferCheckPosition=Ze+z.position}function I(z){for(var k=0,$e=l.length;k<$e;k++)z[l[k]]=""}function N(z){Xe(z),z.cdata!==""&&(Oe(z,"oncdata",z.cdata),z.cdata=""),z.script!==""&&(Oe(z,"onscript",z.script),z.script="")}E.prototype={end:function(){Qe(this)},write:ht,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){N(this)}};var y;try{y=require("stream").Stream}catch(z){y=function(){}}y||(y=function(){});var M=g.EVENTS.filter(function(z){return z!=="error"&&z!=="end"});function O(z,k){return new Z(z,k)}function Z(z,k){if(!(this instanceof Z))return new Z(z,k);y.apply(this),this._parser=new E(z,k),this.writable=!0,this.readable=!0;var $e=this;this._parser.onend=function(){$e.emit("end")},this._parser.onerror=function(Ee){$e.emit("error",Ee),$e._parser.error=null},this._decoder=null,M.forEach(function(Ee){Object.defineProperty($e,"on"+Ee,{get:function(){return $e._parser["on"+Ee]},set:function(Me){if(!Me)return $e.removeAllListeners(Ee),$e._parser["on"+Ee]=Me,Me;$e.on(Ee,Me)},enumerable:!0,configurable:!1})})}Z.prototype=Object.create(y.prototype,{constructor:{value:Z}}),Z.prototype.write=function(z){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(z)){if(!this._decoder){var k=string_decoder.StringDecoder;this._decoder=new k("utf8")}z=this._decoder.write(z)}return this._parser.write(z.toString()),this.emit("data",z),!0},Z.prototype.end=function(z){return z&&z.length&&this.write(z),this._parser.end(),!0},Z.prototype.on=function(z,k){var $e=this;return!$e._parser["on"+z]&&M.indexOf(z)!==-1&&($e._parser["on"+z]=function(){var Ee=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);Ee.splice(0,0,z),$e.emit.apply($e,Ee)}),y.prototype.on.call($e,z,k)};var xe="[CDATA[",V="DOCTYPE",ce="http://www.w3.org/XML/1998/namespace",me="http://www.w3.org/2000/xmlns/",we={xml:ce,xmlns:me},ye=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,be=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,Te=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Ne=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function Ie(z){return z===" "||z===`
`||z==="\r"||z==="	"}function Ae(z){return z==='"'||z==="'"}function Re(z){return z===">"||Ie(z)}function ke(z,k){return z.test(k)}function De(z,k){return!ke(z,k)}var he=0;g.STATE={BEGIN:he++,BEGIN_WHITESPACE:he++,TEXT:he++,TEXT_ENTITY:he++,OPEN_WAKA:he++,SGML_DECL:he++,SGML_DECL_QUOTED:he++,DOCTYPE:he++,DOCTYPE_QUOTED:he++,DOCTYPE_DTD:he++,DOCTYPE_DTD_QUOTED:he++,COMMENT_STARTING:he++,COMMENT:he++,COMMENT_ENDING:he++,COMMENT_ENDED:he++,CDATA:he++,CDATA_ENDING:he++,CDATA_ENDING_2:he++,PROC_INST:he++,PROC_INST_BODY:he++,PROC_INST_ENDING:he++,OPEN_TAG:he++,OPEN_TAG_SLASH:he++,ATTRIB:he++,ATTRIB_NAME:he++,ATTRIB_NAME_SAW_WHITE:he++,ATTRIB_VALUE:he++,ATTRIB_VALUE_QUOTED:he++,ATTRIB_VALUE_CLOSED:he++,ATTRIB_VALUE_UNQUOTED:he++,ATTRIB_VALUE_ENTITY_Q:he++,ATTRIB_VALUE_ENTITY_U:he++,CLOSE_TAG:he++,CLOSE_TAG_SAW_WHITE:he++,SCRIPT:he++,SCRIPT_ENDING:he++},g.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},g.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(g.ENTITIES).forEach(function(z){var k=g.ENTITIES[z],$e=typeof k=="number"?String.fromCharCode(k):k;g.ENTITIES[z]=$e});for(var Le in g.STATE)g.STATE[g.STATE[Le]]=Le;he=g.STATE;function Ce(z,k,$e){z[k]&&z[k]($e)}function Oe(z,k,$e){z.textNode&&Xe(z),Ce(z,k,$e)}function Xe(z){z.textNode=Ke(z.opt,z.textNode),z.textNode&&Ce(z,"ontext",z.textNode),z.textNode=""}function Ke(z,k){return z.trim&&(k=k.trim()),z.normalize&&(k=k.replace(/\s+/g," ")),k}function Je(z,k){return Xe(z),z.trackPosition&&(k+=`
Line: `+z.line+`
Column: `+z.column+`
Char: `+z.c),k=new Error(k),z.error=k,Ce(z,"onerror",k),z}function Qe(z){return z.sawRoot&&!z.closedRoot&&Be(z,"Unclosed root tag"),z.state!==he.BEGIN&&z.state!==he.BEGIN_WHITESPACE&&z.state!==he.TEXT&&Je(z,"Unexpected end"),Xe(z),z.c="",z.closed=!0,Ce(z,"onend"),E.call(z,z.strict,z.opt),z}function Be(z,k){if(typeof z!="object"||!(z instanceof E))throw new Error("bad call to strictFail");z.strict&&Je(z,k)}function tt(z){z.strict||(z.tagName=z.tagName[z.looseCase]());var k=z.tags[z.tags.length-1]||z,$e=z.tag={name:z.tagName,attributes:{}};z.opt.xmlns&&($e.ns=k.ns),z.attribList.length=0,Oe(z,"onopentagstart",$e)}function st(z,k){var $e=z.indexOf(":"),Ee=$e<0?["",z]:z.split(":"),Me=Ee[0],He=Ee[1];return k&&z==="xmlns"&&(Me="xmlns",He=""),{prefix:Me,local:He}}function it(z){if(z.strict||(z.attribName=z.attribName[z.looseCase]()),z.attribList.indexOf(z.attribName)!==-1||z.tag.attributes.hasOwnProperty(z.attribName)){z.attribName=z.attribValue="";return}if(z.opt.xmlns){var k=st(z.attribName,!0),$e=k.prefix,Ee=k.local;if($e==="xmlns")if(Ee==="xml"&&z.attribValue!==ce)Be(z,"xml: prefix must be bound to "+ce+`
Actual: `+z.attribValue);else if(Ee==="xmlns"&&z.attribValue!==me)Be(z,"xmlns: prefix must be bound to "+me+`
Actual: `+z.attribValue);else{var Me=z.tag,He=z.tags[z.tags.length-1]||z;Me.ns===He.ns&&(Me.ns=Object.create(He.ns)),Me.ns[Ee]=z.attribValue}z.attribList.push([z.attribName,z.attribValue])}else z.tag.attributes[z.attribName]=z.attribValue,Oe(z,"onattribute",{name:z.attribName,value:z.attribValue});z.attribName=z.attribValue=""}function Ue(z,k){if(z.opt.xmlns){var $e=z.tag,Ee=st(z.tagName);$e.prefix=Ee.prefix,$e.local=Ee.local,$e.uri=$e.ns[Ee.prefix]||"",$e.prefix&&!$e.uri&&(Be(z,"Unbound namespace prefix: "+JSON.stringify(z.tagName)),$e.uri=Ee.prefix);var Me=z.tags[z.tags.length-1]||z;$e.ns&&Me.ns!==$e.ns&&Object.keys($e.ns).forEach(function(et){Oe(z,"onopennamespace",{prefix:et,uri:$e.ns[et]})});for(var He=0,Ze=z.attribList.length;He<Ze;He++){var Ye=z.attribList[He],qe=Ye[0],nt=Ye[1],Ge=st(qe,!0),rt=Ge.prefix,dt=Ge.local,ct=rt===""?"":$e.ns[rt]||"",at={name:qe,value:nt,prefix:rt,local:dt,uri:ct};rt&&rt!=="xmlns"&&!ct&&(Be(z,"Unbound namespace prefix: "+JSON.stringify(rt)),at.uri=rt),z.tag.attributes[qe]=at,Oe(z,"onattribute",at)}z.attribList.length=0}z.tag.isSelfClosing=!!k,z.sawRoot=!0,z.tags.push(z.tag),Oe(z,"onopentag",z.tag),k||(!z.noscript&&z.tagName.toLowerCase()==="script"?z.state=he.SCRIPT:z.state=he.TEXT,z.tag=null,z.tagName=""),z.attribName=z.attribValue="",z.attribList.length=0}function Ve(z){if(!z.tagName){Be(z,"Weird empty close tag."),z.textNode+="</>",z.state=he.TEXT;return}if(z.script){if(z.tagName!=="script"){z.script+="</"+z.tagName+">",z.tagName="",z.state=he.SCRIPT;return}Oe(z,"onscript",z.script),z.script=""}var k=z.tags.length,$e=z.tagName;z.strict||($e=$e[z.looseCase]());for(var Ee=$e;k--;){var Me=z.tags[k];if(Me.name!==Ee)Be(z,"Unexpected close tag");else break}if(k<0){Be(z,"Unmatched closing tag: "+z.tagName),z.textNode+="</"+z.tagName+">",z.state=he.TEXT;return}z.tagName=$e;for(var He=z.tags.length;He-- >k;){var Ze=z.tag=z.tags.pop();z.tagName=z.tag.name,Oe(z,"onclosetag",z.tagName);var Ye={};for(var qe in Ze.ns)Ye[qe]=Ze.ns[qe];var nt=z.tags[z.tags.length-1]||z;z.opt.xmlns&&Ze.ns!==nt.ns&&Object.keys(Ze.ns).forEach(function(Ge){var rt=Ze.ns[Ge];Oe(z,"onclosenamespace",{prefix:Ge,uri:rt})})}k===0&&(z.closedRoot=!0),z.tagName=z.attribValue=z.attribName="",z.attribList.length=0,z.state=he.TEXT}function lt(z){var k=z.entity,$e=k.toLowerCase(),Ee,Me="";return z.ENTITIES[k]?z.ENTITIES[k]:z.ENTITIES[$e]?z.ENTITIES[$e]:(k=$e,k.charAt(0)==="#"&&(k.charAt(1)==="x"?(k=k.slice(2),Ee=parseInt(k,16),Me=Ee.toString(16)):(k=k.slice(1),Ee=parseInt(k,10),Me=Ee.toString(10))),k=k.replace(/^0+/,""),isNaN(Ee)||Me.toLowerCase()!==k?(Be(z,"Invalid character entity"),"&"+z.entity+";"):String.fromCodePoint(Ee))}function ft(z,k){k==="<"?(z.state=he.OPEN_WAKA,z.startTagPosition=z.position):Ie(k)||(Be(z,"Non-whitespace before first tag."),z.textNode=k,z.state=he.TEXT)}function ut(z,k){var $e="";return k<z.length&&($e=z.charAt(k)),$e}function ht(z){var k=this;if(this.error)throw this.error;if(k.closed)return Je(k,"Cannot write after close. Assign an onready handler.");if(z===null)return Qe(k);typeof z=="object"&&(z=z.toString());for(var $e=0,Ee="";Ee=ut(z,$e++),k.c=Ee,!!Ee;)switch(k.trackPosition&&(k.position++,Ee===`
`?(k.line++,k.column=0):k.column++),k.state){case he.BEGIN:if(k.state=he.BEGIN_WHITESPACE,Ee==="\uFEFF")continue;ft(k,Ee);continue;case he.BEGIN_WHITESPACE:ft(k,Ee);continue;case he.TEXT:if(k.sawRoot&&!k.closedRoot){for(var Me=$e-1;Ee&&Ee!=="<"&&Ee!=="&";)Ee=ut(z,$e++),Ee&&k.trackPosition&&(k.position++,Ee===`
`?(k.line++,k.column=0):k.column++);k.textNode+=z.substring(Me,$e-1)}Ee==="<"&&!(k.sawRoot&&k.closedRoot&&!k.strict)?(k.state=he.OPEN_WAKA,k.startTagPosition=k.position):(!Ie(Ee)&&(!k.sawRoot||k.closedRoot)&&Be(k,"Text data outside of root node."),Ee==="&"?k.state=he.TEXT_ENTITY:k.textNode+=Ee);continue;case he.SCRIPT:Ee==="<"?k.state=he.SCRIPT_ENDING:k.script+=Ee;continue;case he.SCRIPT_ENDING:Ee==="/"?k.state=he.CLOSE_TAG:(k.script+="<"+Ee,k.state=he.SCRIPT);continue;case he.OPEN_WAKA:if(Ee==="!")k.state=he.SGML_DECL,k.sgmlDecl="";else if(!Ie(Ee))if(ke(ye,Ee))k.state=he.OPEN_TAG,k.tagName=Ee;else if(Ee==="/")k.state=he.CLOSE_TAG,k.tagName="";else if(Ee==="?")k.state=he.PROC_INST,k.procInstName=k.procInstBody="";else{if(Be(k,"Unencoded <"),k.startTagPosition+1<k.position){var He=k.position-k.startTagPosition;Ee=new Array(He).join(" ")+Ee}k.textNode+="<"+Ee,k.state=he.TEXT}continue;case he.SGML_DECL:(k.sgmlDecl+Ee).toUpperCase()===xe?(Oe(k,"onopencdata"),k.state=he.CDATA,k.sgmlDecl="",k.cdata=""):k.sgmlDecl+Ee==="--"?(k.state=he.COMMENT,k.comment="",k.sgmlDecl=""):(k.sgmlDecl+Ee).toUpperCase()===V?(k.state=he.DOCTYPE,(k.doctype||k.sawRoot)&&Be(k,"Inappropriately located doctype declaration"),k.doctype="",k.sgmlDecl=""):Ee===">"?(Oe(k,"onsgmldeclaration",k.sgmlDecl),k.sgmlDecl="",k.state=he.TEXT):(Ae(Ee)&&(k.state=he.SGML_DECL_QUOTED),k.sgmlDecl+=Ee);continue;case he.SGML_DECL_QUOTED:Ee===k.q&&(k.state=he.SGML_DECL,k.q=""),k.sgmlDecl+=Ee;continue;case he.DOCTYPE:Ee===">"?(k.state=he.TEXT,Oe(k,"ondoctype",k.doctype),k.doctype=!0):(k.doctype+=Ee,Ee==="["?k.state=he.DOCTYPE_DTD:Ae(Ee)&&(k.state=he.DOCTYPE_QUOTED,k.q=Ee));continue;case he.DOCTYPE_QUOTED:k.doctype+=Ee,Ee===k.q&&(k.q="",k.state=he.DOCTYPE);continue;case he.DOCTYPE_DTD:k.doctype+=Ee,Ee==="]"?k.state=he.DOCTYPE:Ae(Ee)&&(k.state=he.DOCTYPE_DTD_QUOTED,k.q=Ee);continue;case he.DOCTYPE_DTD_QUOTED:k.doctype+=Ee,Ee===k.q&&(k.state=he.DOCTYPE_DTD,k.q="");continue;case he.COMMENT:Ee==="-"?k.state=he.COMMENT_ENDING:k.comment+=Ee;continue;case he.COMMENT_ENDING:Ee==="-"?(k.state=he.COMMENT_ENDED,k.comment=Ke(k.opt,k.comment),k.comment&&Oe(k,"oncomment",k.comment),k.comment=""):(k.comment+="-"+Ee,k.state=he.COMMENT);continue;case he.COMMENT_ENDED:Ee!==">"?(Be(k,"Malformed comment"),k.comment+="--"+Ee,k.state=he.COMMENT):k.state=he.TEXT;continue;case he.CDATA:Ee==="]"?k.state=he.CDATA_ENDING:k.cdata+=Ee;continue;case he.CDATA_ENDING:Ee==="]"?k.state=he.CDATA_ENDING_2:(k.cdata+="]"+Ee,k.state=he.CDATA);continue;case he.CDATA_ENDING_2:Ee===">"?(k.cdata&&Oe(k,"oncdata",k.cdata),Oe(k,"onclosecdata"),k.cdata="",k.state=he.TEXT):Ee==="]"?k.cdata+="]":(k.cdata+="]]"+Ee,k.state=he.CDATA);continue;case he.PROC_INST:Ee==="?"?k.state=he.PROC_INST_ENDING:Ie(Ee)?k.state=he.PROC_INST_BODY:k.procInstName+=Ee;continue;case he.PROC_INST_BODY:if(!k.procInstBody&&Ie(Ee))continue;Ee==="?"?k.state=he.PROC_INST_ENDING:k.procInstBody+=Ee;continue;case he.PROC_INST_ENDING:Ee===">"?(Oe(k,"onprocessinginstruction",{name:k.procInstName,body:k.procInstBody}),k.procInstName=k.procInstBody="",k.state=he.TEXT):(k.procInstBody+="?"+Ee,k.state=he.PROC_INST_BODY);continue;case he.OPEN_TAG:ke(be,Ee)?k.tagName+=Ee:(tt(k),Ee===">"?Ue(k):Ee==="/"?k.state=he.OPEN_TAG_SLASH:(Ie(Ee)||Be(k,"Invalid character in tag name"),k.state=he.ATTRIB));continue;case he.OPEN_TAG_SLASH:Ee===">"?(Ue(k,!0),Ve(k)):(Be(k,"Forward-slash in opening tag not followed by >"),k.state=he.ATTRIB);continue;case he.ATTRIB:if(Ie(Ee))continue;Ee===">"?Ue(k):Ee==="/"?k.state=he.OPEN_TAG_SLASH:ke(ye,Ee)?(k.attribName=Ee,k.attribValue="",k.state=he.ATTRIB_NAME):Be(k,"Invalid attribute name");continue;case he.ATTRIB_NAME:Ee==="="?k.state=he.ATTRIB_VALUE:Ee===">"?(Be(k,"Attribute without value"),k.attribValue=k.attribName,it(k),Ue(k)):Ie(Ee)?k.state=he.ATTRIB_NAME_SAW_WHITE:ke(be,Ee)?k.attribName+=Ee:Be(k,"Invalid attribute name");continue;case he.ATTRIB_NAME_SAW_WHITE:if(Ee==="=")k.state=he.ATTRIB_VALUE;else{if(Ie(Ee))continue;Be(k,"Attribute without value"),k.tag.attributes[k.attribName]="",k.attribValue="",Oe(k,"onattribute",{name:k.attribName,value:""}),k.attribName="",Ee===">"?Ue(k):ke(ye,Ee)?(k.attribName=Ee,k.state=he.ATTRIB_NAME):(Be(k,"Invalid attribute name"),k.state=he.ATTRIB)}continue;case he.ATTRIB_VALUE:if(Ie(Ee))continue;Ae(Ee)?(k.q=Ee,k.state=he.ATTRIB_VALUE_QUOTED):(Be(k,"Unquoted attribute value"),k.state=he.ATTRIB_VALUE_UNQUOTED,k.attribValue=Ee);continue;case he.ATTRIB_VALUE_QUOTED:if(Ee!==k.q){Ee==="&"?k.state=he.ATTRIB_VALUE_ENTITY_Q:k.attribValue+=Ee;continue}it(k),k.q="",k.state=he.ATTRIB_VALUE_CLOSED;continue;case he.ATTRIB_VALUE_CLOSED:Ie(Ee)?k.state=he.ATTRIB:Ee===">"?Ue(k):Ee==="/"?k.state=he.OPEN_TAG_SLASH:ke(ye,Ee)?(Be(k,"No whitespace between attributes"),k.attribName=Ee,k.attribValue="",k.state=he.ATTRIB_NAME):Be(k,"Invalid attribute name");continue;case he.ATTRIB_VALUE_UNQUOTED:if(!Re(Ee)){Ee==="&"?k.state=he.ATTRIB_VALUE_ENTITY_U:k.attribValue+=Ee;continue}it(k),Ee===">"?Ue(k):k.state=he.ATTRIB;continue;case he.CLOSE_TAG:if(k.tagName)Ee===">"?Ve(k):ke(be,Ee)?k.tagName+=Ee:k.script?(k.script+="</"+k.tagName,k.tagName="",k.state=he.SCRIPT):(Ie(Ee)||Be(k,"Invalid tagname in closing tag"),k.state=he.CLOSE_TAG_SAW_WHITE);else{if(Ie(Ee))continue;De(ye,Ee)?k.script?(k.script+="</"+Ee,k.state=he.SCRIPT):Be(k,"Invalid tagname in closing tag."):k.tagName=Ee}continue;case he.CLOSE_TAG_SAW_WHITE:if(Ie(Ee))continue;Ee===">"?Ve(k):Be(k,"Invalid characters in closing tag");continue;case he.TEXT_ENTITY:case he.ATTRIB_VALUE_ENTITY_Q:case he.ATTRIB_VALUE_ENTITY_U:var Ze,Ye;switch(k.state){case he.TEXT_ENTITY:Ze=he.TEXT,Ye="textNode";break;case he.ATTRIB_VALUE_ENTITY_Q:Ze=he.ATTRIB_VALUE_QUOTED,Ye="attribValue";break;case he.ATTRIB_VALUE_ENTITY_U:Ze=he.ATTRIB_VALUE_UNQUOTED,Ye="attribValue";break}if(Ee===";")if(k.opt.unparsedEntities){var qe=lt(k);k.entity="",k.state=Ze,k.write(qe)}else k[Ye]+=lt(k),k.entity="",k.state=Ze;else ke(k.entity.length?Ne:Te,Ee)?k.entity+=Ee:(Be(k,"Invalid character in entity name"),k[Ye]+="&"+k.entity+Ee,k.entity="",k.state=Ze);continue;default:throw new Error(k,"Unknown state: "+k.state)}return k.position>=k.bufferCheckPosition&&A(k),k}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var z=String.fromCharCode,k=Math.floor,$e=function(){var Ee=16384,Me=[],He,Ze,Ye=-1,qe=arguments.length;if(!qe)return"";for(var nt="";++Ye<qe;){var Ge=Number(arguments[Ye]);if(!isFinite(Ge)||Ge<0||Ge>1114111||k(Ge)!==Ge)throw RangeError("Invalid code point: "+Ge);Ge<=65535?Me.push(Ge):(Ge-=65536,He=(Ge>>10)+55296,Ze=Ge%1024+56320,Me.push(He,Ze)),(Ye+1===qe||Me.length>Ee)&&(nt+=z.apply(null,Me),Me.length=0)}return nt};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:$e,configurable:!0,writable:!0}):String.fromCodePoint=$e}()})(r)})(sax);const logger={debug:()=>{}},_$2=r=>{const g=sax.parser(!0,{trim:!1,normalize:!1});let l,E=null;return new Promise((A,I)=>{g.onopentag=N=>{const y={_parent:E||void 0,_children:[],_fTextNode:!1,_tag:N.name,_attrs:N.attributes};E!=null?E._children.push(y):l=y,E=y},g.onclosetag=()=>{E=E!=null?E._parent:null},g.ontext=N=>{E!=null&&E._children.push({_parent:E,_children:[],_fTextNode:!0,_text:N})},g.onend=()=>{A(l)},g.onerror=N=>{I(N)},g.write(r),g.end()})};function m$1(r,g,l="",E=!0){const A=l.length||!E?"":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>',I=[Buffer.from(A,"utf-8")];if(r._fTextNode)I.push(Buffer.from(h$2(r._text,g)));else{let N="";const y=r._attrs;Object.keys(y).forEach(V=>{N+=` ${V}="${x$1(y[V])}"`});const M=r._children.length>0,O=M?"":"/",Z=g.indentXml?`
${l}`:"";I.push(Buffer.from(`${Z}<${r._tag}${N}${O}>`));let xe=!1;if(r._children.forEach(V=>{I.push(m$1(V,g,g.indentXml?`${l}  `:"",!1)),xe=!V._fTextNode}),M){const V=g.indentXml&&xe?`
${l}`:"";I.push(Buffer.from(`${V}</${r._tag}>`))}}return Buffer.concat(I)}const h$2=(r,g)=>{let l="";const E=r.split(g.literalXmlDelimiter);let A=!1;for(let I=0;I<E.length;I++){let N=E[I];A||(N=N.replace(/&/g,"&amp;"),N=N.replace(/</g,"&lt;"),N=N.replace(/>/g,"&gt;")),l+=N,A=!A}return l},x$1=r=>{let g=typeof r=="string"?r:r.value;return g=g.replace(/&/g,"&amp;"),g=g.replace(/</g,"&lt;"),g=g.replace(/>/g,"&gt;"),g=g.replace(/'/g,"&apos;"),g=g.replace(/"/g,"&quot;"),g};var n=Object.defineProperty,c$2=(r,g,l)=>g in r?n(r,g,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[g]=l,e=(r,g,l)=>c$2(r,typeof g!="symbol"?g+"":g,l);function isError(r){return r instanceof Error||typeof r=="object"&&!!r&&"name"in r&&"message"in r}class NullishCommandResultError extends Error{constructor(g){super(`Result of command ${g} is null or undefined and rejectNullish is set`),e(this,"command"),Object.setPrototypeOf(this,NullishCommandResultError.prototype),this.command=g}}class ObjectCommandResultError extends Error{constructor(g,l){super(`Result of command '${g}' is an object`),e(this,"command"),e(this,"result"),Object.setPrototypeOf(this,ObjectCommandResultError.prototype),this.command=g,this.result=l}}class CommandSyntaxError extends Error{constructor(g){super(`Invalid command syntax: ${g}`),e(this,"command"),Object.setPrototypeOf(this,CommandSyntaxError.prototype),this.command=g}}class InvalidCommandError extends Error{constructor(g,l){super(`${g}: ${l}`),e(this,"command"),Object.setPrototypeOf(this,InvalidCommandError.prototype),this.command=l}}class CommandExecutionError extends Error{constructor(g,l){super(`Error executing command '${l}': ${g.name}: ${g.message}`),e(this,"command"),e(this,"err"),Object.setPrototypeOf(this,CommandExecutionError.prototype),this.command=l,this.err=g}}class ImageError extends CommandExecutionError{}class InternalError extends Error{constructor(g){super(`INTERNAL ERROR: ${g}`)}}class TemplateParseError extends Error{}class IncompleteConditionalStatementError extends Error{constructor(){super("Incomplete IF/END-IF statement. Make sure each IF-statement has a corresponding END-IF command.")}}class UnterminatedForLoopError extends Error{constructor(g){super(`Unterminated FOR-loop ('FOR ${g.varName}'). Make sure each FOR loop has a corresponding END-FOR command.`)}}const i=r=>r._fTextNode?{_children:[],_fTextNode:!0,_text:r._text}:{_children:[],_fTextNode:!1,_tag:r._tag,_attrs:r._attrs},_$1=r=>{const g=r._parent;if(g==null)return null;const l=g._children,E=l.indexOf(r);return E<0||E>=l.length-1?null:l[E+1]},a$1=r=>{const g=r._parent;if(!(g&&!g._fTextNode&&g._tag==="w:t"))throw new TemplateParseError("Template syntax error: text node not within w:t");const l=g._parent;if(l==null)throw new TemplateParseError("Template syntax error: w:t node has no parent");const E=l._children.indexOf(g);if(E<0)throw new TemplateParseError("Template syntax error");const A=i(g);A._parent=l;const I={_parent:A,_children:[],_fTextNode:!0,_text:""};return A._children=[I],l._children.splice(E+1,0,A),I},c$1=(r,g={},l=[])=>{const E={_fTextNode:!1,_tag:r,_attrs:g,_children:l};return E._children.forEach(A=>{A._parent=E}),E},u=r=>({_children:[],_fTextNode:!0,_text:r}),p$1=(r,g)=>(r._children.push(g),g._parent=r,g),s=r=>r.loops.length?r.loops[r.loops.length-1]:null,f$1=r=>{const g=s(r);return g!=null&&g.idx<0},h$1=r=>{if(!r.length)return;const g=r.length-1,{varName:l,idx:E,loopOver:A,isIf:I}=r[g],N=E>=0?E+1:"EXPLORATION";logger.debug(`${I?"IF":"FOR"} loop on ${g}:${l}${N}/${A.length}`)},p=(r,g,l)=>{let E=r,A=!1,I=null,N=0;const y=`${g[0]}CMD_NODE${g[1]}`;for(;E!=null;){if(l&&!E._fTextNode&&E._tag==="w:t"&&(E._attrs["xml:space"]="preserve"),!E._fTextNode&&E._tag==="w:p"&&I&&(I._text+=" "),E._fTextNode&&E._parent&&!E._parent._fTextNode&&E._parent._tag==="w:t"){I==null&&(I=E);const M=E._text;E._text="";for(let O=0;O<M.length;O++){const Z=M[O],xe=A?g[1]:g[0];if(Z===xe[N]){if(N+=1,N===xe.length){A=!A;const V=E===I;A&&I._text.length&&(I=a$1(I),V&&(E=I)),I._text+=xe,!A&&O<M.length-1&&(I=a$1(I),V&&(E=I)),N=0,A||(I=E)}}else N&&(I._text+=xe.slice(0,N),N=0,A||(I=E)),I._text+=Z}!A&&!N&&(I=null),M.length&&!E._text.length&&(E._text=y)}if(E._children.length)E=E._children[0];else{let M=!1;for(;E._parent!=null;){const O=E._parent,Z=_$1(E);if(Z){M=!0,E=Z;break}E=O}M||(E=null)}}return r};var vmBrowserify={};(function(exports){var indexOf=function(r,g){if(r.indexOf)return r.indexOf(g);for(var l=0;l<r.length;l++)if(r[l]===g)return l;return-1},Object_keys=function(r){if(Object.keys)return Object.keys(r);var g=[];for(var l in r)g.push(l);return g},forEach=function(r,g){if(r.forEach)return r.forEach(g);for(var l=0;l<r.length;l++)g(r[l],l,r)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(r,g,l){Object.defineProperty(r,g,{writable:!0,enumerable:!1,configurable:!0,value:l})}}catch(r){return function(g,l,E){g[l]=E}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(g){if(!(this instanceof Script))return new Script(g);this.code=g};Script.prototype.runInContext=function(r){if(!(r instanceof Context))throw new TypeError("needs a 'context' argument.");var g=document.createElement("iframe");g.style||(g.style={}),g.style.display="none",document.body.appendChild(g);var l=g.contentWindow,E=l.eval,A=l.execScript;!E&&A&&(A.call(l,"null"),E=l.eval),forEach(Object_keys(r),function(y){l[y]=r[y]}),forEach(globals,function(y){r[y]&&(l[y]=r[y])});var I=Object_keys(l),N=E.call(l,this.code);return forEach(Object_keys(l),function(y){(y in r||indexOf(I,y)===-1)&&(r[y]=l[y])}),forEach(globals,function(y){y in r||defineProp(r,y,l[y])}),document.body.removeChild(g),N},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(r){var g=Script.createContext(r),l=this.runInContext(g);return r&&forEach(Object_keys(g),function(E){r[E]=g[E]}),l},forEach(Object_keys(Script.prototype),function(r){exports[r]=Script[r]=function(g){var l=Script(g);return l[r].apply(l,[].slice.call(arguments,1))}}),exports.isContext=function(r){return r instanceof Context},exports.createScript=function(r){return exports.Script(r)},exports.createContext=Script.createContext=function(r){var g=new Context;return typeof r=="object"&&forEach(Object_keys(r),function(l){g[l]=r[l]}),g}})(vmBrowserify);var w=Object.defineProperty,C=Object.defineProperties,c=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,b$1=Object.prototype.propertyIsEnumerable,m=(r,g,l)=>g in r?w(r,g,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[g]=l,a=(r,g)=>{for(var l in g||(g={}))h.call(g,l)&&m(r,l,g[l]);if(_)for(var l of _(g))b$1.call(g,l)&&m(r,l,g[l]);return r},d=(r,g)=>C(r,c(g));async function runUserJsAndGetRaw(r,g,l){var E;const A=a(a(d(a({},l.jsSandbox||{}),{__code__:g,__result__:void 0}),r),l.options.additionalJsContext),I=s(l);I&&(A.$idx=I.idx),Object.keys(l.vars).forEach(M=>{A[`$${M}`]=l.vars[M]});let N,y;try{if(l.options.runJs){const M=l.options.runJs({sandbox:A,ctx:l});N=M.modifiedSandbox,y=await M.result}else if(l.options.noSandbox)N=A,y=await new Function("with(this) { return eval(__code__); }").call(N);else{const M=new vmBrowserify.Script((E=A.__code__)!=null?E:"");N=vmBrowserify.createContext(A),y=await M.runInContext(N)}}catch(M){const O=isError(M)?M:new Error(`${M}`);if(l.options.errorHandler!=null)N=A,y=await l.options.errorHandler(O,g);else throw new CommandExecutionError(O,g)}if(l.options.rejectNullish&&y==null){const M=new NullishCommandResultError(g);if(l.options.errorHandler!=null)y=await l.options.errorHandler(M,g);else throw M}return l.jsSandbox=d(a({},N),{__code__:void 0,__result__:void 0}),y}const ImageExtensions=[".png",".gif",".jpg",".jpeg",".svg"],BUILT_IN_COMMANDS=["QUERY","CMD_NODE","ALIAS","FOR","END-FOR","IF","END-IF","INS","EXEC","IMAGE","LINK","HTML"];var Q=Object.defineProperty,G=Object.defineProperties,W=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertySymbols,X$1=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,$=(r,g,l)=>g in r?Q(r,g,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[g]=l,S=(r,g)=>{for(var l in g||(g={}))X$1.call(g,l)&&$(r,l,g[l]);if(L)for(var l of L(g))j.call(g,l)&&$(r,l,g[l]);return r},x=(r,g)=>G(r,W(g));function newContext(r,g=0){return{gCntIf:0,gCntEndIf:0,level:1,fCmd:!1,cmd:"",fSeekQuery:!1,buffers:{"w:p":{text:"",cmds:"",fInsertedText:!1},"w:tr":{text:"",cmds:"",fInsertedText:!1},"w:tc":{text:"",cmds:"",fInsertedText:!1}},imageAndShapeIdIncrement:g,images:{},linkId:0,links:{},htmlId:0,htmls:{},vars:{},loops:[],fJump:!1,shorthands:{},options:r,pIfCheckMap:new Map,trIfCheckMap:new Map}}async function extractQuery(r,g){const l=newContext(g);l.fSeekQuery=!0;let E=r;for(;;){if(E._children.length)E=E._children[0];else{let I=!1;for(;E._parent!=null;){const N=E._parent,y=_$1(E);if(y){E=y,I=!0;break}E=N}if(!I)break}if(!E)break;const A=E._parent;if(E._fTextNode&&A&&!A._fTextNode&&A._tag==="w:t"&&await U(null,E,l,H),l.query!=null)break}return l.query}async function produceJsReport(r,g,l){return walkTemplate(r,g,l,H)}function findHighestImgId(r){const g=[],l=E=>{for(const A of E._children){const I=A._fTextNode?null:A._tag;if(I!=null){if(I==="wp:docPr"){if(A._fTextNode)continue;const N=A._attrs.id;if(typeof N!="string")continue;const y=Number.parseInt(N,10);Number.isSafeInteger(y)&&g.push(y)}A._children.length>0&&l(A)}}};return l(r),g.length>0?Math.max(...g):0}const b=r=>JSON.stringify(r._fTextNode?{_ifName:r._ifName,_fTextNode:r._fTextNode,_text:r==null?void 0:r._text}:{_ifName:r._ifName,_fTextNode:r._fTextNode,_tag:r==null?void 0:r._tag,_attrs:r==null?void 0:r._attrs}),B$1=r=>{let g=r._parent,l=null;for(;g!=null&&l==null;){if((g._fTextNode?null:g._tag)==="w:p"){const E=g._parent!=null?g._parent._parent:null;E!=null&&!E._fTextNode&&E._tag==="w:tr"?l=E:l=g}g=g._parent}return l};async function walkTemplate(r,g,l,E){var A;const I=i(g);let N=g,y=I,M,O=0;const Z=[];let xe=0;const V=((A=l.options)==null?void 0:A.maximumWalkingDepth)||1e6;for(;;){const ce=s(l);let me=null;if(l.fJump){if(!ce)throw new InternalError("jumping while curLoop is null");logger.debug(`Jumping to level ${ce.refNodeLevel}...`,b(ce.refNode)),O=l.level-ce.refNodeLevel,N=ce.refNode,l.level=ce.refNodeLevel,l.fJump=!1,M="JUMP"}else if(N._children.length&&M!=="UP")N=N._children[0],l.level+=1,M="DOWN";else if(me=_$1(N))N=me,M="SIDE";else{const we=N._parent;if(we==null)break;if(xe>V)throw logger.debug(`=== parent is still not null after ${xe} loops, something must be wrong ...`,b(we)),new InternalError("infinite loop or massive dataset detected. Please review and try again");N=we,l.level-=1,M="UP"}if(logger.debug(`Next node [${M}, level ${l.level}]`,b(N)),M!=="DOWN"){const we=y._fTextNode?null:y._tag;let ye=!1;if((we==="w:p"||we==="w:tbl"||we==="w:tr"||we==="w:tc")&&f$1(l))ye=!0;else if(we==="w:p"||we==="w:tr"||we==="w:tc"){const be=l.buffers[we];ye=be.text===""&&be.cmds!==""&&!be.fInsertedText,we==="w:tr"&&ye&&(ye=N._children.filter(Te=>!Te._fTextNode&&Te._tag==="w:tr").length!==1),we==="w:tc"&&ye&&(ye=!(y._children.filter(Te=>!Te._fTextNode&&Te._tag==="w:tbl").length>0))}ye&&y._parent!=null&&y._parent._children.pop()}if(M==="UP"){f$1(l)&&ce&&N===ce.refNode._parent&&(ce.refNode=N,ce.refNodeLevel-=1,logger.debug(`Updated loop '${ce.varName}' refNode: `+b(N)));const we=y._parent;if(we==null)throw new InternalError("node parent is null");if(y=we,l.pendingImageNode&&!y._fTextNode&&y._tag==="w:t"){const ye=l.pendingImageNode.image,be=l.pendingImageNode.caption,Te=y._parent;Te&&(ye._parent=Te,Te._children.pop(),Te._children.push(ye),be&&Te._children.push(...be),l.buffers["w:p"].fInsertedText=!0,l.buffers["w:tr"].fInsertedText=!0,l.buffers["w:tc"].fInsertedText=!0),delete l.pendingImageNode}if(l.pendingLinkNode&&!y._fTextNode&&y._tag==="w:r"){const ye=l.pendingLinkNode,be=y._parent;be&&(ye._parent=be,be._children.pop(),be._children.push(ye),l.buffers["w:p"].fInsertedText=!0,l.buffers["w:tr"].fInsertedText=!0,l.buffers["w:tc"].fInsertedText=!0),delete l.pendingLinkNode}if(l.pendingHtmlNode&&!y._fTextNode&&y._tag==="w:p"){const ye=l.pendingHtmlNode,be=y._parent;be&&(ye._parent=be,be._children.pop(),be._children.push(ye),l.buffers["w:p"].fInsertedText=!0,l.buffers["w:tr"].fInsertedText=!0,l.buffers["w:tc"].fInsertedText=!0),delete l.pendingHtmlNode}!y._fTextNode&&y._tag==="w:tc"&&!y._children.filter(ye=>!ye._fTextNode&&(ye._tag==="w:p"||ye._tag==="w:altChunk")).length&&y._children.push({_parent:y,_children:[],_fTextNode:!1,_tag:"w:p",_attrs:{}}),!y._fTextNode&&y._tag==="w:rPr"&&(l.textRunPropsNode=y),!N._fTextNode&&N._tag==="w:r"&&delete l.textRunPropsNode}if(M==="DOWN"||M==="SIDE"){if(M==="SIDE"){if(y._parent==null)throw new InternalError("node parent is null");y=y._parent}const we=N._fTextNode?null:N._tag;(we==="w:p"||we==="w:tr"||we==="w:tc")&&(l.buffers[we]={text:"",cmds:"",fInsertedText:!1});const ye=i(N);ye._parent=y,y._children.push(ye);const be=ye._tag;!f$1(l)&&(be==="wp:docPr"||be==="v:shape")&&(logger.debug("detected a - ",b(ye)),pe(ye,l));const Te=N._parent;if(N._fTextNode&&Te&&!Te._fTextNode&&Te._tag==="w:t"){const Ne=await U(r,N,l,E);typeof Ne=="string"?(ye._text=Ne,logger.debug("Inserted command result string into node. Updated node: "+b(ye))):Z.push(...Ne)}y=ye}if(M==="JUMP")for(;O>0;){if(y._parent==null)throw new InternalError("node parent is null");y=y._parent,O-=1}xe++}if(l.gCntIf!==l.gCntEndIf){const ce=new IncompleteConditionalStatementError;if(l.options.failFast)throw ce;Z.push(ce)}if(l.loops.filter(ce=>!ce.isIf).length>0){const ce=l.loops[l.loops.length-1],me=new UnterminatedForLoopError(ce);if(l.options.failFast)throw me;Z.push(me)}return Z.length>0?{status:"errors",errors:Z}:{status:"success",report:I,images:l.images,links:l.links,htmls:l.htmls}}const U=async(r,g,l,E)=>{const{cmdDelimiter:A,failFast:I}=l.options,N=g._text;if(N==null||N==="")return"";const y=N.split(A[0]).map(Z=>Z.split(A[1])).reduce((Z,xe)=>Z.concat(xe));let M="";const O=[];for(let Z=0;Z<y.length;Z++){Z>0&&R(A[0],l,{fCmd:!0});const xe=y[Z];if(l.fCmd?l.cmd+=xe:f$1(l)||(M+=xe),R(xe,l,{fCmd:l.fCmd}),Z<y.length-1){if(l.fCmd){const V=await E(r,g,l);if(V!=null)if(typeof V=="string")M+=V,R(V,l,{fCmd:!1,fInsertedText:!0});else{if(I)throw V;O.push(V)}}l.fCmd=!l.fCmd}}return O.length>0?O:M},H=async(r,g,l)=>{const E=getCommand(l.cmd,l.shorthands,l.options.fixSmartQuotes);l.cmd="";const{cmdName:A,cmdRest:I}=splitCommand(E);try{if(A!=="CMD_NODE"&&logger.debug(`Processing cmd: ${E}`),l.fSeekQuery){A==="QUERY"&&(l.query=I);return}if(!(A==="QUERY"||A==="CMD_NODE"))if(A==="ALIAS"){const N=/^(\S+)\s+(.+)/.exec(I);if(!N)throw new InvalidCommandError("Invalid ALIAS command",E);const y=N[1],M=N[2];l.shorthands[y]=M,logger.debug(`Defined alias '${y}' for: ${M}`)}else if(A==="FOR"||A==="IF")await re$1(r,g,l,E,A,I);else if(A==="END-FOR"||A==="END-IF")oe(g,l,E,A,I);else if(A==="INS"){if(!f$1(l)){let N=await runUserJsAndGetRaw(r,I,l);if(N==null)return"";if(typeof N=="object"&&!Array.isArray(N)){const M=new ObjectCommandResultError(I,N);if(l.options.errorHandler!=null)N=await l.options.errorHandler(M,I);else throw M}let y=String(N);if(l.options.processLineBreaks){const{literalXmlDelimiter:M}=l.options;if(l.options.processLineBreaksAsNewText){const O=y.split(`
`),Z=`${M}<w:br/>${M}`,xe=`${M}</w:t>${M}`,V=`${M}<w:t xml:space="preserve">${M}`;y=O.join(`${xe}${Z}${V}`)}else y=y.replace(/\n/g,`${M}<w:br/>${M}`)}return y}}else if(A==="EXEC")f$1(l)||await runUserJsAndGetRaw(r,I,l);else if(A==="IMAGE"){if(!f$1(l)){const N=await runUserJsAndGetRaw(r,I,l);if(N!=null)try{se$1(l,N)}catch(y){throw isError(y)?new ImageError(y,E):y}}}else if(A==="LINK"){if(!f$1(l)){const N=await runUserJsAndGetRaw(r,I,l);N!=null&&await le(l,N)}}else if(A==="HTML"){if(!f$1(l)){const N=await runUserJsAndGetRaw(r,I,l);N!=null&&await fe(l,N)}}else throw new CommandSyntaxError(E);return}catch(N){if(!isError(N))throw N;return l.options.errorHandler!=null?l.options.errorHandler(N,I):N}},te$1=BUILT_IN_COMMANDS.map(r=>new RegExp(`^${r}\\b`)),ne$1=r=>!te$1.some(g=>g.test(r.toUpperCase()));function getCommand(r,g,l){let E=r.trim();if(E[0]==="*"){const A=E.slice(1).trim();if(!g[A])throw new InvalidCommandError("Unknown alias",E);E=g[A]}else E[0]==="="?E=`INS ${E.slice(1).trim()}`:E[0]==="!"?E=`EXEC ${E.slice(1).trim()}`:ne$1(E)&&(E=`INS ${E.trim()}`);return l&&(E=E.replace(/[\u201C\u201D\u201E]/g,'"').replace(/[\u2018\u2019\u201A]/g,"'")),E.trim()}function splitCommand(r){const g=/^(\S+)\s*/.exec(r);let l,E="";return g!=null&&(l=g[1].toUpperCase(),E=r.slice(l.length).trim()),{cmdName:l,cmdRest:E}}const re$1=async(r,g,l,E,A,I)=>{const N=A==="IF";let y=null,M;if(N)g._ifName||(g._ifName=`__if_${l.gCntIf}`,l.gCntIf+=1),M=g._ifName;else{if(y=/^(\S+)\s+IN\s+(.+)/i.exec(I),!y)throw new InvalidCommandError("Invalid FOR command",E);M=y[1]}const O=s(l);if(!(O&&O.varName===M)){if(N){const ce=B$1(g),me=ce!=null?ce._fTextNode?null:ce._tag:null;if(ce!=null){if(me==="w:p"){if(l.pIfCheckMap.has(ce)&&l.pIfCheckMap.get(ce)!==E)throw new InvalidCommandError("Invalid IF command nested into another IF command on the same line",E);l.pIfCheckMap.set(ce,E)}else if(me==="w:tr"){if(l.trIfCheckMap.has(ce)&&l.trIfCheckMap.get(ce)!==E)throw new InvalidCommandError("Invalid IF command nested into another IF command on the same table row",E);l.trIfCheckMap.set(ce,E)}}}const Z=l.loops.length-1,xe=Z>=0&&l.loops[Z].idx===-1;let V;if(xe)V=[];else if(N)V=await runUserJsAndGetRaw(r,I,l)?[1]:[];else{if(!y)throw new InvalidCommandError("Invalid FOR command",E);if(V=await runUserJsAndGetRaw(r,y[2],l),!Array.isArray(V))throw new InvalidCommandError("Invalid FOR command (can only iterate over Array)",E)}l.loops.push({refNode:g,refNodeLevel:l.level,varName:M,loopOver:V,isIf:N,idx:-1})}h$1(l.loops)},oe=(r,g,l,E,A)=>{const I=E==="END-IF",N=s(g);if(!N)throw new InvalidCommandError(`Unexpected ${E} outside of ${I?"IF statement":"FOR loop"} context`,l);const y=B$1(r),M=y!=null?y._fTextNode?null:y._tag:null;M==="w:p"?g.pIfCheckMap.delete(y):M==="w:tr"&&g.trIfCheckMap.delete(y),I&&!r._ifName&&(r._ifName=N.varName,g.gCntEndIf+=1);const O=I?r._ifName:A;if(N.varName!==O){if(g.loops.find(V=>V.varName===O)==null){logger.debug(`Ignoring ${l} (${O}, but we're expecting ${N.varName})`);return}throw new InvalidCommandError("Invalid command",l)}const Z=N.idx+1,xe=N.loopOver[Z];xe!=null?(g.vars[O]=xe,g.fJump=!0,N.idx=Z):g.loops.pop()},J$1=(r,g)=>{P(g),r.imageAndShapeIdIncrement+=1;const l=`img${String(r.imageAndShapeIdIncrement)}`;return r.images[l]=g,l};function P(r){if(!(r.data instanceof Uint8Array||r.data instanceof ArrayBuffer||typeof r.data=="string"))throw new Error("image .data property needs to be provided as Uint8Array (e.g. Buffer), ArrayBuffer, or as a base64-encoded string");if(!ImageExtensions.includes(r.extension))throw new Error(`An extension (one of ${ImageExtensions}) needs to be provided when providing an image or a thumbnail.`)}function ie(r){if(!Number.isFinite(r.width))throw new Error(`invalid image width: ${r.width} (in cm)`);if(!Number.isFinite(r.height))throw new Error(`invalid image height: ${r.height} (in cm)`);P(r),r.thumbnail&&P(r.thumbnail)}const se$1=(r,g)=>{var l;ie(g);const E=(g.width*36e4).toFixed(0),A=(g.height*36e4).toFixed(0);let I=J$1(r,ae(g));const N=String(r.imageAndShapeIdIncrement),y=g.alt||"",M=c$1,O=[];O.push(M("a:ext",{uri:"{28A0092B-C50C-407E-A947-70E740481C1C}"},[M("a14:useLocalDpi",{"xmlns:a14":"http://schemas.microsoft.com/office/drawing/2010/main",val:"0"})]));const Z=g.rotation?(g.rotation*6e4).toString():void 0;if(r.images[I].extension===".svg"){const ce=(l=g.thumbnail)!=null?l:{data:"bm90aGluZwo=",extension:".png"},me=J$1(r,ce);O.push(M("a:ext",{uri:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"},[M("asvg:svgBlip",{"xmlns:asvg":"http://schemas.microsoft.com/office/drawing/2016/SVG/main","r:embed":I})])),I=me}const xe=M("pic:pic",{"xmlns:pic":"http://schemas.openxmlformats.org/drawingml/2006/picture"},[M("pic:nvPicPr",{},[M("pic:cNvPr",{id:"0",name:`Picture ${N}`,descr:y}),M("pic:cNvPicPr",{},[M("a:picLocks",{noChangeAspect:"1",noChangeArrowheads:"1"})])]),M("pic:blipFill",{},[M("a:blip",{"r:embed":I,cstate:"print"},[M("a:extLst",{},O)]),M("a:srcRect"),M("a:stretch",{},[M("a:fillRect")])]),M("pic:spPr",{bwMode:"auto"},[M("a:xfrm",Z?{rot:Z}:{},[M("a:off",{x:"0",y:"0"}),M("a:ext",{cx:E,cy:A})]),M("a:prstGeom",{prst:"rect"},[M("a:avLst")]),M("a:noFill"),M("a:ln",{},[M("a:noFill")])])]),V=M("w:drawing",{},[M("wp:inline",{distT:"0",distB:"0",distL:"0",distR:"0"},[M("wp:extent",{cx:E,cy:A}),M("wp:docPr",{id:N,name:`Picture ${N}`,descr:y}),M("wp:cNvGraphicFramePr",{},[M("a:graphicFrameLocks",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:"1"})]),M("a:graphic",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},[M("a:graphicData",{uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"},[xe])])])]);r.pendingImageNode={image:V},g.caption&&(r.pendingImageNode.caption=[M("w:br"),M("w:t",{},[u(g.caption)])])};function ae(r){const{data:g,extension:l}=r;if(!l)throw new Error("If you return image `data`, make sure you return an extension as well!");return{extension:l,data:g}}const le=async(r,g)=>{const{url:l,label:E=l}=g;r.linkId+=1;const A=`link${String(r.linkId)}`;r.links[A]={url:l};const I=c$1,{textRunPropsNode:N}=r,y=I("w:hyperlink",{"r:id":A,"w:history":"1"},[I("w:r",{},[N||I("w:rPr",{},[I("w:u",{"w:val":"single"})]),I("w:t",{},[u(E)])])]);r.pendingLinkNode=y},fe=async(r,g)=>{r.htmlId+=1;const l=`html${String(r.htmlId)}`;r.htmls[l]=g;const E=c$1("w:altChunk",{"r:id":l});r.pendingHtmlNode=E},de=["w:p","w:tr","w:tc"],R=(r,g,l)=>{if(g.fSeekQuery)return;const{fCmd:E,fInsertedText:A}=l,I=E?"cmds":"text";de.forEach(N=>{const y=g.buffers[N];y[I]+=r,A&&(y.fInsertedText=!0)})};function pe(r,g){g.imageAndShapeIdIncrement+=1;const l=String(g.imageAndShapeIdIncrement);r._attrs=x(S({},r._attrs),{id:`${l}`})}const K="+++",X="||",J="[Content_Types].xml",f="word",ue=new RegExp(`${f}\\/[^\\/]+\\.xml`);async function parseTemplate(r){const g=await t(r),l=await readContentTypes(g),E=getMainDoc(l),A=`${f}/${E}`,I=await s$1(g,A);if(I==null)throw new TemplateParseError(`${E} could not be found`);logger.debug(`${A} file length: ${I.length}`),new Date().getTime();const N=await _$2(I);return new Date().getTime(),{jsTemplate:N,mainDocument:E,zip:g,contentTypes:l}}async function ee(r,g,l){const E=[];r.forEach(async I=>{ue.test(I)&&I!==`${f}/${g}`&&I.indexOf(`${f}/template`)!==0&&E.push(I)}),E.sort();const A=[];for(const I of E){const N=await s$1(r,I);if(N==null)throw new TemplateParseError(`${I} could not be read`);logger.debug(`${I} file length: ${N.length}`);const y=await _$2(N),M=p(y,l.cmdDelimiter,l.preserveSpace);A.push([M,I])}return A}async function ge(r,g){var l,E,A;const{template:I,data:N,queryVars:y}=r,M=r.literalXmlDelimiter||X,O={cmdDelimiter:se(r.cmdDelimiter),literalXmlDelimiter:M,processLineBreaks:r.processLineBreaks!=null?r.processLineBreaks:!0,noSandbox:r.noSandbox||!1,runJs:r.runJs,additionalJsContext:r.additionalJsContext||{},failFast:r.failFast==null?!0:r.failFast,rejectNullish:r.rejectNullish==null?!1:r.rejectNullish,errorHandler:typeof r.errorHandler=="function"?r.errorHandler:null,fixSmartQuotes:r.fixSmartQuotes==null?!1:r.fixSmartQuotes,processLineBreaksAsNewText:r.processLineBreaksAsNewText==null?!1:r.processLineBreaksAsNewText,maximumWalkingDepth:r.maximumWalkingDepth,indentXml:(l=r.indentXml)!=null?l:!0,preserveSpace:(E=r.preserveSpace)!=null?E:!0,compressionLevel:(A=r.compressionLevel)!=null?A:1},Z={literalXmlDelimiter:M,indentXml:O.indentXml},{jsTemplate:xe,mainDocument:V,zip:ce,contentTypes:me}=await parseTemplate(I),we=p(xe,O.cmdDelimiter,O.preserveSpace);let ye=null;if(typeof N=="function"){const Oe=await extractQuery(we,O);ye=await N(Oe,y)}else ye=N;const be=await ee(ce,V,O),Te=Math.max(...be.map(([Oe,Xe])=>findHighestImgId(Oe)),findHighestImgId(we));let Ne=newContext(O,Te);const Ie=await produceJsReport(ye,we,Ne);if(Ie.status==="errors")throw Ie.errors;const{report:Ae,images:Re,links:ke,htmls:De}=Ie;if(g==="JS")return Ae;const he=m$1(Ae,Z);if(g==="XML")return he.toString("utf-8");o(ce,`${f}/${V}`,he);let Le=Object.keys(Re).length,Ce=Object.keys(De).length;await te(Re,V,ce,O.indentXml),await ne(ke,V,ce,O.indentXml),await re(De,V,ce,O.indentXml);for(const[Oe,Xe]of be){Ne=newContext(O,Ne.imageAndShapeIdIncrement);const Ke=await produceJsReport(ye,Oe,Ne);if(Ke.status==="errors")throw Ke.errors;const{report:Je,images:Qe,links:Be,htmls:tt}=Ke,st=m$1(Je,Z);o(ce,Xe,st),Le+=Object.keys(Qe).length,Ce+=Object.keys(tt).length;const it=Xe.split("/"),Ue=it[it.length-1];await te(Qe,Ue,ce,O.indentXml),await ne(Be,V,ce,O.indentXml),await re(tt,V,ce,O.indentXml)}if(Le||Ce){const Oe=(Ke,Je)=>{me._children.filter(Qe=>{var Be;return!Qe._fTextNode&&((Be=Qe._attrs.Extension)==null?void 0:Be.toLowerCase())===(Ke==null?void 0:Ke.toLowerCase())}).length||p$1(me,c$1("Default",{Extension:Ke,ContentType:Je}))};Le&&(Oe("png","image/png"),Oe("jpg","image/jpeg"),Oe("jpeg","image/jpeg"),Oe("gif","image/gif"),Oe("bmp","image/bmp"),Oe("svg","image/svg+xml")),Ce&&Oe("html","text/html");const Xe=m$1(me,Z);o(ce,J,Xe)}return await p$2(ce,O.compressionLevel)}async function listCommands(r,g){const l={cmdDelimiter:se(g),literalXmlDelimiter:X,processLineBreaks:!0,noSandbox:!1,additionalJsContext:{},failFast:!1,rejectNullish:!1,errorHandler:null,fixSmartQuotes:!1,processLineBreaksAsNewText:!1,indentXml:!0,preserveSpace:!0,compressionLevel:1},{jsTemplate:E,mainDocument:A,zip:I}=await parseTemplate(r),N=await ee(I,A,l),y=[E,...N.map(([O,Z])=>O)],M=[];for(const O of y){const Z=p(O,l.cmdDelimiter,l.preserveSpace),xe=newContext(l);await walkTemplate(void 0,Z,xe,async(V,ce,me)=>{const we=getCommand(me.cmd,me.shorthands,me.options.fixSmartQuotes);me.cmd="";const{cmdName:ye,cmdRest:be}=splitCommand(we),Te=ye;Te!=null&&Te!=="CMD_NODE"&&M.push({raw:we,type:Te,code:be})})}return M}async function getMetadata(r){const g="docProps/app.xml",l="docProps/core.xml",E=await t(r),A=await B(E,g),I=await B(E,l);function N(O){if(O._children.length===0)return;const Z=O._children[0];if(Z._fTextNode)return Z._text;throw new Error("Not a text node")}function y(O,Z){for(const xe of O._children)if(!xe._fTextNode&&xe._tag===Z)return N(xe)}const M=O=>{const Z=Number(O);if(Number.isFinite(Z))return Z};return{pages:M(y(A,"Pages")),words:M(y(A,"Words")),characters:M(y(A,"Characters")),lines:M(y(A,"Lines")),paragraphs:M(y(A,"Paragraphs")),company:y(A,"Company"),template:y(A,"Template"),title:y(I,"dc:title"),subject:y(I,"dc:subject"),creator:y(I,"dc:creator"),description:y(I,"dc:description"),lastModifiedBy:y(I,"cp:lastModifiedBy"),revision:y(I,"cp:revision"),lastPrinted:y(I,"cp:lastPrinted"),created:y(I,"dcterms:created"),modified:y(I,"dcterms:modified"),category:y(I,"cp:category")}}async function B(r,g){const l=await s$1(r,g);if(l==null)throw new TemplateParseError(`${g} could not be read`);const E=await _$2(l);if(E._fTextNode)throw new TemplateParseError(`${g} is a text node when parsed`);return E}async function readContentTypes(r){return await B(r,J)}function getMainDoc(r){const g=["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml"];for(const l of r._children)if(!l._fTextNode&&l._attrs.ContentType!=null&&g.includes(l._attrs.ContentType)){const E=l._attrs.PartName;if(E)return E.replace("/word/","")}throw new TemplateParseError(`Could not find main document (e.g. document.xml) in ${J}`)}const te=async(r,g,l,E)=>{const A=Object.keys(r);if(!A.length)return;const I=`${f}/_rels/${g}.rels`,N=await F(l,I);for(const M of A){const{extension:O,data:Z}=r[M],xe=`template_${g}_${M}${O}`,V=`${f}/media/${xe}`;typeof Z=="string"?l.file(V,Z,{base64:!0}):l.file(V,Z,{binary:!0}),p$1(N,c$1("Relationship",{Id:M,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`media/${xe}`}))}const y=m$1(N,{literalXmlDelimiter:X,indentXml:E});o(l,I,y)},ne=async(r,g,l,E)=>{const A=Object.keys(r);if(A.length){const I=`${f}/_rels/${g}.rels`,N=await F(l,I);for(const M of A){const{url:O}=r[M];p$1(N,c$1("Relationship",{Id:M,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Target:O,TargetMode:"External"}))}const y=m$1(N,{literalXmlDelimiter:X,indentXml:E});o(l,I,y)}},re=async(r,g,l,E)=>{const A=Object.keys(r);if(A.length){const I=`${f}/_rels/${g}.rels`,N=await F(l,I);for(const M of A){const O=r[M],Z=`template_${g.replace(/\./g,"_")}_${M}.html`,xe=`${f}/${Z}`;o(l,xe,Buffer.from(O)),p$1(N,c$1("Relationship",{Id:M,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk",Target:`${Z}`}))}const y=m$1(N,{literalXmlDelimiter:X,indentXml:E});o(l,I,y)}},F=async(r,g)=>{let l=await s$1(r,g);return l||(l=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
        <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
        </Relationships>`),_$2(l)},se=r=>r?typeof r=="string"?[r,r]:r:[K,K];export{CommandExecutionError,CommandSyntaxError,ImageError,IncompleteConditionalStatementError,InternalError,InvalidCommandError,NullishCommandResultError,ObjectCommandResultError,TemplateParseError,UnterminatedForLoopError,ge as createReport,getMetadata,isError,listCommands};
//# sourceMappingURL=browser.js.map
